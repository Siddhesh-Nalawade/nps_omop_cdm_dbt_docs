{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/manifest/v4.json", "dbt_version": "1.0.1", "generated_at": "2022-05-05T05:42:28.434536Z", "invocation_id": "1fafa353-34bc-4b33-8fec-7acc45ccd2ca", "env": {}, "project_id": "aa77746b542f313a186cde7640ec297e", "user_id": "e6ec0a59-42e2-4aa2-88be-464a3c0f229c", "send_anonymous_usage_stats": true, "adapter_type": "bigquery"}, "nodes": {"model.NPS_OMOP_CDM.cost": {"raw_sql": "with billing_service as (\r\n\r\n    SELECT \r\n    *\r\n    FROM {{ ref('stg_cost_billing_service')}}\r\n\r\n),\r\n\r\nvisit_occurrence as (\r\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'visit_occurrence') }}\r\n),\r\n\r\nperson as (\r\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person') }}\r\n),\r\n\r\nintermediate_cost as (\r\nSELECT \r\nvo.visit_occurrence_id AS cost_event_id\r\nFROM billing_service bs \r\nINNER JOIN person p\r\nON p.person_source_value = bs.PATIENT_NUMBER\r\nINNER JOIN visit_occurrence vo\r\nON p.person_id = vo.person_id WHERE CAST(bs.SERVICE_DATETIME AS DATE) = vo.visit_start_date\r\n)\r\n\r\nSELECT \r\nROW_NUMBER() OVER(ORDER BY cost_event_id ASC) AS cost_id,\r\ncost_event_id,\r\nCAST(NULL AS STRING) AS cost_domain_id,\r\n0 AS cost_type_concept_id,\r\n0 AS currency_concept_id,\r\nCAST(NULL AS FLOAT64) AS total_charge,\r\nCAST(NULL AS FLOAT64) AS total_cost,\r\nCAST(NULL AS FLOAT64) AS total_paid,\r\nCAST(NULL AS FLOAT64) AS paid_by_payer,\r\nCAST(NULL AS FLOAT64) AS paid_by_patient,\r\nCAST(NULL AS FLOAT64) AS paid_patient_copay,\r\nCAST(NULL AS FLOAT64) AS paid_patient_coinsurance,\r\nCAST(NULL AS FLOAT64) AS paid_patient_deductible,\r\nCAST(NULL AS FLOAT64) AS paid_by_primary,\r\nCAST(NULL AS FLOAT64) AS paid_ingredient_cost,\r\nCAST(NULL AS FLOAT64) AS paid_dispensing_fee,\r\n0 AS payer_plan_period_id,\r\nCAST(NULL AS FLOAT64) AS amount_allowed,\r\n0 AS revenue_code_concept_id,\r\nCAST(NULL AS STRING) AS revenue_code_source_value,\r\n0 AS drg_concept_id,\r\nCAST(NULL AS STRING) AS drg_source_value\r\nFROM intermediate_cost ORDER BY cost_id", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence", "model.NPS_OMOP_CDM.stg_cost_billing_service"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "Cost", "cost"], "unique_id": "model.NPS_OMOP_CDM.cost", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\Cost\\cost.sql", "original_file_path": "models\\CDM\\Cost\\cost.sql", "name": "cost", "alias": "cost", "checksum": {"name": "sha256", "checksum": "dbe7fba8f350a8f29b9b33bd2c3556f88574c95e8b3b58c8ad81d8ab571412a8"}, "tags": [], "refs": [["stg_cost_billing_service"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"], ["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "visit_occurrence"]], "description": "", "columns": {"cost_id": {"name": "cost_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "cost_event_id": {"name": "cost_event_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\Cost\\cost.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Cost\\cost.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651482438.5069907, "compiled_sql": "with billing_service as (\n\n    SELECT \n    *\n    FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_cost_billing_service`\n\n),\n\nvisit_occurrence as (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`visit_occurrence`\n),\n\nperson as (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\n\nintermediate_cost as (\nSELECT \nvo.visit_occurrence_id AS cost_event_id\nFROM billing_service bs \nINNER JOIN person p\nON p.person_source_value = bs.PATIENT_NUMBER\nINNER JOIN visit_occurrence vo\nON p.person_id = vo.person_id WHERE CAST(bs.SERVICE_DATETIME AS DATE) = vo.visit_start_date\n)\n\nSELECT \nROW_NUMBER() OVER(ORDER BY cost_event_id ASC) AS cost_id,\ncost_event_id,\nCAST(NULL AS STRING) AS cost_domain_id,\n0 AS cost_type_concept_id,\n0 AS currency_concept_id,\nCAST(NULL AS FLOAT64) AS total_charge,\nCAST(NULL AS FLOAT64) AS total_cost,\nCAST(NULL AS FLOAT64) AS total_paid,\nCAST(NULL AS FLOAT64) AS paid_by_payer,\nCAST(NULL AS FLOAT64) AS paid_by_patient,\nCAST(NULL AS FLOAT64) AS paid_patient_copay,\nCAST(NULL AS FLOAT64) AS paid_patient_coinsurance,\nCAST(NULL AS FLOAT64) AS paid_patient_deductible,\nCAST(NULL AS FLOAT64) AS paid_by_primary,\nCAST(NULL AS FLOAT64) AS paid_ingredient_cost,\nCAST(NULL AS FLOAT64) AS paid_dispensing_fee,\n0 AS payer_plan_period_id,\nCAST(NULL AS FLOAT64) AS amount_allowed,\n0 AS revenue_code_concept_id,\nCAST(NULL AS STRING) AS revenue_code_source_value,\n0 AS drg_concept_id,\nCAST(NULL AS STRING) AS drg_source_value\nFROM intermediate_cost ORDER BY cost_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`cost`"}, "model.NPS_OMOP_CDM.fact_relationship": {"raw_sql": "with \nfact_drug_procedure AS (\n    SELECT * FROM {{ref('stg_fact_drug_procedure')}}\n),\n\nfact_drug_condition AS (\n    SELECT * FROM {{ref('stg_fact_drug_condition')}}\n),\n\nfact_specimen_measurement AS (\n    SELECT * FROM {{ref('stg_fact_specimen_measurement')}}\n),\n\n\nintermediate_fact_relationship as (\n    SELECT drug_exposure_id as fact_id_1, procedure_occurrence_id as fact_id_2\n    FROM fact_drug_procedure\n\n    UNION ALL\n\n    SELECT drug_exposure_id as fact_id_2, procedure_occurrence_id as fact_id_1\n    FROM fact_drug_procedure\n\n    UNION ALL\n\n    SELECT drug_exposure_id as fact_id_1, condition_occurrence_id as fact_id_2\n    FROM fact_drug_condition\n\n    UNION ALL\n\n    SELECT drug_exposure_id as fact_id_2, condition_occurrence_id as fact_id_1\n    FROM fact_drug_condition\n\n    UNION ALL\n\n    SELECT measurement_id as fact_id_1, specimen_id as fact_id_2\n    FROM fact_specimen_measurement\n\n    UNION ALL\n\n    SELECT measurement_id as fact_id_2, specimen_id as fact_id_1\n    FROM fact_specimen_measurement\n\n)\n\nSELECT \n0 as domain_concept_id_1,\nfact_id_1,\n0 as domain_concept_id_2,\nfact_id_2,\n0 as relationship_concept_id\nFROM intermediate_fact_relationship", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.NPS_OMOP_CDM.stg_fact_drug_procedure", "model.NPS_OMOP_CDM.stg_fact_drug_condition", "model.NPS_OMOP_CDM.stg_fact_specimen_measurement"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "Fact_Relationship", "fact_relationship"], "unique_id": "model.NPS_OMOP_CDM.fact_relationship", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\Fact_Relationship\\fact_relationship.sql", "original_file_path": "models\\CDM\\Fact_Relationship\\fact_relationship.sql", "name": "fact_relationship", "alias": "fact_relationship", "checksum": {"name": "sha256", "checksum": "f513a798a9a60ce36e4fac16d31d7c8bd35972801e84669a1486d0911d70f0c5"}, "tags": [], "refs": [["stg_fact_drug_procedure"], ["stg_fact_drug_condition"], ["stg_fact_specimen_measurement"]], "sources": [], "description": "", "columns": {"fact_id_1": {"name": "fact_id_1", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "fact_id_2": {"name": "fact_id_2", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\Fact_Relationship\\fact_relationship.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Fact_Relationship\\fact_relationship.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651482438.56982, "compiled_sql": "with \nfact_drug_procedure AS (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_fact_drug_procedure`\n),\n\nfact_drug_condition AS (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_fact_drug_condition`\n),\n\nfact_specimen_measurement AS (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_fact_specimen_measurement`\n),\n\n\nintermediate_fact_relationship as (\n    SELECT drug_exposure_id as fact_id_1, procedure_occurrence_id as fact_id_2\n    FROM fact_drug_procedure\n\n    UNION ALL\n\n    SELECT drug_exposure_id as fact_id_2, procedure_occurrence_id as fact_id_1\n    FROM fact_drug_procedure\n\n    UNION ALL\n\n    SELECT drug_exposure_id as fact_id_1, condition_occurrence_id as fact_id_2\n    FROM fact_drug_condition\n\n    UNION ALL\n\n    SELECT drug_exposure_id as fact_id_2, condition_occurrence_id as fact_id_1\n    FROM fact_drug_condition\n\n    UNION ALL\n\n    SELECT measurement_id as fact_id_1, specimen_id as fact_id_2\n    FROM fact_specimen_measurement\n\n    UNION ALL\n\n    SELECT measurement_id as fact_id_2, specimen_id as fact_id_1\n    FROM fact_specimen_measurement\n\n)\n\nSELECT \n0 as domain_concept_id_1,\nfact_id_1,\n0 as domain_concept_id_2,\nfact_id_2,\n0 as relationship_concept_id\nFROM intermediate_fact_relationship", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`fact_relationship`"}, "model.NPS_OMOP_CDM.measurement": {"raw_sql": "with observation as (\r\n    SELECT * FROM {{ ref('stg_measurement_observation')}}\r\n),\r\n\r\nstg_pathology as (\r\n    SELECT * FROM {{ ref('stg_measurement_pathology')}}\r\n),\r\n\r\nstg_pathology_albumin as (\r\n    SELECT * FROM {{ ref('stg_measurement_pathology_albumin')}}\r\n),\r\n\r\nstg_pathology_egfr as (\r\n    SELECT * FROM {{ ref('stg_measurement_pathology_egfr')}}\r\n),\r\n\r\nstg_pathology_hba1c as (\r\n    SELECT * FROM {{ ref('stg_measurement_pathology_hba1c')}}\r\n),\r\n\r\nstg_pathology_lipids as (\r\n    SELECT * FROM {{ ref('stg_measurement_pathology_lipids')}}\r\n),\r\n\r\nstg_pathology_result as (\r\n    SELECT * FROM {{ ref('stg_measurement_pathology_result')}}\r\n),\r\n\r\nstg_requested_test as (\r\n    SELECT * FROM {{ ref('stg_measurement_requested_test')}}\r\n),\r\n\r\nperson AS(\r\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person') }}\r\n),\r\n\r\nprovider AS(\r\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'provider') }}\r\n),\r\n\r\nvisit_occurrence AS(\r\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'visit_occurrence') }}\r\n),\r\n\r\nintermediate_measurement as (\r\nSELECT\r\n(SELECT person_id FROM person AS p WHERE p.person_source_value = pl.PATIENT_NUMBER) AS person_id,\r\nCASE \r\nWHEN PATHOLOGY_TEST_DATETIME IS NULL THEN CAST('1800-01-01' AS DATE)\r\nELSE CAST(PATHOLOGY_TEST_DATETIME AS DATE) END AS measurement_date,\r\nPATHOLOGY_TEST_DATETIME AS measurement_datetime, \r\nCAST(PATHOLOGY_TEST_DATETIME AS TIME) AS measurement_time,\r\nSAFE_CAST(RESULT_VALUE_CIS AS FLOAT64) AS value_as_number,\r\n\r\nCASE WHEN PATHOLOGY_TEST_TYPE = \"HDL measurement\" THEN CAST(SUBSTRING(LIPIDS_HDL_RESULT_VALUE_RANGE,2,3) AS FLOAT64)\r\nELSE NULL END AS range_low,\r\n\r\nCASE WHEN PATHOLOGY_TEST_TYPE = \"Total cholesterol measurement\" THEN CAST(SUBSTRING(LIPIDS_TOTAL_CHOLESTEROL_RESULT_VALUE_RANGE,2,3) AS FLOAT64)\r\nWHEN PATHOLOGY_TEST_TYPE = \"LDL measurement\" THEN CAST(SUBSTRING(LIPIDS_LDL_RESULT_VALUE_RANGE,2,3) AS FLOAT64)\r\nWHEN PATHOLOGY_TEST_TYPE = \"Triglycerides measurement\" THEN CAST(SUBSTRING(LIPIDS_TRIGLYCERIDES_RESULT_VALUE_RANGE,2,3) AS FLOAT64) \r\nELSE NULL END AS range_high,\r\nNULL AS provider_id,\r\nNULL AS visit_occurrence_id,\r\nPATHOLOGY_TEST_TYPE AS measurement_source_value,\r\nDETECTED_CIS_UNIT_OF_MEASURE AS unit_source_value,\r\nRESULT_VALUE_CIS AS value_source_value \r\nFROM  stg_pathology_lipids pl\r\n\r\nUNION DISTINCT\r\n\r\nSELECT \r\n(SELECT person_id FROM person AS p WHERE p.person_source_value = ph.PATIENT_NUMBER) AS person_id,\r\nCASE \r\nWHEN PATHOLOGY_TEST_DATETIME IS NULL THEN CAST('1800-01-01' AS DATE)\r\nELSE CAST(PATHOLOGY_TEST_DATETIME AS DATE) END AS measurement_date,\r\nPATHOLOGY_TEST_DATETIME AS measurement_datetime, \r\nCAST(PATHOLOGY_TEST_DATETIME AS TIME) AS measurement_time,\r\nSAFE_CAST(RESULT_VALUE_CIS AS FLOAT64) AS value_as_number,\r\nNULL AS range_low,\r\nCAST(SUBSTRING(HBA1C_RANGE_AIHW,2,2) AS FLOAT64) AS range_high,\r\nNULL AS provider_id,\r\nNULL AS visit_occurrence_id,\r\nPATHOLOGY_TEST_TYPE AS measurement_source_value,\r\nDETECTED_CIS_UNIT_OF_MEASURE AS unit_source_value,\r\nRESULT_VALUE_CIS AS value_source_value \r\nFROM  stg_pathology_hba1c ph\r\n\r\nUNION DISTINCT\r\n\r\nSELECT\r\n(SELECT person_id FROM person AS p WHERE p.person_source_value = pe.PATIENT_NUMBER) AS person_id,\r\nCASE \r\nWHEN PATHOLOGY_TEST_DATETIME IS NULL THEN CAST('1800-01-01' AS DATE)\r\nELSE CAST(PATHOLOGY_TEST_DATETIME AS DATE) END AS measurement_date,\r\nPATHOLOGY_TEST_DATETIME AS measurement_datetime, \r\nCAST(PATHOLOGY_TEST_DATETIME AS TIME) AS measurement_time,\r\nSAFE_CAST(RESULT_VALUE_CIS AS FLOAT64) AS value_as_number,\r\nCAST(SUBSTRING(GFR_EGFR_RESULT_VALUE_RANGE,1,2) AS FLOAT64) AS range_low,\r\nCAST(SUBSTRING(GFR_EGFR_RESULT_VALUE_RANGE,4,3) AS FLOAT64) AS range_high,\r\nNULL AS provider_id,\r\nNULL AS visit_occurrence_id,\r\nPATHOLOGY_TEST_TYPE AS measurement_source_value ,\r\nDETECTED_CIS_UNIT_OF_MEASURE AS unit_source_value,\r\nRESULT_VALUE_CIS AS value_source_value \r\nFROM  stg_pathology_egfr pe\r\n\r\nUNION DISTINCT\r\n\r\nSELECT\r\n(SELECT person_id FROM person AS p WHERE p.person_source_value = pa.PATIENT_NUMBER) AS person_id,\r\nCASE \r\nWHEN PATHOLOGY_TEST_DATETIME IS NULL THEN CAST('1800-01-01' AS DATE)\r\nELSE CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', PATHOLOGY_TEST_DATETIME)) AS DATE) END AS measurement_date,\r\nCAST(PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', PATHOLOGY_TEST_DATETIME) AS TIMESTAMP) AS measurement_datetime,\r\nCAST(PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', PATHOLOGY_TEST_DATETIME) AS TIME) as measurement_time,\r\nSAFE_CAST(RESULT_VALUE_CIS AS FLOAT64) AS value_as_number,\r\nNULL AS range_low,\r\nCASE \r\nWHEN PATHOLOGY_TEST_TYPE = \"Urinary Albumin Concentration\" THEN CAST(SUBSTRING(ALBUMIN_CONCENTRATION_RESULT_VALUE_RANGE,2,2) AS FLOAT64)\r\nWHEN PATHOLOGY_TEST_TYPE = \"Urinary Albumin to Creatinine Ratio (ACR)\" THEN CAST(SUBSTRING(ALBUMIN_ACR_RESULT_VALUE_RANGE,2,2) AS FLOAT64)\r\nELSE NULL END AS range_high,\r\nNULL AS provider_id,\r\nNULL AS visit_occurrence_id,\r\nPATHOLOGY_TEST_TYPE AS measurement_source_value,\r\nDETECTED_CIS_UNIT_OF_MEASURE AS unit_source_value,\r\nRESULT_VALUE_CIS AS value_source_value\r\nFROM stg_pathology_albumin pa\r\n\r\nUNION DISTINCT\r\n\r\nSELECT \r\n(SELECT person_id FROM person AS p WHERE p.person_source_value = pr.PATIENT_NUMBER) AS person_id,\r\nCASE \r\nWHEN RESULT_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\r\nELSE CAST(RESULT_DATE AS DATE) END AS measurement_date,\r\nRESULT_DATE  AS measurement_datetime, \r\nCAST(RESULT_DATE AS TIME) AS measurement_time,\r\nSAFE_CAST(RESULT_VALUE AS FLOAT64) AS value_as_number,\r\nrange_low,\r\nrange_high,\r\nNULL AS provider_id,\r\nNULL AS visit_occurrence_id,\r\nRESULT_NAME  AS measurement_source_value,\r\nUNITS  AS unit_source_value,\r\nRESULT_VALUE  AS value_source_value\r\nFROM  stg_pathology_result pr\r\n\r\nUNION DISTINCT\r\n\r\nSELECT\r\n(SELECT person_id FROM person AS p WHERE p.person_source_value = rt.PATIENT_NUMBER) AS person_id,\r\nCASE \r\nWHEN REQUEST_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\r\nELSE CAST(REQUEST_DATE AS DATE) END AS measurement_date,\r\nREQUEST_DATE AS measurement_datetime, \r\nCAST(REQUEST_DATE AS TIME) AS measurement_time,\r\nNULL AS value_as_number,\r\nNULL AS range_low,\r\nNULL AS range_high,\r\nNULL AS provider_id,\r\nNULL AS visit_occurrence_id,\r\nNULL AS measurement_source_value,\r\nNULL AS unit_source_value,\r\nNULL AS value_source_value\r\nFROM stg_requested_test rt\r\n\r\nUNION DISTINCT\r\n\r\nSELECT\r\n(SELECT person_id FROM person AS p WHERE p.person_source_value = po.PATIENT_NUMBER) AS person_id,\r\nCASE \r\nWHEN REPORT_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\r\nELSE CAST(REPORT_DATE AS DATE) END AS measurement_date,\r\nREPORT_DATE AS measurement_datetime, \r\nCAST(REPORT_DATE AS TIME) AS measurement_time,\r\nNULL AS value_as_number,\r\nNULL AS range_low,\r\nNULL AS range_high,\r\nNULL AS provider_id,\r\nNULL AS visit_occurrence_id,\r\nRESULT_NAME AS measurement_source_value,\r\nNULL AS unit_source_value,\r\nNULL AS value_source_value\r\nFROM  stg_pathology po\r\n\r\nUNION DISTINCT\r\n\r\nSELECT\r\n(SELECT person_id FROM person AS p WHERE p.person_source_value = o.PATIENT_NUMBER) AS person_id,\r\nCASE \r\nWHEN OBSERVATION_DATETIME IS NULL THEN CAST('1800-01-01' AS DATE)\r\nELSE CAST(OBSERVATION_DATETIME AS DATE) END AS measurement_date,\r\nOBSERVATION_DATETIME  AS measurement_datetime, \r\nCAST(OBSERVATION_DATETIME  AS TIME) AS measurement_time,\r\nSAFE_CAST(OBSERVATION_VALUE AS FLOAT64) AS value_as_number,\r\nNULL AS range_low,\r\nNULL AS range_high,\r\nNULL AS provider_id,\r\nNULL AS visit_occurrence_id,\r\nOBSERVATION_TYPE AS measurement_source_value,\r\nNULL AS unit_source_value,\r\nOBSERVATION_VALUE AS value_source_value\r\nFROM  observation o\r\n)\r\n\r\nSELECT \r\nROW_NUMBER() OVER(ORDER BY person_id ASC) AS measurement_id,\r\nperson_id,\r\n0 AS measurement_concept_id,\r\nmeasurement_date,\r\nCAST(measurement_datetime AS DATETIME) AS measurement_datetime, \r\nCAST(measurement_time AS STRING) AS measurement_time,\r\n0 AS measurement_type_concept_id,\r\n0 AS operator_concept_id,\r\nCAST(value_as_number AS FLOAT64) AS value_as_number,\r\n0 AS value_as_concept_id,\r\n0 AS unit_concept_id,\r\nCAST(range_low AS FLOAT64) AS range_low,\r\nCAST(range_high AS FLOAT64) AS range_high,\r\nCAST(provider_id AS INT64) AS provider_id,\r\nCAST(visit_occurrence_id AS INT64) AS visit_occurrence_id,\r\n0 AS visit_detail_id,\r\nmeasurement_source_value,\r\n0 AS measurement_source_concept_id,\r\nunit_source_value,\r\n0 AS unit_source_concept_id,\r\nvalue_source_value,\r\nCAST(NULL AS INT64) AS measurement_event_id,\r\nCAST(NULL AS INT64) AS meas_event_field_concept_id\r\nFROM intermediate_measurement ORDER BY measurement_id", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.provider", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence", "model.NPS_OMOP_CDM.stg_measurement_observation", "model.NPS_OMOP_CDM.stg_measurement_pathology", "model.NPS_OMOP_CDM.stg_measurement_pathology_albumin", "model.NPS_OMOP_CDM.stg_measurement_pathology_egfr", "model.NPS_OMOP_CDM.stg_measurement_pathology_hba1c", "model.NPS_OMOP_CDM.stg_measurement_pathology_lipids", "model.NPS_OMOP_CDM.stg_measurement_pathology_result", "model.NPS_OMOP_CDM.stg_measurement_requested_test"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "Measurement", "measurement"], "unique_id": "model.NPS_OMOP_CDM.measurement", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\Measurement\\measurement.sql", "original_file_path": "models\\CDM\\Measurement\\measurement.sql", "name": "measurement", "alias": "measurement", "checksum": {"name": "sha256", "checksum": "1f34de1448ff2c98d3449156c84e2958a74e74438b711d326e029cedeaafa3f2"}, "tags": [], "refs": [["stg_measurement_observation"], ["stg_measurement_pathology"], ["stg_measurement_pathology_albumin"], ["stg_measurement_pathology_egfr"], ["stg_measurement_pathology_hba1c"], ["stg_measurement_pathology_lipids"], ["stg_measurement_pathology_result"], ["stg_measurement_requested_test"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "provider"], ["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"], ["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "visit_occurrence"]], "description": "", "columns": {"measurement_id": {"name": "measurement_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "person_id": {"name": "person_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "measurement_date": {"name": "measurement_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\Measurement\\measurement.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Measurement\\measurement.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651482438.593756, "compiled_sql": "with observation as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_measurement_observation`\n),\n\nstg_pathology as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_measurement_pathology`\n),\n\nstg_pathology_albumin as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_measurement_pathology_albumin`\n),\n\nstg_pathology_egfr as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_measurement_pathology_egfr`\n),\n\nstg_pathology_hba1c as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_measurement_pathology_hba1c`\n),\n\nstg_pathology_lipids as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_measurement_pathology_lipids`\n),\n\nstg_pathology_result as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_measurement_pathology_result`\n),\n\nstg_requested_test as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_measurement_requested_test`\n),\n\nperson AS(\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\n\nprovider AS(\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`provider`\n),\n\nvisit_occurrence AS(\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`visit_occurrence`\n),\n\nintermediate_measurement as (\nSELECT\n(SELECT person_id FROM person AS p WHERE p.person_source_value = pl.PATIENT_NUMBER) AS person_id,\nCASE \nWHEN PATHOLOGY_TEST_DATETIME IS NULL THEN CAST('1800-01-01' AS DATE)\nELSE CAST(PATHOLOGY_TEST_DATETIME AS DATE) END AS measurement_date,\nPATHOLOGY_TEST_DATETIME AS measurement_datetime, \nCAST(PATHOLOGY_TEST_DATETIME AS TIME) AS measurement_time,\nSAFE_CAST(RESULT_VALUE_CIS AS FLOAT64) AS value_as_number,\n\nCASE WHEN PATHOLOGY_TEST_TYPE = \"HDL measurement\" THEN CAST(SUBSTRING(LIPIDS_HDL_RESULT_VALUE_RANGE,2,3) AS FLOAT64)\nELSE NULL END AS range_low,\n\nCASE WHEN PATHOLOGY_TEST_TYPE = \"Total cholesterol measurement\" THEN CAST(SUBSTRING(LIPIDS_TOTAL_CHOLESTEROL_RESULT_VALUE_RANGE,2,3) AS FLOAT64)\nWHEN PATHOLOGY_TEST_TYPE = \"LDL measurement\" THEN CAST(SUBSTRING(LIPIDS_LDL_RESULT_VALUE_RANGE,2,3) AS FLOAT64)\nWHEN PATHOLOGY_TEST_TYPE = \"Triglycerides measurement\" THEN CAST(SUBSTRING(LIPIDS_TRIGLYCERIDES_RESULT_VALUE_RANGE,2,3) AS FLOAT64) \nELSE NULL END AS range_high,\nNULL AS provider_id,\nNULL AS visit_occurrence_id,\nPATHOLOGY_TEST_TYPE AS measurement_source_value,\nDETECTED_CIS_UNIT_OF_MEASURE AS unit_source_value,\nRESULT_VALUE_CIS AS value_source_value \nFROM  stg_pathology_lipids pl\n\nUNION DISTINCT\n\nSELECT \n(SELECT person_id FROM person AS p WHERE p.person_source_value = ph.PATIENT_NUMBER) AS person_id,\nCASE \nWHEN PATHOLOGY_TEST_DATETIME IS NULL THEN CAST('1800-01-01' AS DATE)\nELSE CAST(PATHOLOGY_TEST_DATETIME AS DATE) END AS measurement_date,\nPATHOLOGY_TEST_DATETIME AS measurement_datetime, \nCAST(PATHOLOGY_TEST_DATETIME AS TIME) AS measurement_time,\nSAFE_CAST(RESULT_VALUE_CIS AS FLOAT64) AS value_as_number,\nNULL AS range_low,\nCAST(SUBSTRING(HBA1C_RANGE_AIHW,2,2) AS FLOAT64) AS range_high,\nNULL AS provider_id,\nNULL AS visit_occurrence_id,\nPATHOLOGY_TEST_TYPE AS measurement_source_value,\nDETECTED_CIS_UNIT_OF_MEASURE AS unit_source_value,\nRESULT_VALUE_CIS AS value_source_value \nFROM  stg_pathology_hba1c ph\n\nUNION DISTINCT\n\nSELECT\n(SELECT person_id FROM person AS p WHERE p.person_source_value = pe.PATIENT_NUMBER) AS person_id,\nCASE \nWHEN PATHOLOGY_TEST_DATETIME IS NULL THEN CAST('1800-01-01' AS DATE)\nELSE CAST(PATHOLOGY_TEST_DATETIME AS DATE) END AS measurement_date,\nPATHOLOGY_TEST_DATETIME AS measurement_datetime, \nCAST(PATHOLOGY_TEST_DATETIME AS TIME) AS measurement_time,\nSAFE_CAST(RESULT_VALUE_CIS AS FLOAT64) AS value_as_number,\nCAST(SUBSTRING(GFR_EGFR_RESULT_VALUE_RANGE,1,2) AS FLOAT64) AS range_low,\nCAST(SUBSTRING(GFR_EGFR_RESULT_VALUE_RANGE,4,3) AS FLOAT64) AS range_high,\nNULL AS provider_id,\nNULL AS visit_occurrence_id,\nPATHOLOGY_TEST_TYPE AS measurement_source_value ,\nDETECTED_CIS_UNIT_OF_MEASURE AS unit_source_value,\nRESULT_VALUE_CIS AS value_source_value \nFROM  stg_pathology_egfr pe\n\nUNION DISTINCT\n\nSELECT\n(SELECT person_id FROM person AS p WHERE p.person_source_value = pa.PATIENT_NUMBER) AS person_id,\nCASE \nWHEN PATHOLOGY_TEST_DATETIME IS NULL THEN CAST('1800-01-01' AS DATE)\nELSE CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', PATHOLOGY_TEST_DATETIME)) AS DATE) END AS measurement_date,\nCAST(PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', PATHOLOGY_TEST_DATETIME) AS TIMESTAMP) AS measurement_datetime,\nCAST(PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', PATHOLOGY_TEST_DATETIME) AS TIME) as measurement_time,\nSAFE_CAST(RESULT_VALUE_CIS AS FLOAT64) AS value_as_number,\nNULL AS range_low,\nCASE \nWHEN PATHOLOGY_TEST_TYPE = \"Urinary Albumin Concentration\" THEN CAST(SUBSTRING(ALBUMIN_CONCENTRATION_RESULT_VALUE_RANGE,2,2) AS FLOAT64)\nWHEN PATHOLOGY_TEST_TYPE = \"Urinary Albumin to Creatinine Ratio (ACR)\" THEN CAST(SUBSTRING(ALBUMIN_ACR_RESULT_VALUE_RANGE,2,2) AS FLOAT64)\nELSE NULL END AS range_high,\nNULL AS provider_id,\nNULL AS visit_occurrence_id,\nPATHOLOGY_TEST_TYPE AS measurement_source_value,\nDETECTED_CIS_UNIT_OF_MEASURE AS unit_source_value,\nRESULT_VALUE_CIS AS value_source_value\nFROM stg_pathology_albumin pa\n\nUNION DISTINCT\n\nSELECT \n(SELECT person_id FROM person AS p WHERE p.person_source_value = pr.PATIENT_NUMBER) AS person_id,\nCASE \nWHEN RESULT_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\nELSE CAST(RESULT_DATE AS DATE) END AS measurement_date,\nRESULT_DATE  AS measurement_datetime, \nCAST(RESULT_DATE AS TIME) AS measurement_time,\nSAFE_CAST(RESULT_VALUE AS FLOAT64) AS value_as_number,\nrange_low,\nrange_high,\nNULL AS provider_id,\nNULL AS visit_occurrence_id,\nRESULT_NAME  AS measurement_source_value,\nUNITS  AS unit_source_value,\nRESULT_VALUE  AS value_source_value\nFROM  stg_pathology_result pr\n\nUNION DISTINCT\n\nSELECT\n(SELECT person_id FROM person AS p WHERE p.person_source_value = rt.PATIENT_NUMBER) AS person_id,\nCASE \nWHEN REQUEST_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\nELSE CAST(REQUEST_DATE AS DATE) END AS measurement_date,\nREQUEST_DATE AS measurement_datetime, \nCAST(REQUEST_DATE AS TIME) AS measurement_time,\nNULL AS value_as_number,\nNULL AS range_low,\nNULL AS range_high,\nNULL AS provider_id,\nNULL AS visit_occurrence_id,\nNULL AS measurement_source_value,\nNULL AS unit_source_value,\nNULL AS value_source_value\nFROM stg_requested_test rt\n\nUNION DISTINCT\n\nSELECT\n(SELECT person_id FROM person AS p WHERE p.person_source_value = po.PATIENT_NUMBER) AS person_id,\nCASE \nWHEN REPORT_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\nELSE CAST(REPORT_DATE AS DATE) END AS measurement_date,\nREPORT_DATE AS measurement_datetime, \nCAST(REPORT_DATE AS TIME) AS measurement_time,\nNULL AS value_as_number,\nNULL AS range_low,\nNULL AS range_high,\nNULL AS provider_id,\nNULL AS visit_occurrence_id,\nRESULT_NAME AS measurement_source_value,\nNULL AS unit_source_value,\nNULL AS value_source_value\nFROM  stg_pathology po\n\nUNION DISTINCT\n\nSELECT\n(SELECT person_id FROM person AS p WHERE p.person_source_value = o.PATIENT_NUMBER) AS person_id,\nCASE \nWHEN OBSERVATION_DATETIME IS NULL THEN CAST('1800-01-01' AS DATE)\nELSE CAST(OBSERVATION_DATETIME AS DATE) END AS measurement_date,\nOBSERVATION_DATETIME  AS measurement_datetime, \nCAST(OBSERVATION_DATETIME  AS TIME) AS measurement_time,\nSAFE_CAST(OBSERVATION_VALUE AS FLOAT64) AS value_as_number,\nNULL AS range_low,\nNULL AS range_high,\nNULL AS provider_id,\nNULL AS visit_occurrence_id,\nOBSERVATION_TYPE AS measurement_source_value,\nNULL AS unit_source_value,\nOBSERVATION_VALUE AS value_source_value\nFROM  observation o\n)\n\nSELECT \nROW_NUMBER() OVER(ORDER BY person_id ASC) AS measurement_id,\nperson_id,\n0 AS measurement_concept_id,\nmeasurement_date,\nCAST(measurement_datetime AS DATETIME) AS measurement_datetime, \nCAST(measurement_time AS STRING) AS measurement_time,\n0 AS measurement_type_concept_id,\n0 AS operator_concept_id,\nCAST(value_as_number AS FLOAT64) AS value_as_number,\n0 AS value_as_concept_id,\n0 AS unit_concept_id,\nCAST(range_low AS FLOAT64) AS range_low,\nCAST(range_high AS FLOAT64) AS range_high,\nCAST(provider_id AS INT64) AS provider_id,\nCAST(visit_occurrence_id AS INT64) AS visit_occurrence_id,\n0 AS visit_detail_id,\nmeasurement_source_value,\n0 AS measurement_source_concept_id,\nunit_source_value,\n0 AS unit_source_concept_id,\nvalue_source_value,\nCAST(NULL AS INT64) AS measurement_event_id,\nCAST(NULL AS INT64) AS meas_event_field_concept_id\nFROM intermediate_measurement ORDER BY measurement_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`measurement`"}, "model.NPS_OMOP_CDM.observation": {"raw_sql": "with final_alcohol_status as (\n    SELECT * FROM {{ ref('intermediate_stg_alcohol_status')}}\n),\n\nfinal_smoking_status as (\n    SELECT * FROM {{ ref('intermediate_stg_smoking_status')}}\n),\n\nfinal_observation as (\n    SELECT * FROM {{ ref('intermediate_stg_observation')}}\n),\n\nfinal_allergy_reaction as (\n    SELECT * FROM {{ ref('intermediate_stg_allergy_reaction')}}\n),\n\nfinal_patient as (\n    SELECT * FROM {{ ref('intermediate_stg_patient')}}\n),\nfinal_requested_test as (\n    SELECT * FROM {{ ref('intermediate_stg_requested_test')}}\n),\n\nintermediate_observation as (\n\n    SELECT * FROM final_alcohol_status\n    UNION ALL\n    -- TODO: Commented for now, fix this\n    -- SELECT * FROM final_smoking_status\n    -- UNION ALL\n    SELECT * FROM final_observation\n    UNION ALL\n    SELECT * FROM final_allergy_reaction\n    UNION ALL\n    SELECT * FROM final_patient\n    UNION ALL\n    SELECT * FROM final_requested_test\n)\n\nSELECT \nROW_NUMBER() OVER(ORDER BY observation_date ASC) AS observation_id,\nperson_id,\n0 as observation_concept_id,\nobservation_date,\nobservation_datetime,\n0 as observation_type_concept_id,\nvalue_as_number,\nvalue_as_string,\n0 as value_as_concept_id,\n0 as qualifier_concept_id,\n0 as unit_concept_id,\nNULL as provider_id,\nNULL as visit_occurrence_id,\nNULL as visit_detail_id,\nobservation_source_value,\n0 as observation_source_concept_id,\nunit_source_value,\nCAST(NULL AS STRING) as qualifier_source_value,\nvalue_source_value,\n0 as observation_event_id,\n0 as obs_event_field_concept_id,\nFROM intermediate_observation \nORDER BY observation_id", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.NPS_OMOP_CDM.intermediate_stg_alcohol_status", "model.NPS_OMOP_CDM.intermediate_stg_smoking_status", "model.NPS_OMOP_CDM.intermediate_stg_observation", "model.NPS_OMOP_CDM.intermediate_stg_allergy_reaction", "model.NPS_OMOP_CDM.intermediate_stg_patient", "model.NPS_OMOP_CDM.intermediate_stg_requested_test"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "Observation", "observation"], "unique_id": "model.NPS_OMOP_CDM.observation", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\Observation\\observation.sql", "original_file_path": "models\\CDM\\Observation\\observation.sql", "name": "observation", "alias": "observation", "checksum": {"name": "sha256", "checksum": "c722b52bff2b7a92c78f7464f985f14c07ba20cb4ed0c12c0153111708256dc9"}, "tags": [], "refs": [["intermediate_stg_alcohol_status"], ["intermediate_stg_smoking_status"], ["intermediate_stg_observation"], ["intermediate_stg_allergy_reaction"], ["intermediate_stg_patient"], ["intermediate_stg_requested_test"]], "sources": [], "description": "", "columns": {"observation_id": {"name": "observation_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "person_id": {"name": "person_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\Observation\\observation.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Observation\\observation.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651482438.6815488, "compiled_sql": "with final_alcohol_status as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_alcohol_status`\n),\n\nfinal_smoking_status as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_smoking_status`\n),\n\nfinal_observation as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_observation`\n),\n\nfinal_allergy_reaction as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_allergy_reaction`\n),\n\nfinal_patient as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_patient`\n),\nfinal_requested_test as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_requested_test`\n),\n\nintermediate_observation as (\n\n    SELECT * FROM final_alcohol_status\n    UNION ALL\n    -- TODO: Commented for now, fix this\n    -- SELECT * FROM final_smoking_status\n    -- UNION ALL\n    SELECT * FROM final_observation\n    UNION ALL\n    SELECT * FROM final_allergy_reaction\n    UNION ALL\n    SELECT * FROM final_patient\n    UNION ALL\n    SELECT * FROM final_requested_test\n)\n\nSELECT \nROW_NUMBER() OVER(ORDER BY observation_date ASC) AS observation_id,\nperson_id,\n0 as observation_concept_id,\nobservation_date,\nobservation_datetime,\n0 as observation_type_concept_id,\nvalue_as_number,\nvalue_as_string,\n0 as value_as_concept_id,\n0 as qualifier_concept_id,\n0 as unit_concept_id,\nNULL as provider_id,\nNULL as visit_occurrence_id,\nNULL as visit_detail_id,\nobservation_source_value,\n0 as observation_source_concept_id,\nunit_source_value,\nCAST(NULL AS STRING) as qualifier_source_value,\nvalue_source_value,\n0 as observation_event_id,\n0 as obs_event_field_concept_id,\nFROM intermediate_observation \nORDER BY observation_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`observation`"}, "model.NPS_OMOP_CDM.observation_period": {"raw_sql": "with encounter as (\r\n    SELECT \r\n    *\r\n    FROM {{ ref('stg_observation_period_encounter')}}\r\n),\r\n\r\nperson AS (\r\nSELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person') }}\r\n),\r\n\r\nintermediate_observation_period as (\r\nSELECT\r\n(\r\nSELECT p.person_id FROM person p WHERE p.person_source_value = en.patient_number\r\n) as person_id,\r\nMIN(CASE \r\n        {{ convert_datetime_string_to_date('ENCOUNTER_START_DATETIME') }} \r\n        ELSE \r\n            CASE WHEN VISIT_DATE IS NULL THEN\r\n                CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', CREATED_DATETIME)) AS DATE)\r\n                ELSE VISIT_DATE\r\n            END\r\n    END) \r\nAS observation_period_start_date,\r\nMAX(CASE\r\n{{ convert_datetime_string_to_date('ENCOUNTER_END_DATETIME') }}\r\n    ELSE \r\n        CASE WHEN VISIT_DATE IS NULL THEN\r\n                CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', CREATED_DATETIME)) AS DATE)\r\n                ELSE VISIT_DATE\r\n            END\r\n    END) AS observation_period_end_date,\r\n\r\nFROM encounter en\r\nGROUP BY person_id\r\n)\r\n\r\nSELECT \r\nROW_NUMBER() OVER(ORDER BY person_id ASC) AS observation_period_id,\r\nperson_id,\r\nobservation_period_start_date,\r\nobservation_period_end_date,\r\n0 AS period_type_concept_id\r\nFROM intermediate_observation_period ORDER BY observation_period_id", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.NPS_OMOP_CDM.convert_datetime_string_to_date"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.stg_observation_period_encounter"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "Observation_Period", "observation_period"], "unique_id": "model.NPS_OMOP_CDM.observation_period", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\Observation_Period\\observation_period.sql", "original_file_path": "models\\CDM\\Observation_Period\\observation_period.sql", "name": "observation_period", "alias": "observation_period", "checksum": {"name": "sha256", "checksum": "6e316b39f10c2caf16c418db2cdf01b676b9c69ce787df7385a5518b9aa751ae"}, "tags": [], "refs": [["stg_observation_period_encounter"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {"observation_period_id": {"name": "observation_period_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "person_id": {"name": "person_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "observation_period_start_date": {"name": "observation_period_start_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "observation_period_end_date": {"name": "observation_period_end_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "period_type_concept_id": {"name": "period_type_concept_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\Observation_Period\\observation_period.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Observation_Period\\observation_period.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651482438.6994743, "compiled_sql": "with encounter as (\n    SELECT \n    *\n    FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_observation_period_encounter`\n),\n\nperson AS (\nSELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\n\nintermediate_observation_period as (\nSELECT\n(\nSELECT p.person_id FROM person p WHERE p.person_source_value = en.patient_number\n) as person_id,\nMIN(CASE \n        \n \n        WHEN REGEXP_CONTAINS(ENCOUNTER_START_DATETIME  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \n        THEN CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', ENCOUNTER_START_DATETIME)) AS DATE) \n    \n \n        ELSE \n            CASE WHEN VISIT_DATE IS NULL THEN\n                CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', CREATED_DATETIME)) AS DATE)\n                ELSE VISIT_DATE\n            END\n    END) \nAS observation_period_start_date,\nMAX(CASE\n\n \n        WHEN REGEXP_CONTAINS(ENCOUNTER_END_DATETIME  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \n        THEN CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', ENCOUNTER_END_DATETIME)) AS DATE) \n    \n\n    ELSE \n        CASE WHEN VISIT_DATE IS NULL THEN\n                CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', CREATED_DATETIME)) AS DATE)\n                ELSE VISIT_DATE\n            END\n    END) AS observation_period_end_date,\n\nFROM encounter en\nGROUP BY person_id\n)\n\nSELECT \nROW_NUMBER() OVER(ORDER BY person_id ASC) AS observation_period_id,\nperson_id,\nobservation_period_start_date,\nobservation_period_end_date,\n0 AS period_type_concept_id\nFROM intermediate_observation_period ORDER BY observation_period_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`observation_period`"}, "model.NPS_OMOP_CDM.payer_plan_period": {"raw_sql": "with billing_service as (\r\n    SELECT \r\n    *\r\n    FROM {{ ref('stg_payer_plan_period_billing_service')}}\r\n\r\n),\r\n\r\nperson as (\r\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person') }}\r\n),\r\n\r\nintermediate_payer_plan_period as (\r\nSELECT \r\n(SELECT person_id FROM person p WHERE p.person_source_value = bs.PATIENT_NUMBER) AS person_id,\r\nCAST(SERVICE_DATETIME AS DATE) AS payer_plan_period_start_date,\r\nITEM_NUMBER AS payer_source_value,\r\nSERVICE_ID AS plan_source_value\r\nFROM billing_service bs\r\n)\r\n\r\nSELECT \r\nROW_NUMBER() OVER(ORDER BY person_id ASC) AS payer_plan_period_id,\r\nperson_id,\r\npayer_plan_period_start_date,\r\nCURRENT_DATE() AS payer_plan_period_end_date,\r\n0 AS payer_concept_id,\r\npayer_source_value,\r\n0 AS payer_source_concept_id,\r\n0 AS plan_concept_id,\r\nplan_source_value,\r\n0 AS plan_source_concept_id,\r\n0 AS sponsor_concept_id,\r\nCAST(NULL AS STRING) AS sponsor_source_value,\r\n0 AS sponsor_source_concept_id,\r\nCAST(NULL AS STRING) AS family_source_value,\r\n0 AS stop_reason_concept_id,\r\nCAST(NULL AS STRING) AS stop_reason_source_value,\r\n0 AS stop_reason_source_concept_id\r\nFROM intermediate_payer_plan_period ORDER BY payer_plan_period_id", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.stg_payer_plan_period_billing_service"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "Payer_Plan_Period", "payer_plan_period"], "unique_id": "model.NPS_OMOP_CDM.payer_plan_period", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\Payer_Plan_Period\\payer_plan_period.sql", "original_file_path": "models\\CDM\\Payer_Plan_Period\\payer_plan_period.sql", "name": "payer_plan_period", "alias": "payer_plan_period", "checksum": {"name": "sha256", "checksum": "520b86291b2a53dab203832d3d5f17b0e133ff1bd72e5ba4d1bacae63cf762dc"}, "tags": [], "refs": [["stg_payer_plan_period_billing_service"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {"payer_plan_period_id": {"name": "payer_plan_period_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "person_id": {"name": "person_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "payer_plan_period_start_date": {"name": "payer_plan_period_start_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "payer_plan_period_end_date": {"name": "payer_plan_period_end_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\Payer_Plan_Period\\payer_plan_period.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Payer_Plan_Period\\payer_plan_period.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651482438.7204185, "compiled_sql": "with billing_service as (\n    SELECT \n    *\n    FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_payer_plan_period_billing_service`\n\n),\n\nperson as (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\n\nintermediate_payer_plan_period as (\nSELECT \n(SELECT person_id FROM person p WHERE p.person_source_value = bs.PATIENT_NUMBER) AS person_id,\nCAST(SERVICE_DATETIME AS DATE) AS payer_plan_period_start_date,\nITEM_NUMBER AS payer_source_value,\nSERVICE_ID AS plan_source_value\nFROM billing_service bs\n)\n\nSELECT \nROW_NUMBER() OVER(ORDER BY person_id ASC) AS payer_plan_period_id,\nperson_id,\npayer_plan_period_start_date,\nCURRENT_DATE() AS payer_plan_period_end_date,\n0 AS payer_concept_id,\npayer_source_value,\n0 AS payer_source_concept_id,\n0 AS plan_concept_id,\nplan_source_value,\n0 AS plan_source_concept_id,\n0 AS sponsor_concept_id,\nCAST(NULL AS STRING) AS sponsor_source_value,\n0 AS sponsor_source_concept_id,\nCAST(NULL AS STRING) AS family_source_value,\n0 AS stop_reason_concept_id,\nCAST(NULL AS STRING) AS stop_reason_source_value,\n0 AS stop_reason_source_concept_id\nFROM intermediate_payer_plan_period ORDER BY payer_plan_period_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`payer_plan_period`"}, "model.NPS_OMOP_CDM.person": {"raw_sql": "WITH patient AS (\n    SELECT *\n    FROM {{ ref('stg_person_patient')}}\n),\nlocation AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'location') }}\n),\n\ncare_site AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'care_site') }}\n),\n\nvisit AS (\n    SELECT site_id, PATIENT_NUMBER FROM {{ref('stg_person_encounter')}}\n    UNION DISTINCT\n    SELECT site_id, PATIENT_NUMBER FROM {{ref('stg_person_encounter_reason')}}\n),\nintermediate_person AS(\n    SELECT \n    0 AS gender_concept_id,\n    (CASE WHEN YEAR_OF_BIRTH IS NULL THEN 1900\n    ELSE YEAR_OF_BIRTH END) AS year_of_birth,\n    0 AS month_of_birth,\n    0 AS day_of_birth,\n    CAST(NULL AS DATETIME) AS birth_datetime,\n    0 AS race_concept_id,\n    0 AS ethnicity_concept_id,\n    (\n    SELECT location_id FROM location \n    WHERE  location_source_value = SUBSTRING(\n        {{ safe_concat(['p.patient_city', 'p.patient_postcode']) }},1,50)\n    ) AS location_id,\n    CAST(NULL AS INT64) AS provider_id,\n    (SELECT care_site_id FROM care_site cr INNER JOIN visit v on cr.care_site_source_value = v.site_id\n    WHERE v.patient_number = p.patient_number) as care_site_id,\n    CAST(PATIENT_NUMBER AS STRING) AS person_source_value,\n    CAST(GENDER_NAME AS STRING) AS gender_source_value,\n    0 AS gender_source_concept_id,\n    CAST(NULL AS STRING) AS race_source_value,\n    0 AS race_source_concept_id,\n    CAST(ATSI_NAME AS STRING) AS ethnicity_source_value,\n    0 AS ethnicity_source_concept_id\n    FROM patient p\n)\n\nSELECT \nROW_NUMBER() OVER(ORDER BY person_source_value ASC) AS person_id,\ngender_concept_id,\nyear_of_birth,\nmonth_of_birth,\nday_of_birth,\nbirth_datetime,\nrace_concept_id,\nethnicity_concept_id,\nlocation_id,\nprovider_id,\ncare_site_id,\nperson_source_value,\ngender_source_value,\ngender_source_concept_id,\nrace_source_value,\nrace_source_concept_id,\nethnicity_source_value,\nethnicity_source_concept_id\nFROM intermediate_person ORDER BY person_id", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.NPS_OMOP_CDM.safe_concat"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.location", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site", "model.NPS_OMOP_CDM.stg_person_patient", "model.NPS_OMOP_CDM.stg_person_encounter", "model.NPS_OMOP_CDM.stg_person_encounter_reason"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "Person", "person"], "unique_id": "model.NPS_OMOP_CDM.person", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\Person\\person.sql", "original_file_path": "models\\CDM\\Person\\person.sql", "name": "person", "alias": "person", "checksum": {"name": "sha256", "checksum": "0dbb9185ec87ab734cea8902939c4054a1d1b11e08b4dcd565d7803c6e5ba759"}, "tags": [], "refs": [["stg_person_patient"], ["stg_person_encounter"], ["stg_person_encounter_reason"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "location"], ["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "care_site"]], "description": "", "columns": {"person_id": {"name": "person_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "gender_concept_id": {"name": "gender_concept_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "year_of_birth": {"name": "year_of_birth", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "race_concept_id": {"name": "race_concept_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "ethnicity_concept_id": {"name": "ethnicity_concept_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "location_id": {"name": "location_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "care_site_id": {"name": "care_site_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\Person\\person.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Person\\person.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651482438.748343, "compiled_sql": "WITH patient AS (\n    SELECT *\n    FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_person_patient`\n),\nlocation AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`location`\n),\n\ncare_site AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`care_site`\n),\n\nvisit AS (\n    SELECT site_id, PATIENT_NUMBER FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_person_encounter`\n    UNION DISTINCT\n    SELECT site_id, PATIENT_NUMBER FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_person_encounter_reason`\n),\nintermediate_person AS(\n    SELECT \n    0 AS gender_concept_id,\n    (CASE WHEN YEAR_OF_BIRTH IS NULL THEN 1900\n    ELSE YEAR_OF_BIRTH END) AS year_of_birth,\n    0 AS month_of_birth,\n    0 AS day_of_birth,\n    CAST(NULL AS DATETIME) AS birth_datetime,\n    0 AS race_concept_id,\n    0 AS ethnicity_concept_id,\n    (\n    SELECT location_id FROM location \n    WHERE  location_source_value = SUBSTRING(\n        \n  \n\n  RTRIM(CONCAT(\n    case when p.patient_city is null then \"\" \n     \n    else concat(CAST(p.patient_city AS STRING),\"_\") end, \n    \n  \n    case when p.patient_postcode is null then \"\" \n    \n    else CAST(p.patient_postcode AS STRING) end\n    \n  ), '_')\n,1,50)\n    ) AS location_id,\n    CAST(NULL AS INT64) AS provider_id,\n    (SELECT care_site_id FROM care_site cr INNER JOIN visit v on cr.care_site_source_value = v.site_id\n    WHERE v.patient_number = p.patient_number) as care_site_id,\n    CAST(PATIENT_NUMBER AS STRING) AS person_source_value,\n    CAST(GENDER_NAME AS STRING) AS gender_source_value,\n    0 AS gender_source_concept_id,\n    CAST(NULL AS STRING) AS race_source_value,\n    0 AS race_source_concept_id,\n    CAST(ATSI_NAME AS STRING) AS ethnicity_source_value,\n    0 AS ethnicity_source_concept_id\n    FROM patient p\n)\n\nSELECT \nROW_NUMBER() OVER(ORDER BY person_source_value ASC) AS person_id,\ngender_concept_id,\nyear_of_birth,\nmonth_of_birth,\nday_of_birth,\nbirth_datetime,\nrace_concept_id,\nethnicity_concept_id,\nlocation_id,\nprovider_id,\ncare_site_id,\nperson_source_value,\ngender_source_value,\ngender_source_concept_id,\nrace_source_value,\nrace_source_concept_id,\nethnicity_source_value,\nethnicity_source_concept_id\nFROM intermediate_person ORDER BY person_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`"}, "model.NPS_OMOP_CDM.procedure_occurrence": {"raw_sql": "with diagnosis AS (\r\n    SELECT * FROM {{ ref('stg_procedure_occurrence_diagnosis')}}\r\n),\r\n\r\nencounter_reason AS (\r\n    SELECT * FROM {{ ref('stg_procedure_occurrence_encounter_reason')}}\r\n),\r\n\r\nprescription AS (\r\n    SELECT * FROM {{ ref('stg_procedure_occurrence_prescription')}}\r\n),\r\n\r\nscript_item AS (\r\n    SELECT * FROM {{ ref('stg_procedure_occurrence_script_item')}}\r\n),\r\n\r\nrequested_test AS (\r\n    SELECT * FROM {{ ref('stg_procedure_occurrence_requested_test')}}\r\n),\r\n\r\nimmunisation AS (\r\n    SELECT * FROM {{ ref('stg_procedure_occurrence_immunisation')}}\r\n),\r\n\r\nperson AS(\r\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person') }}\r\n),\r\n\r\ncare_site AS(\r\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'care_site') }}\r\n),\r\n\r\nprovider AS(\r\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'provider') }}\r\n),\r\n\r\nvisit_occurrence AS(\r\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'visit_occurrence') }}\r\n),\r\n\r\ncare_site_provider AS(\r\n    SELECT p.provider_id, cs.care_site_id, p.provider_source_value, cs.care_site_source_value FROM provider p INNER JOIN care_site cs\r\n    ON p.care_site_id = cs.care_site_id \r\n),\r\n\r\nintermediate_procedure_occurrence AS (\r\nSELECT  \r\n(SELECT person_id FROM person AS p WHERE p.person_source_value = rt.PATIENT_NUMBER) AS person_id, \r\nCASE \r\nWHEN REQUEST_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\r\nELSE CAST(REQUEST_DATE AS DATE) END AS procedure_date,\r\nCAST(REQUEST_DATE AS DATETIME) AS procedure_datetime,\r\nCAST(REQUEST_DATE AS DATE) AS procedure_end_date, \r\nCAST(REQUEST_DATE AS DATETIME) AS procedure_end_datetime,\t\r\nNULL AS provider_id,\r\nNULL AS visit_occurrence_id, \r\nREQUEST_TYPE AS procedure_source_value, \r\nFROM requested_test rt\r\n\r\n\r\nUNION DISTINCT\r\n\r\nSELECT  \r\n(SELECT person_id FROM person AS p WHERE p.person_source_value = im.PATIENT_NUMBER) AS person_id, \r\nCASE \r\nWHEN GIVEN_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\r\nELSE CAST(GIVEN_DATE AS DATE) END AS procedure_date,\r\nCAST(GIVEN_DATE AS DATETIME) AS procedure_datetime,\r\nNULL AS procedure_end_date, \r\nNULL AS procedure_end_datetime,\t\r\nNULL AS provider_id,\r\nNULL AS visit_occurrence_id, \r\nVACCINE_NAME AS procedure_source_value, \r\nFROM immunisation im \r\n\r\n\r\nUNION DISTINCT\r\n\r\nSELECT \r\n(SELECT person_id FROM person AS p WHERE p.person_source_value = d.PATIENT_NUMBER) AS person_id,\r\nCASE \r\nWHEN DIAGNOSIS_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\r\nELSE CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', DIAGNOSIS_DATE)) AS DATE) END AS procedure_date,\r\nPARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', DIAGNOSIS_DATE) AS procedure_datetime,\r\nNULL AS procedure_end_date, \r\nNULL AS procedure_end_datetime,\t\r\nNULL AS provider_id, \r\nNULL AS visit_occurrence_id,  \r\nDIAGNOSIS_REASON AS procedure_source_value, \r\nFROM diagnosis d\r\n \r\n\r\nUNION DISTINCT\r\n\r\nSELECT \r\n(SELECT person_id FROM person AS p WHERE p.person_source_value = er.PATIENT_NUMBER) AS person_id,\r\nCASE \r\nWHEN VISIT_DATETIME IS NULL THEN CAST('1800-01-01' AS DATE)\r\nELSE CAST(VISIT_DATETIME AS DATE) END AS procedure_date,\r\nCAST(VISIT_DATETIME AS DATETIME) AS procedure_datetime,\r\nNULL AS procedure_end_date, \r\nNULL AS procedure_end_datetime,\t\r\nNULL AS provider_id, \r\nNULL AS visit_occurrence_id,  \r\nENCOUNTER_REASONS AS procedure_source_value, \r\nFROM  encounter_reason er\r\n \r\n\r\nUNION DISTINCT\r\n\r\nSELECT \r\n(SELECT person_id FROM person AS p WHERE p.person_source_value = pre.PATIENT_NUMBER) AS person_id,\r\nCASE\r\nWHEN FIRST_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\r\nELSE CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', FIRST_DATE)) AS DATE) END AS procedure_date,\r\nPARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', FIRST_DATE) AS procedure_datetime,\r\nNULL AS procedure_end_date, \r\nNULL AS procedure_end_datetime,\t\r\nNULL AS provider_id, \r\nNULL AS visit_occurrence_id, \r\n{{ safe_concat(['MEDICINE_NAME','MEDICINE_ACTIVE_INGREDIENT','STRENGTH']) }} AS  procedure_source_value, \r\nFROM prescription pre\r\n\r\nUNION DISTINCT\r\n\r\nSELECT \r\n(SELECT person_id FROM person AS p WHERE p.person_source_value = si.PATIENT_NUMBER)AS person_id,\r\nCASE\r\nWHEN SCRIPT_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\r\nELSE CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', SCRIPT_DATE)) AS DATE) END AS procedure_date,\r\nPARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', SCRIPT_DATE) AS procedure_datetime,\r\nNULL AS procedure_end_date, \r\nNULL AS procedure_end_datetime,\t\r\nNULL AS provider_id, \r\nNULL AS visit_occurrence_id, \r\n{{ safe_concat(['MEDICINE_NAME','MEDICINE_ACTIVE_INGREDIENT','STRENGTH']) }} AS  procedure_source_value, \r\nFROM script_item si\r\n\r\n)\r\n\r\nSELECT \r\nROW_NUMBER() OVER(ORDER BY person_id ASC) AS procedure_occurrence_id,\r\nperson_id,\r\n0 AS procedure_concept_id, \r\nprocedure_date,\r\nCAST(procedure_datetime AS DATETIME) AS procedure_datetime,\r\nCAST(procedure_end_date AS DATE) AS procedure_end_date,\r\nCAST(procedure_end_datetime AS DATETIME) AS procedure_end_datetime,\r\n0 AS procedure_type_concept_id, \r\n0 AS modifier_concept_id, \r\n0 AS quantity,\r\nCAST(provider_id AS INT64) AS provider_id ,\r\nCAST(visit_occurrence_id AS INT64) AS visit_occurrence_id,\r\n0 AS visit_detail_id,\r\nprocedure_source_value,\r\n0 AS procedure_source_concept_id, \r\nCAST(NULL AS STRING) AS modifier_source_value\r\nFROM intermediate_procedure_occurrence ORDER BY procedure_occurrence_id", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.NPS_OMOP_CDM.safe_concat"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.provider", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence", "model.NPS_OMOP_CDM.stg_procedure_occurrence_diagnosis", "model.NPS_OMOP_CDM.stg_procedure_occurrence_encounter_reason", "model.NPS_OMOP_CDM.stg_procedure_occurrence_prescription", "model.NPS_OMOP_CDM.stg_procedure_occurrence_script_item", "model.NPS_OMOP_CDM.stg_procedure_occurrence_requested_test", "model.NPS_OMOP_CDM.stg_procedure_occurrence_immunisation"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "Procedure_Occurrence", "procedure_occurrence"], "unique_id": "model.NPS_OMOP_CDM.procedure_occurrence", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\Procedure_Occurrence\\procedure_occurrence.sql", "original_file_path": "models\\CDM\\Procedure_Occurrence\\procedure_occurrence.sql", "name": "procedure_occurrence", "alias": "procedure_occurrence", "checksum": {"name": "sha256", "checksum": "3ea59fbf0cb616580533feab39282a978016b2dd9fc73e148bbb17b55e8bda1c"}, "tags": [], "refs": [["stg_procedure_occurrence_diagnosis"], ["stg_procedure_occurrence_encounter_reason"], ["stg_procedure_occurrence_prescription"], ["stg_procedure_occurrence_script_item"], ["stg_procedure_occurrence_requested_test"], ["stg_procedure_occurrence_immunisation"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"], ["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "care_site"], ["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "provider"], ["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "visit_occurrence"]], "description": "", "columns": {"procedure_occurrence_id": {"name": "procedure_occurrence_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "person_id": {"name": "person_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "visit_occurrence_id": {"name": "visit_occurrence_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "procedure_date": {"name": "procedure_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\Procedure_Occurrence\\procedure_occurrence.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Procedure_Occurrence\\procedure_occurrence.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651482438.7842467, "compiled_sql": "with diagnosis AS (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_procedure_occurrence_diagnosis`\n),\n\nencounter_reason AS (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_procedure_occurrence_encounter_reason`\n),\n\nprescription AS (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_procedure_occurrence_prescription`\n),\n\nscript_item AS (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_procedure_occurrence_script_item`\n),\n\nrequested_test AS (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_procedure_occurrence_requested_test`\n),\n\nimmunisation AS (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_procedure_occurrence_immunisation`\n),\n\nperson AS(\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\n\ncare_site AS(\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`care_site`\n),\n\nprovider AS(\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`provider`\n),\n\nvisit_occurrence AS(\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`visit_occurrence`\n),\n\ncare_site_provider AS(\n    SELECT p.provider_id, cs.care_site_id, p.provider_source_value, cs.care_site_source_value FROM provider p INNER JOIN care_site cs\n    ON p.care_site_id = cs.care_site_id \n),\n\nintermediate_procedure_occurrence AS (\nSELECT  \n(SELECT person_id FROM person AS p WHERE p.person_source_value = rt.PATIENT_NUMBER) AS person_id, \nCASE \nWHEN REQUEST_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\nELSE CAST(REQUEST_DATE AS DATE) END AS procedure_date,\nCAST(REQUEST_DATE AS DATETIME) AS procedure_datetime,\nCAST(REQUEST_DATE AS DATE) AS procedure_end_date, \nCAST(REQUEST_DATE AS DATETIME) AS procedure_end_datetime,\t\nNULL AS provider_id,\nNULL AS visit_occurrence_id, \nREQUEST_TYPE AS procedure_source_value, \nFROM requested_test rt\n\n\nUNION DISTINCT\n\nSELECT  \n(SELECT person_id FROM person AS p WHERE p.person_source_value = im.PATIENT_NUMBER) AS person_id, \nCASE \nWHEN GIVEN_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\nELSE CAST(GIVEN_DATE AS DATE) END AS procedure_date,\nCAST(GIVEN_DATE AS DATETIME) AS procedure_datetime,\nNULL AS procedure_end_date, \nNULL AS procedure_end_datetime,\t\nNULL AS provider_id,\nNULL AS visit_occurrence_id, \nVACCINE_NAME AS procedure_source_value, \nFROM immunisation im \n\n\nUNION DISTINCT\n\nSELECT \n(SELECT person_id FROM person AS p WHERE p.person_source_value = d.PATIENT_NUMBER) AS person_id,\nCASE \nWHEN DIAGNOSIS_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\nELSE CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', DIAGNOSIS_DATE)) AS DATE) END AS procedure_date,\nPARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', DIAGNOSIS_DATE) AS procedure_datetime,\nNULL AS procedure_end_date, \nNULL AS procedure_end_datetime,\t\nNULL AS provider_id, \nNULL AS visit_occurrence_id,  \nDIAGNOSIS_REASON AS procedure_source_value, \nFROM diagnosis d\n \n\nUNION DISTINCT\n\nSELECT \n(SELECT person_id FROM person AS p WHERE p.person_source_value = er.PATIENT_NUMBER) AS person_id,\nCASE \nWHEN VISIT_DATETIME IS NULL THEN CAST('1800-01-01' AS DATE)\nELSE CAST(VISIT_DATETIME AS DATE) END AS procedure_date,\nCAST(VISIT_DATETIME AS DATETIME) AS procedure_datetime,\nNULL AS procedure_end_date, \nNULL AS procedure_end_datetime,\t\nNULL AS provider_id, \nNULL AS visit_occurrence_id,  \nENCOUNTER_REASONS AS procedure_source_value, \nFROM  encounter_reason er\n \n\nUNION DISTINCT\n\nSELECT \n(SELECT person_id FROM person AS p WHERE p.person_source_value = pre.PATIENT_NUMBER) AS person_id,\nCASE\nWHEN FIRST_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\nELSE CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', FIRST_DATE)) AS DATE) END AS procedure_date,\nPARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', FIRST_DATE) AS procedure_datetime,\nNULL AS procedure_end_date, \nNULL AS procedure_end_datetime,\t\nNULL AS provider_id, \nNULL AS visit_occurrence_id, \n\n  \n\n  RTRIM(CONCAT(\n    case when MEDICINE_NAME is null then \"\" \n     \n    else concat(CAST(MEDICINE_NAME AS STRING),\"_\") end, \n    \n  \n    case when MEDICINE_ACTIVE_INGREDIENT is null then \"\" \n     \n    else concat(CAST(MEDICINE_ACTIVE_INGREDIENT AS STRING),\"_\") end, \n    \n  \n    case when STRENGTH is null then \"\" \n    \n    else CAST(STRENGTH AS STRING) end\n    \n  ), '_')\n AS  procedure_source_value, \nFROM prescription pre\n\nUNION DISTINCT\n\nSELECT \n(SELECT person_id FROM person AS p WHERE p.person_source_value = si.PATIENT_NUMBER)AS person_id,\nCASE\nWHEN SCRIPT_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\nELSE CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', SCRIPT_DATE)) AS DATE) END AS procedure_date,\nPARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', SCRIPT_DATE) AS procedure_datetime,\nNULL AS procedure_end_date, \nNULL AS procedure_end_datetime,\t\nNULL AS provider_id, \nNULL AS visit_occurrence_id, \n\n  \n\n  RTRIM(CONCAT(\n    case when MEDICINE_NAME is null then \"\" \n     \n    else concat(CAST(MEDICINE_NAME AS STRING),\"_\") end, \n    \n  \n    case when MEDICINE_ACTIVE_INGREDIENT is null then \"\" \n     \n    else concat(CAST(MEDICINE_ACTIVE_INGREDIENT AS STRING),\"_\") end, \n    \n  \n    case when STRENGTH is null then \"\" \n    \n    else CAST(STRENGTH AS STRING) end\n    \n  ), '_')\n AS  procedure_source_value, \nFROM script_item si\n\n)\n\nSELECT \nROW_NUMBER() OVER(ORDER BY person_id ASC) AS procedure_occurrence_id,\nperson_id,\n0 AS procedure_concept_id, \nprocedure_date,\nCAST(procedure_datetime AS DATETIME) AS procedure_datetime,\nCAST(procedure_end_date AS DATE) AS procedure_end_date,\nCAST(procedure_end_datetime AS DATETIME) AS procedure_end_datetime,\n0 AS procedure_type_concept_id, \n0 AS modifier_concept_id, \n0 AS quantity,\nCAST(provider_id AS INT64) AS provider_id ,\nCAST(visit_occurrence_id AS INT64) AS visit_occurrence_id,\n0 AS visit_detail_id,\nprocedure_source_value,\n0 AS procedure_source_concept_id, \nCAST(NULL AS STRING) AS modifier_source_value\nFROM intermediate_procedure_occurrence ORDER BY procedure_occurrence_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`procedure_occurrence`"}, "model.NPS_OMOP_CDM.provider": {"raw_sql": "with clinical_user AS (\r\nSELECT * FROM {{ ref('stg_provider_clinical_user') }}\r\n),\r\n\r\npatient_matched_usual_provider AS ( \r\n    SELECT * FROM {{ ref('stg_provider_patient_matched_usual_provider') }}   \r\n),\r\n\r\n\r\npractice_contact AS (\r\nSELECT * FROM {{ ref('stg_provider_practice_contact') }}\r\n),\r\n\r\nrequested_test AS (\r\nSELECT * FROM {{ ref('stg_provider_requested_test') }}\r\n),\r\n\r\ncare_site AS (\r\nSELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'care_site') }}\r\n),\r\n\r\nintermediate_provider AS (\r\nSELECT NULL AS provider_name,\r\n(\r\nSELECT cs.care_site_id FROM care_site AS cs where cs.care_site_source_value = pc.SITE_ID\r\n) AS care_site_id, SUBSTRING(pc.provider_number,1,50) AS provider_source_value, NULL as gender_source_value\r\nFROM practice_contact pc\r\n\r\nUNION DISTINCT\r\n\r\nSELECT NULL AS provider_name,\r\n(\r\nSELECT cs.care_site_id FROM care_site AS cs where cs.care_site_source_value = cu.SITE_ID\r\n) AS care_site_id, SUBSTRING(cu.provider_number,1,50) AS provider_source_value, NULL as gender_source_value\r\nFROM clinical_user cu\r\n\r\nUNION DISTINCT \r\n\r\nSELECT \r\nNULL AS provider_name,\r\n(\r\nSELECT cs.care_site_id FROM care_site AS cs where cs.care_site_source_value = pmup.SITE_ID\r\n) AS care_site_id,\r\nSUBSTRING(pmup.provider_number,1,50) AS provider_source_value, pmup.PROVIDER_GENDER as gender_source_value\r\nFROM patient_matched_usual_provider pmup\r\n\r\nUNION DISTINCT \r\n\r\nSELECT \r\nSUBSTRING(rt.PROVIDER_LAB_NAME,1,255) AS provider_name,\r\n(\r\nSELECT cs.care_site_id FROM care_site AS cs where cs.care_site_source_value = rt.SITE_ID\r\n) AS care_site_id, SUBSTRING(rt.PROVIDER_ID,1,50)  AS provider_source_value, NULL as gender_source_value\r\nFROM requested_test rt\r\n)\r\n\r\nSELECT \r\nROW_NUMBER() OVER(ORDER BY provider_name ASC) AS provider_id, \r\nCAST(provider_name AS STRING) AS provider_name,\r\nCAST(NULL AS STRING) AS npi, \r\nCAST(NULL AS STRING) AS dea, \r\n0 AS specialty_concept_id,\r\ncare_site_id, \r\nCAST(NULL AS INT64) AS year_of_birth,\r\n0 AS gender_concept_id, \r\nCAST(provider_source_value AS STRING) AS provider_source_value, \r\nCAST(NULL AS STRING) AS specialty_source_value,\r\n0 AS specialty_source_concept_id, \r\nCAST(gender_source_value AS STRING) AS gender_source_value,\r\n0 AS gender_source_concept_id  \r\nFROM intermediate_provider ORDER BY provider_id", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site", "model.NPS_OMOP_CDM.stg_provider_clinical_user", "model.NPS_OMOP_CDM.stg_provider_patient_matched_usual_provider", "model.NPS_OMOP_CDM.stg_provider_practice_contact", "model.NPS_OMOP_CDM.stg_provider_requested_test"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "Provider", "provider"], "unique_id": "model.NPS_OMOP_CDM.provider", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\Provider\\provider.sql", "original_file_path": "models\\CDM\\Provider\\provider.sql", "name": "provider", "alias": "provider", "checksum": {"name": "sha256", "checksum": "c039eccc4a80837bd7d69e9270519c6aa3018ad13f6eeb9bb4a3175e12ce0079"}, "tags": [], "refs": [["stg_provider_clinical_user"], ["stg_provider_patient_matched_usual_provider"], ["stg_provider_practice_contact"], ["stg_provider_requested_test"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "care_site"]], "description": "", "columns": {"provider_id": {"name": "provider_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "care_site_id": {"name": "care_site_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\Provider\\provider.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Provider\\provider.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651482438.813169, "compiled_sql": "with clinical_user AS (\nSELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_provider_clinical_user`\n),\n\npatient_matched_usual_provider AS ( \n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_provider_patient_matched_usual_provider`   \n),\n\n\npractice_contact AS (\nSELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_provider_practice_contact`\n),\n\nrequested_test AS (\nSELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_provider_requested_test`\n),\n\ncare_site AS (\nSELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`care_site`\n),\n\nintermediate_provider AS (\nSELECT NULL AS provider_name,\n(\nSELECT cs.care_site_id FROM care_site AS cs where cs.care_site_source_value = pc.SITE_ID\n) AS care_site_id, SUBSTRING(pc.provider_number,1,50) AS provider_source_value, NULL as gender_source_value\nFROM practice_contact pc\n\nUNION DISTINCT\n\nSELECT NULL AS provider_name,\n(\nSELECT cs.care_site_id FROM care_site AS cs where cs.care_site_source_value = cu.SITE_ID\n) AS care_site_id, SUBSTRING(cu.provider_number,1,50) AS provider_source_value, NULL as gender_source_value\nFROM clinical_user cu\n\nUNION DISTINCT \n\nSELECT \nNULL AS provider_name,\n(\nSELECT cs.care_site_id FROM care_site AS cs where cs.care_site_source_value = pmup.SITE_ID\n) AS care_site_id,\nSUBSTRING(pmup.provider_number,1,50) AS provider_source_value, pmup.PROVIDER_GENDER as gender_source_value\nFROM patient_matched_usual_provider pmup\n\nUNION DISTINCT \n\nSELECT \nSUBSTRING(rt.PROVIDER_LAB_NAME,1,255) AS provider_name,\n(\nSELECT cs.care_site_id FROM care_site AS cs where cs.care_site_source_value = rt.SITE_ID\n) AS care_site_id, SUBSTRING(rt.PROVIDER_ID,1,50)  AS provider_source_value, NULL as gender_source_value\nFROM requested_test rt\n)\n\nSELECT \nROW_NUMBER() OVER(ORDER BY provider_name ASC) AS provider_id, \nCAST(provider_name AS STRING) AS provider_name,\nCAST(NULL AS STRING) AS npi, \nCAST(NULL AS STRING) AS dea, \n0 AS specialty_concept_id,\ncare_site_id, \nCAST(NULL AS INT64) AS year_of_birth,\n0 AS gender_concept_id, \nCAST(provider_source_value AS STRING) AS provider_source_value, \nCAST(NULL AS STRING) AS specialty_source_value,\n0 AS specialty_source_concept_id, \nCAST(gender_source_value AS STRING) AS gender_source_value,\n0 AS gender_source_concept_id  \nFROM intermediate_provider ORDER BY provider_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`provider`"}, "model.NPS_OMOP_CDM.stg_care_site_site": {"raw_sql": "with site as (\r\n    SELECT \r\n        {{replace_empty_string_with_null(['SITE_ADDRESS'])}}\r\n        STATE,\r\n        POSTCODE_ORIGINAL,\r\n        SITE_NAME,\r\n        SITE_ID\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'SITE') }}\r\n)\r\n\r\nSELECT * FROM site", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.NPS_OMOP_CDM.replace_empty_string_with_null"], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SITE"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Care_Site", "Site", "stg_care_site_site"], "unique_id": "model.NPS_OMOP_CDM.stg_care_site_site", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Care_Site\\Site\\stg_care_site_site.sql", "original_file_path": "models\\staging\\Care_Site\\Site\\stg_care_site_site.sql", "name": "stg_care_site_site", "alias": "stg_care_site_site", "checksum": {"name": "sha256", "checksum": "ac0c5ed52d89a242a9bd3a8450a55acf232726e102a25f168fb519a721957abb"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "SITE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Care_Site\\Site\\stg_care_site_site.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.196005, "compiled_sql": "with site as (\n    SELECT \n        \n\n  \n    \n    CASE\n    WHEN SITE_ADDRESS  = \"\" THEN NULL\n    ELSE SITE_ADDRESS END AS  SITE_ADDRESS,\n\n  \n\n        STATE,\n        POSTCODE_ORIGINAL,\n        SITE_NAME,\n        SITE_ID\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`SITE`\n)\n\nSELECT * FROM site", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_care_site_site`"}, "model.NPS_OMOP_CDM.stg_condition_occurrence_diagnosis": {"raw_sql": "with diagnosis as (\r\n    SELECT \r\n        *\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'DIAGNOSIS') }}\r\n)\r\n\r\nSELECT * FROM diagnosis", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.DIAGNOSIS"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Condition_Occurrence", "Diagnosis", "stg_condition_occurrence_diagnosis"], "unique_id": "model.NPS_OMOP_CDM.stg_condition_occurrence_diagnosis", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Condition_Occurrence\\Diagnosis\\stg_condition_occurrence_diagnosis.sql", "original_file_path": "models\\staging\\Condition_Occurrence\\Diagnosis\\stg_condition_occurrence_diagnosis.sql", "name": "stg_condition_occurrence_diagnosis", "alias": "stg_condition_occurrence_diagnosis", "checksum": {"name": "sha256", "checksum": "4a6bfc6c4e253f02b7515c3b3070a464aa172ed3e90fd46a001ba0c6f97027cd"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "DIAGNOSIS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Condition_Occurrence\\Diagnosis\\stg_condition_occurrence_diagnosis.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2019804, "compiled_sql": "with diagnosis as (\n    SELECT \n        *\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`DIAGNOSIS`\n)\n\nSELECT * FROM diagnosis", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_condition_occurrence_diagnosis`"}, "model.NPS_OMOP_CDM.stg_condition_occurrence_encounter_reason": {"raw_sql": "with encounter_reason as (\r\n    SELECT \r\n        *\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'ENCOUNTER_REASON') }}\r\n)\r\n\r\nSELECT * FROM encounter_reason", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER_REASON"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Condition_Occurrence", "Encounter_Reason", "stg_condition_occurrence_encounter_reason"], "unique_id": "model.NPS_OMOP_CDM.stg_condition_occurrence_encounter_reason", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Condition_Occurrence\\Encounter_Reason\\stg_condition_occurrence_encounter_reason.sql", "original_file_path": "models\\staging\\Condition_Occurrence\\Encounter_Reason\\stg_condition_occurrence_encounter_reason.sql", "name": "stg_condition_occurrence_encounter_reason", "alias": "stg_condition_occurrence_encounter_reason", "checksum": {"name": "sha256", "checksum": "ffac4fef64a356cbde623cf4494559f705344732104b2789b547c7e7fb733573"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "ENCOUNTER_REASON"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Condition_Occurrence\\Encounter_Reason\\stg_condition_occurrence_encounter_reason.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2039783, "compiled_sql": "with encounter_reason as (\n    SELECT \n        *\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`ENCOUNTER_REASON`\n)\n\nSELECT * FROM encounter_reason", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_condition_occurrence_encounter_reason`"}, "model.NPS_OMOP_CDM.stg_condition_occurrence_prescription": {"raw_sql": "with prescription as (\r\n    SELECT \r\n        *\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PRESCRIPTION') }}\r\n)\r\n\r\nSELECT * FROM prescription", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRESCRIPTION"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Condition_Occurrence", "Prescription", "stg_condition_occurrence_prescription"], "unique_id": "model.NPS_OMOP_CDM.stg_condition_occurrence_prescription", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Condition_Occurrence\\Prescription\\stg_condition_occurrence_prescription.sql", "original_file_path": "models\\staging\\Condition_Occurrence\\Prescription\\stg_condition_occurrence_prescription.sql", "name": "stg_condition_occurrence_prescription", "alias": "stg_condition_occurrence_prescription", "checksum": {"name": "sha256", "checksum": "f6d4a175d786e462a653c9a5a1641c8444446e99be31b95546edc91bb8439c16"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PRESCRIPTION"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Condition_Occurrence\\Prescription\\stg_condition_occurrence_prescription.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2069378, "compiled_sql": "with prescription as (\n    SELECT \n        *\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PRESCRIPTION`\n)\n\nSELECT * FROM prescription", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_condition_occurrence_prescription`"}, "model.NPS_OMOP_CDM.stg_cost_billing_service": {"raw_sql": "with billing_service as (\r\n    SELECT\r\n    *\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'BILLING_SERVICE') }}\r\n)\r\n\r\nSELECT * FROM billing_service", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.BILLING_SERVICE"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Cost", "Billing_Service", "stg_cost_billing_service"], "unique_id": "model.NPS_OMOP_CDM.stg_cost_billing_service", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Cost\\Billing_Service\\stg_cost_billing_service.sql", "original_file_path": "models\\staging\\Cost\\Billing_Service\\stg_cost_billing_service.sql", "name": "stg_cost_billing_service", "alias": "stg_cost_billing_service", "checksum": {"name": "sha256", "checksum": "5acf4c2665f7550b2c69d9538c415e40e8eff30b85fdb381d3127da66eb23428"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "BILLING_SERVICE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Cost\\Billing_Service\\stg_cost_billing_service.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2099552, "compiled_sql": "with billing_service as (\n    SELECT\n    *\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`BILLING_SERVICE`\n)\n\nSELECT * FROM billing_service", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_cost_billing_service`"}, "model.NPS_OMOP_CDM.stg_death_patient": {"raw_sql": "with patient as (\nSELECT\n*\nFROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATIENT') }}\n)\n\nSELECT * FROM patient", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Death", "Patient", "stg_death_patient"], "unique_id": "model.NPS_OMOP_CDM.stg_death_patient", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Death\\Patient\\stg_death_patient.sql", "original_file_path": "models\\staging\\Death\\Patient\\stg_death_patient.sql", "name": "stg_death_patient", "alias": "stg_death_patient", "checksum": {"name": "sha256", "checksum": "d0d6dfbe752cf5bee2fa18dffcfb605ddeb21306604fc83efee77b45daf241c9"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATIENT"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Death\\Patient\\stg_death_patient.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2119493, "compiled_sql": "with patient as (\nSELECT\n*\nFROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATIENT`\n)\n\nSELECT * FROM patient", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_death_patient`"}, "model.NPS_OMOP_CDM.stg_device_exposure_immunisation": {"raw_sql": "with immunisation as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'IMMUNISATION') }}\n)\n\nselect * from immunisation", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.IMMUNISATION"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Device_Exposure", "Immunisation", "stg_device_exposure_immunisation"], "unique_id": "model.NPS_OMOP_CDM.stg_device_exposure_immunisation", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Device_Exposure\\Immunisation\\stg_device_exposure_immunisation.sql", "original_file_path": "models\\staging\\Device_Exposure\\Immunisation\\stg_device_exposure_immunisation.sql", "name": "stg_device_exposure_immunisation", "alias": "stg_device_exposure_immunisation", "checksum": {"name": "sha256", "checksum": "e469f42aa365a8b7f23aa7ce6782ed8e88242a0561456a355025aafea2317860"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "IMMUNISATION"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Device_Exposure\\Immunisation\\stg_device_exposure_immunisation.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2139444, "compiled_sql": "with immunisation as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`IMMUNISATION`\n)\n\nselect * from immunisation", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_device_exposure_immunisation`"}, "model.NPS_OMOP_CDM.stg_device_exposure_pathology": {"raw_sql": "with pathology as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATHOLOGY') }}\n)\n\nselect * from pathology", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Device_Exposure", "Pathology", "stg_device_exposure_pathology"], "unique_id": "model.NPS_OMOP_CDM.stg_device_exposure_pathology", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Device_Exposure\\Pathology\\stg_device_exposure_pathology.sql", "original_file_path": "models\\staging\\Device_Exposure\\Pathology\\stg_device_exposure_pathology.sql", "name": "stg_device_exposure_pathology", "alias": "stg_device_exposure_pathology", "checksum": {"name": "sha256", "checksum": "f55e946a1b78c5643811360efeb1934be7281603973d4b22406ffc549ebb83ea"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Device_Exposure\\Pathology\\stg_device_exposure_pathology.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.215939, "compiled_sql": "with pathology as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY`\n)\n\nselect * from pathology", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_device_exposure_pathology`"}, "model.NPS_OMOP_CDM.stg_device_exposure_pathology_albumin": {"raw_sql": "with pathology_albumin as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATHOLOGY_ALBUMIN') }}\n)\n\nselect * from pathology_albumin", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_ALBUMIN"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Device_Exposure", "Pathology_albumin", "stg_device_exposure_pathology_albumin"], "unique_id": "model.NPS_OMOP_CDM.stg_device_exposure_pathology_albumin", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Device_Exposure\\Pathology_albumin\\stg_device_exposure_pathology_albumin.sql", "original_file_path": "models\\staging\\Device_Exposure\\Pathology_albumin\\stg_device_exposure_pathology_albumin.sql", "name": "stg_device_exposure_pathology_albumin", "alias": "stg_device_exposure_pathology_albumin", "checksum": {"name": "sha256", "checksum": "aa465f5bce5cd7c8ddcc183982879e66253da3097fe3b8207bfcb38ca6fa9d34"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_ALBUMIN"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Device_Exposure\\Pathology_albumin\\stg_device_exposure_pathology_albumin.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2179334, "compiled_sql": "with pathology_albumin as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_ALBUMIN`\n)\n\nselect * from pathology_albumin", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_device_exposure_pathology_albumin`"}, "model.NPS_OMOP_CDM.stg_device_exposure_pathology_egfr": {"raw_sql": "with pathology_egfr as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATHOLOGY_EGFR') }}\n)\n\nselect * from pathology_egfr", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_EGFR"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Device_Exposure", "Pathology_egfr", "stg_device_exposure_pathology_egfr"], "unique_id": "model.NPS_OMOP_CDM.stg_device_exposure_pathology_egfr", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Device_Exposure\\Pathology_egfr\\stg_device_exposure_pathology_egfr.sql", "original_file_path": "models\\staging\\Device_Exposure\\Pathology_egfr\\stg_device_exposure_pathology_egfr.sql", "name": "stg_device_exposure_pathology_egfr", "alias": "stg_device_exposure_pathology_egfr", "checksum": {"name": "sha256", "checksum": "7bdf38b81d57855e39e9d72a55fa4ca26a2efa25daa4b9808b168d4f0adda2de"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_EGFR"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Device_Exposure\\Pathology_egfr\\stg_device_exposure_pathology_egfr.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2199323, "compiled_sql": "with pathology_egfr as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_EGFR`\n)\n\nselect * from pathology_egfr", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_device_exposure_pathology_egfr`"}, "model.NPS_OMOP_CDM.stg_device_exposure_pathology_hba1c": {"raw_sql": "with pathology_hba1c as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATHOLOGY_HBA1C') }}\n)\n\nselect * from pathology_hba1c", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_HBA1C"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Device_Exposure", "Pathology_hba1c", "stg_device_exposure_pathology_hba1c"], "unique_id": "model.NPS_OMOP_CDM.stg_device_exposure_pathology_hba1c", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Device_Exposure\\Pathology_hba1c\\stg_device_exposure_pathology_hba1c.sql", "original_file_path": "models\\staging\\Device_Exposure\\Pathology_hba1c\\stg_device_exposure_pathology_hba1c.sql", "name": "stg_device_exposure_pathology_hba1c", "alias": "stg_device_exposure_pathology_hba1c", "checksum": {"name": "sha256", "checksum": "6d5d1bacc6904f36a5d319e6a08c37b99183b575f043b5f56f109a670b136095"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_HBA1C"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Device_Exposure\\Pathology_hba1c\\stg_device_exposure_pathology_hba1c.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2219002, "compiled_sql": "with pathology_hba1c as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_HBA1C`\n)\n\nselect * from pathology_hba1c", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_device_exposure_pathology_hba1c`"}, "model.NPS_OMOP_CDM.stg_device_exposure_pathology_lipids": {"raw_sql": "with pathology_lipids as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATHOLOGY_LIPIDS') }}\n)\n\nselect * from pathology_lipids", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_LIPIDS"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Device_Exposure", "Pathology_lipids", "stg_device_exposure_pathology_lipids"], "unique_id": "model.NPS_OMOP_CDM.stg_device_exposure_pathology_lipids", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Device_Exposure\\Pathology_lipids\\stg_device_exposure_pathology_lipids.sql", "original_file_path": "models\\staging\\Device_Exposure\\Pathology_lipids\\stg_device_exposure_pathology_lipids.sql", "name": "stg_device_exposure_pathology_lipids", "alias": "stg_device_exposure_pathology_lipids", "checksum": {"name": "sha256", "checksum": "796abfc51129f18f3d571b2df314c3a44ac9f0f306111b08d6de76e29449c692"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_LIPIDS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Device_Exposure\\Pathology_lipids\\stg_device_exposure_pathology_lipids.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.224893, "compiled_sql": "with pathology_lipids as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_LIPIDS`\n)\n\nselect * from pathology_lipids", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_device_exposure_pathology_lipids`"}, "model.NPS_OMOP_CDM.stg_device_exposure_pathology_result": {"raw_sql": "with immunisation as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATHOLOGY_RESULT') }}\n)\n\nselect * from immunisation", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_RESULT"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Device_Exposure", "Pathology_result", "stg_device_exposure_pathology_result"], "unique_id": "model.NPS_OMOP_CDM.stg_device_exposure_pathology_result", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Device_Exposure\\Pathology_result\\stg_device_exposure_pathology_result.sql", "original_file_path": "models\\staging\\Device_Exposure\\Pathology_result\\stg_device_exposure_pathology_result.sql", "name": "stg_device_exposure_pathology_result", "alias": "stg_device_exposure_pathology_result", "checksum": {"name": "sha256", "checksum": "0bf5cb0bd892896891664d3b35b5e512ae05262ef40490da65d4cd64df5fc765"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_RESULT"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Device_Exposure\\Pathology_result\\stg_device_exposure_pathology_result.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.226913, "compiled_sql": "with immunisation as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_RESULT`\n)\n\nselect * from immunisation", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_device_exposure_pathology_result`"}, "model.NPS_OMOP_CDM.stg_drug_exposure_immunisation": {"raw_sql": "with immunisation as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'IMMUNISATION') }}\n)\n\nselect * from immunisation", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.IMMUNISATION"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Drug_Exposure", "immunisation", "stg_drug_exposure_immunisation"], "unique_id": "model.NPS_OMOP_CDM.stg_drug_exposure_immunisation", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Drug_Exposure\\immunisation\\stg_drug_exposure_immunisation.sql", "original_file_path": "models\\staging\\Drug_Exposure\\immunisation\\stg_drug_exposure_immunisation.sql", "name": "stg_drug_exposure_immunisation", "alias": "stg_drug_exposure_immunisation", "checksum": {"name": "sha256", "checksum": "4a7c7a1374ababcc5168c414f188e06d4d157d001133bb6e5602da61afae34ca"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "IMMUNISATION"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Drug_Exposure\\immunisation\\stg_drug_exposure_immunisation.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2289042, "compiled_sql": "with immunisation as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`IMMUNISATION`\n)\n\nselect * from immunisation", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_drug_exposure_immunisation`"}, "model.NPS_OMOP_CDM.stg_drug_exposure_prescription": {"raw_sql": "with prescription as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PRESCRIPTION') }}\n)\n\nselect * from prescription", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRESCRIPTION"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Drug_Exposure", "prescription", "stg_drug_exposure_prescription"], "unique_id": "model.NPS_OMOP_CDM.stg_drug_exposure_prescription", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Drug_Exposure\\prescription\\stg_drug_exposure_prescription.sql", "original_file_path": "models\\staging\\Drug_Exposure\\prescription\\stg_drug_exposure_prescription.sql", "name": "stg_drug_exposure_prescription", "alias": "stg_drug_exposure_prescription", "checksum": {"name": "sha256", "checksum": "cd660ba0e796c44dc7d5fe0543dd36f6b752a4fd36a22c809e2c6f033403e28a"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PRESCRIPTION"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Drug_Exposure\\prescription\\stg_drug_exposure_prescription.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2309003, "compiled_sql": "with prescription as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PRESCRIPTION`\n)\n\nselect * from prescription", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_drug_exposure_prescription`"}, "model.NPS_OMOP_CDM.stg_drug_exposure_script_item": {"raw_sql": "with script_item as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'SCRIPT_ITEM') }}\n)\n\nselect * from script_item", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SCRIPT_ITEM"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Drug_Exposure", "script_item", "stg_drug_exposure_script_item"], "unique_id": "model.NPS_OMOP_CDM.stg_drug_exposure_script_item", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Drug_Exposure\\script_item\\stg_drug_exposure_script_item.sql", "original_file_path": "models\\staging\\Drug_Exposure\\script_item\\stg_drug_exposure_script_item.sql", "name": "stg_drug_exposure_script_item", "alias": "stg_drug_exposure_script_item", "checksum": {"name": "sha256", "checksum": "2e103be438b20a4dc705e75f23397fec4d6581ea07d835057ef0e327e5c0ec43"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "SCRIPT_ITEM"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Drug_Exposure\\script_item\\stg_drug_exposure_script_item.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2328947, "compiled_sql": "with script_item as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`SCRIPT_ITEM`\n)\n\nselect * from script_item", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_drug_exposure_script_item`"}, "model.NPS_OMOP_CDM.stg_fact_drug_condition": {"raw_sql": "with \ndrug_exposure AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'drug_exposure') }}\n),\n\ncondition_occurrence AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'condition_occurrence') }}\n),\nfinal as (\nSELECT de.drug_exposure_id, co.condition_occurrence_id, de.person_id, de.drug_source_value, co.condition_source_value\nFROM drug_exposure  de\nJOIN condition_occurrence co\nON de.person_id = co.person_id\nWHERE de.drug_exposure_start_date  = co.condition_start_date\nAND co.condition_source_value IS NOT NULL \nAND de.drug_source_value IS NOT NULL \nAND de.drug_source_value <> co.condition_source_value\nGROUP BY de.drug_exposure_id, co.condition_occurrence_id, de.person_id, de.drug_source_value, co.condition_source_value\n)\nselect * from final", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.drug_exposure", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.condition_occurrence"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Fact_Relationship", "fact_drug_condition", "stg_fact_drug_condition"], "unique_id": "model.NPS_OMOP_CDM.stg_fact_drug_condition", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Fact_Relationship\\fact_drug_condition\\stg_fact_drug_condition.sql", "original_file_path": "models\\staging\\Fact_Relationship\\fact_drug_condition\\stg_fact_drug_condition.sql", "name": "stg_fact_drug_condition", "alias": "stg_fact_drug_condition", "checksum": {"name": "sha256", "checksum": "f7e455cd01eb92a77133efc53328d9bbcef67b6dec825621eed1596889799ecc"}, "tags": [], "refs": [], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "drug_exposure"], ["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "condition_occurrence"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Fact_Relationship\\fact_drug_condition\\stg_fact_drug_condition.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.23589, "compiled_sql": "with \ndrug_exposure AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`drug_exposure`\n),\n\ncondition_occurrence AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`condition_occurrence`\n),\nfinal as (\nSELECT de.drug_exposure_id, co.condition_occurrence_id, de.person_id, de.drug_source_value, co.condition_source_value\nFROM drug_exposure  de\nJOIN condition_occurrence co\nON de.person_id = co.person_id\nWHERE de.drug_exposure_start_date  = co.condition_start_date\nAND co.condition_source_value IS NOT NULL \nAND de.drug_source_value IS NOT NULL \nAND de.drug_source_value <> co.condition_source_value\nGROUP BY de.drug_exposure_id, co.condition_occurrence_id, de.person_id, de.drug_source_value, co.condition_source_value\n)\nselect * from final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_fact_drug_condition`"}, "model.NPS_OMOP_CDM.stg_fact_drug_procedure": {"raw_sql": "with \ndrug_exposure AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'drug_exposure') }}\n),\n\nprocedure_occurrence AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'procedure_occurrence') }}\n),\nfinal as (\nSELECT de.drug_exposure_id, po.procedure_occurrence_id, de.person_id, de.drug_source_value, po.procedure_source_value\nFROM drug_exposure  de\nJOIN procedure_occurrence po\nON de.person_id = po.person_id\nWHERE de.drug_exposure_start_date  = po.procedure_date \nAND po.procedure_source_value IS NOT NULL \nAND de.drug_source_value IS NOT NULL \nAND de.drug_source_value <> po.procedure_source_value\nGROUP BY de.drug_exposure_id, po.procedure_occurrence_id, de.person_id, de.drug_source_value, po.procedure_source_value\n)\nselect * from final", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.procedure_occurrence", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.drug_exposure"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Fact_Relationship", "fact_drug_procedure", "stg_fact_drug_procedure"], "unique_id": "model.NPS_OMOP_CDM.stg_fact_drug_procedure", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Fact_Relationship\\fact_drug_procedure\\stg_fact_drug_procedure.sql", "original_file_path": "models\\staging\\Fact_Relationship\\fact_drug_procedure\\stg_fact_drug_procedure.sql", "name": "stg_fact_drug_procedure", "alias": "stg_fact_drug_procedure", "checksum": {"name": "sha256", "checksum": "5ca3202055b6887bba37f6d3b86cf00975c897725e95780d7d23173b9da2ca74"}, "tags": [], "refs": [], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "procedure_occurrence"], ["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "drug_exposure"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Fact_Relationship\\fact_drug_procedure\\stg_fact_drug_procedure.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.237856, "compiled_sql": "with \ndrug_exposure AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`drug_exposure`\n),\n\nprocedure_occurrence AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`procedure_occurrence`\n),\nfinal as (\nSELECT de.drug_exposure_id, po.procedure_occurrence_id, de.person_id, de.drug_source_value, po.procedure_source_value\nFROM drug_exposure  de\nJOIN procedure_occurrence po\nON de.person_id = po.person_id\nWHERE de.drug_exposure_start_date  = po.procedure_date \nAND po.procedure_source_value IS NOT NULL \nAND de.drug_source_value IS NOT NULL \nAND de.drug_source_value <> po.procedure_source_value\nGROUP BY de.drug_exposure_id, po.procedure_occurrence_id, de.person_id, de.drug_source_value, po.procedure_source_value\n)\nselect * from final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_fact_drug_procedure`"}, "model.NPS_OMOP_CDM.stg_fact_specimen_measurement": {"raw_sql": "with \nmeasurement AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'measurement') }}\n),\n\nspecimen AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'specimen') }}\n),\nfinal as (\nSELECT m.measurement_id, s.specimen_id, m.person_id, m.measurement_source_value, s.specimen_source_value\nFROM measurement  m\nJOIN specimen s\nON m.person_id = s.person_id\nWHERE m.measurement_date  = s.specimen_date \nAND m.measurement_source_value IS NOT NULL \nAND s.specimen_source_value IS NOT NULL \nAND m.measurement_source_value <> s.specimen_source_value\nGROUP BY m.measurement_id, s.specimen_id, m.person_id, m.measurement_source_value, s.specimen_source_value\n)\nselect * from final", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.measurement", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.specimen"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Fact_Relationship", "fact_specimen_measurement", "stg_fact_specimen_measurement"], "unique_id": "model.NPS_OMOP_CDM.stg_fact_specimen_measurement", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Fact_Relationship\\fact_specimen_measurement\\stg_fact_specimen_measurement.sql", "original_file_path": "models\\staging\\Fact_Relationship\\fact_specimen_measurement\\stg_fact_specimen_measurement.sql", "name": "stg_fact_specimen_measurement", "alias": "stg_fact_specimen_measurement", "checksum": {"name": "sha256", "checksum": "a8618ed85c85e58cb23960f85a0326865006bda3285222d1b2ea38bcc7719e78"}, "tags": [], "refs": [], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "measurement"], ["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "specimen"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Fact_Relationship\\fact_specimen_measurement\\stg_fact_specimen_measurement.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2408478, "compiled_sql": "with \nmeasurement AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`measurement`\n),\n\nspecimen AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`specimen`\n),\nfinal as (\nSELECT m.measurement_id, s.specimen_id, m.person_id, m.measurement_source_value, s.specimen_source_value\nFROM measurement  m\nJOIN specimen s\nON m.person_id = s.person_id\nWHERE m.measurement_date  = s.specimen_date \nAND m.measurement_source_value IS NOT NULL \nAND s.specimen_source_value IS NOT NULL \nAND m.measurement_source_value <> s.specimen_source_value\nGROUP BY m.measurement_id, s.specimen_id, m.person_id, m.measurement_source_value, s.specimen_source_value\n)\nselect * from final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_fact_specimen_measurement`"}, "model.NPS_OMOP_CDM.stg_location_patient": {"raw_sql": "with patient as (\r\nSELECT\r\nCASE \r\nWHEN TRIM(LOWER(PATIENT_CITY)) LIKE \"x%\" THEN \"\"\r\nWHEN TRIM(LOWER(PATIENT_CITY)) = \"a\" THEN \"\" \r\nWHEN TRIM(LOWER(PATIENT_CITY)) = \"aa\" THEN \"\"\r\nELSE REGEXP_REPLACE(TRIM(LOWER(PATIENT_CITY)),r'[^a-z ]', '') END AS PATIENT_CITY,\r\n\r\nREGEXP_REPLACE(TRIM(PATIENT_POSTCODE),r'[^0-9]', '') AS PATIENT_POSTCODE, \r\n\r\nSITE_POSTCODE    \r\nFROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATIENT') }}\r\n)\r\n\r\nSELECT \r\nCASE\r\nWHEN TRIM(PATIENT_CITY) =\"\" THEN NULL\r\nELSE PATIENT_CITY END AS PATIENT_CITY,\r\n\r\nCASE \r\nWHEN TRIM(PATIENT_POSTCODE) = \"\" THEN NULL\r\nELSE PATIENT_POSTCODE END AS PATIENT_POSTCODE,\r\nSITE_POSTCODE FROM patient", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Location", "Patient", "stg_location_patient"], "unique_id": "model.NPS_OMOP_CDM.stg_location_patient", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Location\\Patient\\stg_location_patient.sql", "original_file_path": "models\\staging\\Location\\Patient\\stg_location_patient.sql", "name": "stg_location_patient", "alias": "stg_location_patient", "checksum": {"name": "sha256", "checksum": "e5e588de5069925f5e27e662206cca233a9fbd4cd238172bf3c79ff5424f2b46"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATIENT"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Location\\Patient\\stg_location_patient.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2428706, "compiled_sql": "with patient as (\nSELECT\nCASE \nWHEN TRIM(LOWER(PATIENT_CITY)) LIKE \"x%\" THEN \"\"\nWHEN TRIM(LOWER(PATIENT_CITY)) = \"a\" THEN \"\" \nWHEN TRIM(LOWER(PATIENT_CITY)) = \"aa\" THEN \"\"\nELSE REGEXP_REPLACE(TRIM(LOWER(PATIENT_CITY)),r'[^a-z ]', '') END AS PATIENT_CITY,\n\nREGEXP_REPLACE(TRIM(PATIENT_POSTCODE),r'[^0-9]', '') AS PATIENT_POSTCODE, \n\nSITE_POSTCODE    \nFROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATIENT`\n)\n\nSELECT \nCASE\nWHEN TRIM(PATIENT_CITY) =\"\" THEN NULL\nELSE PATIENT_CITY END AS PATIENT_CITY,\n\nCASE \nWHEN TRIM(PATIENT_POSTCODE) = \"\" THEN NULL\nELSE PATIENT_POSTCODE END AS PATIENT_POSTCODE,\nSITE_POSTCODE FROM patient", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_location_patient`"}, "model.NPS_OMOP_CDM.stg_location_postcode": {"raw_sql": "with postcode as (\r\n    SELECT \r\n        *\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'POSTCODE') }}\r\n)\r\n\r\nSELECT * FROM postcode", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.POSTCODE"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Location", "Postcode", "stg_location_postcode"], "unique_id": "model.NPS_OMOP_CDM.stg_location_postcode", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Location\\Postcode\\stg_location_postcode.sql", "original_file_path": "models\\staging\\Location\\Postcode\\stg_location_postcode.sql", "name": "stg_location_postcode", "alias": "stg_location_postcode", "checksum": {"name": "sha256", "checksum": "5186109d173c1e65f5f2aae06f0eba84dadffcc2f62325b755d213dce07524f0"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "POSTCODE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Location\\Postcode\\stg_location_postcode.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2448611, "compiled_sql": "with postcode as (\n    SELECT \n        *\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`POSTCODE`\n)\n\nSELECT * FROM postcode", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_location_postcode`"}, "model.NPS_OMOP_CDM.stg_location_practice_recruitment": {"raw_sql": "with practice_recruitment as (\r\n    SELECT \r\n        *\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PRACTICE_RECRUITMENT') }}\r\n)\r\n\r\nSELECT * FROM practice_recruitment", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRACTICE_RECRUITMENT"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Location", "Practice_Recruitment", "stg_location_practice_recruitment"], "unique_id": "model.NPS_OMOP_CDM.stg_location_practice_recruitment", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Location\\Practice_Recruitment\\stg_location_practice_recruitment.sql", "original_file_path": "models\\staging\\Location\\Practice_Recruitment\\stg_location_practice_recruitment.sql", "name": "stg_location_practice_recruitment", "alias": "stg_location_practice_recruitment", "checksum": {"name": "sha256", "checksum": "ab4f376a405e69ed1e67aca67c23d413bbf02c75de6ad878b65584ee874094cb"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PRACTICE_RECRUITMENT"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Location\\Practice_Recruitment\\stg_location_practice_recruitment.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.247854, "compiled_sql": "with practice_recruitment as (\n    SELECT \n        *\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PRACTICE_RECRUITMENT`\n)\n\nSELECT * FROM practice_recruitment", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_location_practice_recruitment`"}, "model.NPS_OMOP_CDM.stg_location_primary_health_network": {"raw_sql": "with primary_health_network as (\r\n    SELECT \r\n        *\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PRIMARY_HEALTH_NETWORK') }}\r\n)\r\n\r\nSELECT * FROM primary_health_network", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRIMARY_HEALTH_NETWORK"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Location", "Primary_Health_Network", "stg_location_primary_health_network"], "unique_id": "model.NPS_OMOP_CDM.stg_location_primary_health_network", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Location\\Primary_Health_Network\\stg_location_primary_health_network.sql", "original_file_path": "models\\staging\\Location\\Primary_Health_Network\\stg_location_primary_health_network.sql", "name": "stg_location_primary_health_network", "alias": "stg_location_primary_health_network", "checksum": {"name": "sha256", "checksum": "7eadd2e7876b396fa27a6fd370bee9cb604045ca4a042a3ced3616cb3fa75caa"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PRIMARY_HEALTH_NETWORK"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Location\\Primary_Health_Network\\stg_location_primary_health_network.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2498481, "compiled_sql": "with primary_health_network as (\n    SELECT \n        *\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PRIMARY_HEALTH_NETWORK`\n)\n\nSELECT * FROM primary_health_network", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_location_primary_health_network`"}, "model.NPS_OMOP_CDM.stg_location_site": {"raw_sql": "with site as (\r\n    SELECT \r\n        {{replace_empty_string_with_null(['SITE_ADDRESS'])}}\r\n        STATE,\r\n        POSTCODE_ORIGINAL\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'SITE') }}\r\n)\r\n\r\nSELECT * FROM site", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.NPS_OMOP_CDM.replace_empty_string_with_null"], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SITE"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Location", "Site", "stg_location_site"], "unique_id": "model.NPS_OMOP_CDM.stg_location_site", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Location\\Site\\stg_location_site.sql", "original_file_path": "models\\staging\\Location\\Site\\stg_location_site.sql", "name": "stg_location_site", "alias": "stg_location_site", "checksum": {"name": "sha256", "checksum": "1577dfed7bb0645fd3e654bc0d4a34815421392ddb401802bf76d82c4497db7e"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "SITE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Location\\Site\\stg_location_site.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2518601, "compiled_sql": "with site as (\n    SELECT \n        \n\n  \n    \n    CASE\n    WHEN SITE_ADDRESS  = \"\" THEN NULL\n    ELSE SITE_ADDRESS END AS  SITE_ADDRESS,\n\n  \n\n        STATE,\n        POSTCODE_ORIGINAL\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`SITE`\n)\n\nSELECT * FROM site", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_location_site`"}, "model.NPS_OMOP_CDM.stg_measurement_observation": {"raw_sql": "with observation as (\r\n    SELECT \r\n        *\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'OBSERVATION') }}\r\n)\r\n\r\nSELECT * FROM observation", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.OBSERVATION"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Measurement", "Observation", "stg_measurement_observation"], "unique_id": "model.NPS_OMOP_CDM.stg_measurement_observation", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Measurement\\Observation\\stg_measurement_observation.sql", "original_file_path": "models\\staging\\Measurement\\Observation\\stg_measurement_observation.sql", "name": "stg_measurement_observation", "alias": "stg_measurement_observation", "checksum": {"name": "sha256", "checksum": "1bc8abbfe49a10bc80375afd238db74252013a9dff98ecea23003bf5b5c6f3ad"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "OBSERVATION"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Measurement\\Observation\\stg_measurement_observation.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2568161, "compiled_sql": "with observation as (\n    SELECT \n        *\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`OBSERVATION`\n)\n\nSELECT * FROM observation", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_measurement_observation`"}, "model.NPS_OMOP_CDM.stg_measurement_pathology": {"raw_sql": "with stg_pathology as (\r\nSELECT \r\n*\r\nFROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATHOLOGY') }}\r\n)\r\n\r\nSELECT \r\n*\r\nFROM stg_pathology", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Measurement", "Pathology", "stg_measurement_pathology"], "unique_id": "model.NPS_OMOP_CDM.stg_measurement_pathology", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Measurement\\Pathology\\stg_measurement_pathology.sql", "original_file_path": "models\\staging\\Measurement\\Pathology\\stg_measurement_pathology.sql", "name": "stg_measurement_pathology", "alias": "stg_measurement_pathology", "checksum": {"name": "sha256", "checksum": "a37e1b9431d96d243aa2607641a6a37056d40c1a3ba0872cce27f6c5c892bf6c"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Measurement\\Pathology\\stg_measurement_pathology.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2598188, "compiled_sql": "with stg_pathology as (\nSELECT \n*\nFROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY`\n)\n\nSELECT \n*\nFROM stg_pathology", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_measurement_pathology`"}, "model.NPS_OMOP_CDM.stg_measurement_pathology_albumin": {"raw_sql": "with stg_pathology_albumin as (\r\nSELECT\r\n*\r\nFROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATHOLOGY_ALBUMIN') }}\r\n)\r\n\r\nSELECT \r\n*\r\nFROM stg_pathology_albumin", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_ALBUMIN"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Measurement", "Pathology_Albumin", "stg_measurement_pathology_albumin"], "unique_id": "model.NPS_OMOP_CDM.stg_measurement_pathology_albumin", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Measurement\\Pathology_Albumin\\stg_measurement_pathology_albumin.sql", "original_file_path": "models\\staging\\Measurement\\Pathology_Albumin\\stg_measurement_pathology_albumin.sql", "name": "stg_measurement_pathology_albumin", "alias": "stg_measurement_pathology_albumin", "checksum": {"name": "sha256", "checksum": "5041c305b6eb8592d273d4ed008b161a04526b6f792fb6c43064c097bc11fa98"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_ALBUMIN"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Measurement\\Pathology_Albumin\\stg_measurement_pathology_albumin.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2618086, "compiled_sql": "with stg_pathology_albumin as (\nSELECT\n*\nFROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_ALBUMIN`\n)\n\nSELECT \n*\nFROM stg_pathology_albumin", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_measurement_pathology_albumin`"}, "model.NPS_OMOP_CDM.stg_measurement_pathology_egfr": {"raw_sql": "with stg_pathology_egfr as (\r\nSELECT \r\n*\r\nFROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATHOLOGY_EGFR') }}\r\n)\r\n\r\nSELECT \r\n*\r\nFROM stg_pathology_egfr", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_EGFR"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Measurement", "Pathology_Egfr", "stg_measurement_pathology_egfr"], "unique_id": "model.NPS_OMOP_CDM.stg_measurement_pathology_egfr", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Measurement\\Pathology_Egfr\\stg_measurement_pathology_egfr.sql", "original_file_path": "models\\staging\\Measurement\\Pathology_Egfr\\stg_measurement_pathology_egfr.sql", "name": "stg_measurement_pathology_egfr", "alias": "stg_measurement_pathology_egfr", "checksum": {"name": "sha256", "checksum": "606e7a6f6b6edb9b2802652a24ec5f52479f27301cb9617b4ded3004cf422bcb"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_EGFR"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Measurement\\Pathology_Egfr\\stg_measurement_pathology_egfr.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2638106, "compiled_sql": "with stg_pathology_egfr as (\nSELECT \n*\nFROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_EGFR`\n)\n\nSELECT \n*\nFROM stg_pathology_egfr", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_measurement_pathology_egfr`"}, "model.NPS_OMOP_CDM.stg_measurement_pathology_hba1c": {"raw_sql": "with stg_pathology_hba1c as (\r\nSELECT \r\n*\r\nFROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATHOLOGY_HBA1C') }}\r\n)\r\n\r\nSELECT \r\n*\r\nFROM stg_pathology_hba1c", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_HBA1C"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Measurement", "Pathology_Hba1c", "stg_measurement_pathology_hba1c"], "unique_id": "model.NPS_OMOP_CDM.stg_measurement_pathology_hba1c", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Measurement\\Pathology_Hba1c\\stg_measurement_pathology_hba1c.sql", "original_file_path": "models\\staging\\Measurement\\Pathology_Hba1c\\stg_measurement_pathology_hba1c.sql", "name": "stg_measurement_pathology_hba1c", "alias": "stg_measurement_pathology_hba1c", "checksum": {"name": "sha256", "checksum": "81865934fcb96aa9ddf242dbd30dbddc3ee0c70cebfb8ace0ce82105276c8358"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_HBA1C"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Measurement\\Pathology_Hba1c\\stg_measurement_pathology_hba1c.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2658057, "compiled_sql": "with stg_pathology_hba1c as (\nSELECT \n*\nFROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_HBA1C`\n)\n\nSELECT \n*\nFROM stg_pathology_hba1c", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_measurement_pathology_hba1c`"}, "model.NPS_OMOP_CDM.stg_measurement_pathology_lipids": {"raw_sql": "with stg_pathology_lipids as (\r\nSELECT \r\n*\r\nFROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATHOLOGY_LIPIDS') }}\r\n)\r\n\r\nSELECT \r\n*\r\nFROM stg_pathology_lipids", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_LIPIDS"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Measurement", "Pathology_Lipids", "stg_measurement_pathology_lipids"], "unique_id": "model.NPS_OMOP_CDM.stg_measurement_pathology_lipids", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Measurement\\Pathology_Lipids\\stg_measurement_pathology_lipids.sql", "original_file_path": "models\\staging\\Measurement\\Pathology_Lipids\\stg_measurement_pathology_lipids.sql", "name": "stg_measurement_pathology_lipids", "alias": "stg_measurement_pathology_lipids", "checksum": {"name": "sha256", "checksum": "6460700bd5b57d5f0ce9ed35c49679f336b9baf6f074ef414d7238d23ee4149e"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_LIPIDS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Measurement\\Pathology_Lipids\\stg_measurement_pathology_lipids.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2678003, "compiled_sql": "with stg_pathology_lipids as (\nSELECT \n*\nFROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_LIPIDS`\n)\n\nSELECT \n*\nFROM stg_pathology_lipids", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_measurement_pathology_lipids`"}, "model.NPS_OMOP_CDM.stg_measurement_pathology_result": {"raw_sql": "with stg_pathology_result as (\r\nSELECT \r\nPATIENT_NUMBER,\r\nPROVIDER_ID,\r\nRESULT_DATE,\r\nRESULT_VALUE,\r\nNORMAL_RANGE,\r\nRESULT_NAME,\r\nUNITS\r\nFROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATHOLOGY_RESULT') }}\r\n),\r\n\r\nintermediate_stg_pathology_result as (\r\nSELECT \r\nPATIENT_NUMBER,\r\nPROVIDER_ID,\r\nRESULT_DATE,\r\nRESULT_VALUE,\r\nRESULT_NAME,\r\nUNITS,\r\nCASE WHEN SUBSTRING(NORMAL_RANGE,1,1)='<' OR NORMAL_RANGE like \"up to%\" THEN NULL\r\nWHEN NORMAL_RANGE like '%F%<%' OR NORMAL_RANGE like 'R%' OR NORMAL_RANGE like \"N%<%\" THEN NULL\r\nWHEN NORMAL_RANGE LIKE \"%Toxic > 100mg/L 4hr%\" THEN '100'\r\nWHEN NORMAL_RANGE like 'P%' THEN REGEXP_REPLACE(REGEXP_SUBSTR(TRIM(NORMAL_RANGE, 'Prepub.'),'[^-]+'),r'[^0-9.-]', '')\r\nWHEN NORMAL_RANGE like \"-%/%\" THEN REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE,'[^/]+'),r'[^0-9.-]', '')\r\nWHEN SUBSTRING(NORMAL_RANGE,1,1)='>' THEN REGEXP_REPLACE(NORMAL_RANGE,r'[^0-9.]', '') \r\nWHEN SUBSTRING(NORMAL_RANGE,1,1)='-' AND SUBSTRING(NORMAL_RANGE,2,1)='>' THEN REGEXP_REPLACE(NORMAL_RANGE,r'[^0-9.]', '') \r\nWHEN SUBSTRING(NORMAL_RANGE,1,1)='-' AND SUBSTRING(NORMAL_RANGE,2,1)='<' THEN NULL \r\nWHEN SUBSTRING(NORMAL_RANGE,1,1)='-' THEN CONCAT('-',REGEXP_SUBSTR(NORMAL_RANGE,'[^-]+'))\r\nWHEN NORMAL_RANGE like \"Upright%\" THEN REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE,'[^-]+'),r'[^0-9.-]', '')\r\nWHEN CONTAINS_SUBSTR(NORMAL_RANGE, 'H') THEN REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE,'[^H]+'),r'[^0-9.]', '')\r\nWHEN NORMAL_RANGE = 'x10^12/L' OR NORMAL_RANGE='x10^9/L' THEN NULL\r\nELSE REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE,'[^-]+'),r'[^0-9.-]', '') END AS range_low,\r\n\r\nCASE WHEN SUBSTRING(NORMAL_RANGE,1,1)='>' THEN NULL\r\nWHEN NORMAL_RANGE = 'x10^12/L' OR NORMAL_RANGE='x10^9/L' OR NORMAL_RANGE like '%NR < 250 adults, < 3' THEN NULL\r\nWHEN NORMAL_RANGE like \"N%<%\" THEN REGEXP_REPLACE(NORMAL_RANGE,r'[^0-9.]', '') \r\nWHEN NORMAL_RANGE like 'P%' THEN REGEXP_REPLACE(REGEXP_SUBSTR(TRIM(NORMAL_RANGE, 'Prepub.'), \"-(.*)\"),r'[^0-9.]', '')\r\nWHEN NORMAL_RANGE like '%F%<%' OR NORMAL_RANGE like 'R%' THEN REGEXP_REPLACE(NORMAL_RANGE,r'[^0-9.]', '')\r\nWHEN NORMAL_RANGE like \"-%/%\" THEN REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE, \"/(.*)\"),r'[^0-9.]', '')\r\nWHEN NORMAL_RANGE like \"up to%\" THEN REGEXP_REPLACE(NORMAL_RANGE,r'[^0-9.]', '') \r\nWHEN NORMAL_RANGE like \"<%_%-%_%\" THEN REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE, \"-(.*)\"),r'[^0-9.]', '')\r\nWHEN SUBSTRING(NORMAL_RANGE,1,1)='<' THEN REGEXP_REPLACE(NORMAL_RANGE,r'[^0-9.]', '') \r\nWHEN SUBSTRING(NORMAL_RANGE,1,1)='-' AND SUBSTRING(NORMAL_RANGE,2,1)='<' THEN REGEXP_REPLACE(NORMAL_RANGE,r'[^0-9.]', '') \r\nWHEN SUBSTRING(NORMAL_RANGE,1,1)='-' AND SUBSTRING(NORMAL_RANGE,2,1)='>' THEN NULL\r\nWHEN SUBSTRING(NORMAL_RANGE,1,1)='-' THEN REGEXP_SUBSTR(REGEXP_SUBSTR(NORMAL_RANGE, \"-(.*)\"),\"-(.*)\")\r\nWHEN NORMAL_RANGE like \"Upright%\" THEN REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE, \"-(.*)\"),r'[^0-9.]', '')\r\nWHEN CONTAINS_SUBSTR(NORMAL_RANGE, 'H') THEN REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE, \"H(.*)\"),r'[^0-9.]', '')\r\nELSE REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE, \"-(.*)\"),r'[^0-9.]', '') END AS range_high\r\n\r\nFROM stg_pathology_result)\r\n\r\nSELECT\r\nPATIENT_NUMBER,\r\nPROVIDER_ID,\r\nRESULT_DATE,\r\nRESULT_VALUE,\r\nRESULT_NAME,\r\nUNITS,\r\nCASE\r\nWHEN range_high = \"\" THEN  NULL\r\nWHEN SUBSTRING(range_high,1,1) = '.' THEN SAFE_CAST(CONCAT('0.',range_high) AS FLOAT64)\r\nWHEN SUBSTRING(range_high,1,1) = '+' THEN SAFE_CAST(TRIM(range_high,'+') AS FLOAT64)\r\nELSE SAFE_CAST(range_high AS FLOAT64) END AS range_high,\r\nCASE\r\nWHEN range_low = \"\" THEN  NULL\r\nWHEN SUBSTRING(range_low,1,1) = '.' THEN SAFE_CAST(CONCAT('0.',range_low) AS FLOAT64)\r\nWHEN SUBSTRING(range_low,1,1) = '+' THEN SAFE_CAST(TRIM(range_low,'+') AS FLOAT64)\r\nELSE SAFE_CAST(range_low AS FLOAT64) END AS range_low\r\nFROM intermediate_stg_pathology_result", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_RESULT"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Measurement", "Pathology_Result", "stg_measurement_pathology_result"], "unique_id": "model.NPS_OMOP_CDM.stg_measurement_pathology_result", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Measurement\\Pathology_Result\\stg_measurement_pathology_result.sql", "original_file_path": "models\\staging\\Measurement\\Pathology_Result\\stg_measurement_pathology_result.sql", "name": "stg_measurement_pathology_result", "alias": "stg_measurement_pathology_result", "checksum": {"name": "sha256", "checksum": "c7b31b52d92f24681ab187d5a5953c55bb33aa1f113dc784669cc8c2104d5d15"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_RESULT"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Measurement\\Pathology_Result\\stg_measurement_pathology_result.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2698, "compiled_sql": "with stg_pathology_result as (\nSELECT \nPATIENT_NUMBER,\nPROVIDER_ID,\nRESULT_DATE,\nRESULT_VALUE,\nNORMAL_RANGE,\nRESULT_NAME,\nUNITS\nFROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_RESULT`\n),\n\nintermediate_stg_pathology_result as (\nSELECT \nPATIENT_NUMBER,\nPROVIDER_ID,\nRESULT_DATE,\nRESULT_VALUE,\nRESULT_NAME,\nUNITS,\nCASE WHEN SUBSTRING(NORMAL_RANGE,1,1)='<' OR NORMAL_RANGE like \"up to%\" THEN NULL\nWHEN NORMAL_RANGE like '%F%<%' OR NORMAL_RANGE like 'R%' OR NORMAL_RANGE like \"N%<%\" THEN NULL\nWHEN NORMAL_RANGE LIKE \"%Toxic > 100mg/L 4hr%\" THEN '100'\nWHEN NORMAL_RANGE like 'P%' THEN REGEXP_REPLACE(REGEXP_SUBSTR(TRIM(NORMAL_RANGE, 'Prepub.'),'[^-]+'),r'[^0-9.-]', '')\nWHEN NORMAL_RANGE like \"-%/%\" THEN REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE,'[^/]+'),r'[^0-9.-]', '')\nWHEN SUBSTRING(NORMAL_RANGE,1,1)='>' THEN REGEXP_REPLACE(NORMAL_RANGE,r'[^0-9.]', '') \nWHEN SUBSTRING(NORMAL_RANGE,1,1)='-' AND SUBSTRING(NORMAL_RANGE,2,1)='>' THEN REGEXP_REPLACE(NORMAL_RANGE,r'[^0-9.]', '') \nWHEN SUBSTRING(NORMAL_RANGE,1,1)='-' AND SUBSTRING(NORMAL_RANGE,2,1)='<' THEN NULL \nWHEN SUBSTRING(NORMAL_RANGE,1,1)='-' THEN CONCAT('-',REGEXP_SUBSTR(NORMAL_RANGE,'[^-]+'))\nWHEN NORMAL_RANGE like \"Upright%\" THEN REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE,'[^-]+'),r'[^0-9.-]', '')\nWHEN CONTAINS_SUBSTR(NORMAL_RANGE, 'H') THEN REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE,'[^H]+'),r'[^0-9.]', '')\nWHEN NORMAL_RANGE = 'x10^12/L' OR NORMAL_RANGE='x10^9/L' THEN NULL\nELSE REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE,'[^-]+'),r'[^0-9.-]', '') END AS range_low,\n\nCASE WHEN SUBSTRING(NORMAL_RANGE,1,1)='>' THEN NULL\nWHEN NORMAL_RANGE = 'x10^12/L' OR NORMAL_RANGE='x10^9/L' OR NORMAL_RANGE like '%NR < 250 adults, < 3' THEN NULL\nWHEN NORMAL_RANGE like \"N%<%\" THEN REGEXP_REPLACE(NORMAL_RANGE,r'[^0-9.]', '') \nWHEN NORMAL_RANGE like 'P%' THEN REGEXP_REPLACE(REGEXP_SUBSTR(TRIM(NORMAL_RANGE, 'Prepub.'), \"-(.*)\"),r'[^0-9.]', '')\nWHEN NORMAL_RANGE like '%F%<%' OR NORMAL_RANGE like 'R%' THEN REGEXP_REPLACE(NORMAL_RANGE,r'[^0-9.]', '')\nWHEN NORMAL_RANGE like \"-%/%\" THEN REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE, \"/(.*)\"),r'[^0-9.]', '')\nWHEN NORMAL_RANGE like \"up to%\" THEN REGEXP_REPLACE(NORMAL_RANGE,r'[^0-9.]', '') \nWHEN NORMAL_RANGE like \"<%_%-%_%\" THEN REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE, \"-(.*)\"),r'[^0-9.]', '')\nWHEN SUBSTRING(NORMAL_RANGE,1,1)='<' THEN REGEXP_REPLACE(NORMAL_RANGE,r'[^0-9.]', '') \nWHEN SUBSTRING(NORMAL_RANGE,1,1)='-' AND SUBSTRING(NORMAL_RANGE,2,1)='<' THEN REGEXP_REPLACE(NORMAL_RANGE,r'[^0-9.]', '') \nWHEN SUBSTRING(NORMAL_RANGE,1,1)='-' AND SUBSTRING(NORMAL_RANGE,2,1)='>' THEN NULL\nWHEN SUBSTRING(NORMAL_RANGE,1,1)='-' THEN REGEXP_SUBSTR(REGEXP_SUBSTR(NORMAL_RANGE, \"-(.*)\"),\"-(.*)\")\nWHEN NORMAL_RANGE like \"Upright%\" THEN REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE, \"-(.*)\"),r'[^0-9.]', '')\nWHEN CONTAINS_SUBSTR(NORMAL_RANGE, 'H') THEN REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE, \"H(.*)\"),r'[^0-9.]', '')\nELSE REGEXP_REPLACE(REGEXP_SUBSTR(NORMAL_RANGE, \"-(.*)\"),r'[^0-9.]', '') END AS range_high\n\nFROM stg_pathology_result)\n\nSELECT\nPATIENT_NUMBER,\nPROVIDER_ID,\nRESULT_DATE,\nRESULT_VALUE,\nRESULT_NAME,\nUNITS,\nCASE\nWHEN range_high = \"\" THEN  NULL\nWHEN SUBSTRING(range_high,1,1) = '.' THEN SAFE_CAST(CONCAT('0.',range_high) AS FLOAT64)\nWHEN SUBSTRING(range_high,1,1) = '+' THEN SAFE_CAST(TRIM(range_high,'+') AS FLOAT64)\nELSE SAFE_CAST(range_high AS FLOAT64) END AS range_high,\nCASE\nWHEN range_low = \"\" THEN  NULL\nWHEN SUBSTRING(range_low,1,1) = '.' THEN SAFE_CAST(CONCAT('0.',range_low) AS FLOAT64)\nWHEN SUBSTRING(range_low,1,1) = '+' THEN SAFE_CAST(TRIM(range_low,'+') AS FLOAT64)\nELSE SAFE_CAST(range_low AS FLOAT64) END AS range_low\nFROM intermediate_stg_pathology_result", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_measurement_pathology_result`"}, "model.NPS_OMOP_CDM.stg_measurement_requested_test": {"raw_sql": "with stg_requested_test as (\r\nSELECT \r\n*\r\nFROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'REQUESTED_TEST') }}\r\n)\r\n\r\nSELECT \r\n*\r\nFROM stg_requested_test", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.REQUESTED_TEST"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Measurement", "Requested_Test", "stg_measurement_requested_test"], "unique_id": "model.NPS_OMOP_CDM.stg_measurement_requested_test", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Measurement\\Requested_Test\\stg_measurement_requested_test.sql", "original_file_path": "models\\staging\\Measurement\\Requested_Test\\stg_measurement_requested_test.sql", "name": "stg_measurement_requested_test", "alias": "stg_measurement_requested_test", "checksum": {"name": "sha256", "checksum": "66144869b83751769631cfc081928365c3170f4de7958b2120327ee7339e7d9d"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "REQUESTED_TEST"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Measurement\\Requested_Test\\stg_measurement_requested_test.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2717683, "compiled_sql": "with stg_requested_test as (\nSELECT \n*\nFROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`REQUESTED_TEST`\n)\n\nSELECT \n*\nFROM stg_requested_test", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_measurement_requested_test`"}, "model.NPS_OMOP_CDM.intermediate_alcohol_allergy": {"raw_sql": "with alcohol_status as (\n    SELECT * FROM {{ ref('intermediate_stg_alcohol_status')}}\n),\n\nallergy_reaction as (\n    SELECT * FROM {{ ref('intermediate_stg_allergy_reaction')}}\n),\n\nfinal as (\n    SELECT * FROM alcohol_status\n    UNION DISTINCT\n    SELECT * FROM allergy_reaction\n)\n\nselect * from final", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.NPS_OMOP_CDM.intermediate_stg_alcohol_status", "model.NPS_OMOP_CDM.intermediate_stg_allergy_reaction"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Observation", "alcohol_allergy", "intermediate_alcohol_allergy"], "unique_id": "model.NPS_OMOP_CDM.intermediate_alcohol_allergy", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Observation\\alcohol_allergy\\intermediate_alcohol_allergy.sql", "original_file_path": "models\\staging\\Observation\\alcohol_allergy\\intermediate_alcohol_allergy.sql", "name": "intermediate_alcohol_allergy", "alias": "intermediate_alcohol_allergy", "checksum": {"name": "sha256", "checksum": "e06f55b276d596697322be66f98c276e81290eb7538df2d3b8573a37651f5c06"}, "tags": [], "refs": [["intermediate_stg_alcohol_status"], ["intermediate_stg_allergy_reaction"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Observation\\alcohol_allergy\\intermediate_alcohol_allergy.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.274756, "compiled_sql": "with alcohol_status as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_alcohol_status`\n),\n\nallergy_reaction as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_allergy_reaction`\n),\n\nfinal as (\n    SELECT * FROM alcohol_status\n    UNION DISTINCT\n    SELECT * FROM allergy_reaction\n)\n\nselect * from final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_alcohol_allergy`"}, "model.NPS_OMOP_CDM.intermediate_stg_alcohol_status": {"raw_sql": "with alcohol_status as (\n    SELECT * FROM {{ ref('stg_observation_alcohol_status')}}\n),\n\nPerson AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person') }}\n),\nfinal as (\n    SELECT (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = al.patient_number\n    ) as person_id,\n    {{parse_date('alcohol_assessment_date')}} as observation_date,\n    {{parse_datetime('alcohol_assessment_date')}} as observation_datetime,\n    CAST(drinks_per_day as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    alcohol_status_name as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(drinks_per_day as string) as value_source_value\n    FROM alcohol_status al\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = al.patient_number\n    ) as person_id,\n    {{parse_date('alcohol_assessment_date')}} as observation_date,\n    {{parse_datetime('alcohol_assessment_date')}} as observation_datetime,\n    CAST(days_per_week as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    alcohol_status_name as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(drinks_per_day as string) as value_source_value\n    FROM alcohol_status al\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = al.patient_number\n    ) as person_id,\n    {{parse_date('alcohol_assessment_date')}} as observation_date,\n    {{parse_datetime('alcohol_assessment_date')}} as observation_datetime,\n    CAST(past_drinks_per_day as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    past_alcohol_code as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(drinks_per_day as string) as value_source_value\n    FROM alcohol_status al\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = al.patient_number\n    ) as person_id,\n    {{parse_date('alcohol_assessment_date')}} as observation_date,\n    {{parse_datetime('alcohol_assessment_date')}} as observation_datetime,\n    CAST(past_days_per_week as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    past_alcohol_code as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(drinks_per_day as string) as value_source_value\n    FROM alcohol_status al\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = al.patient_number\n    ) as person_id,\n    {{parse_date('alcohol_assessment_date')}} as observation_date,\n    {{parse_datetime('alcohol_assessment_date')}} as observation_datetime,\n    CAST(past_drinks_per_day as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CASE WHEN year_started = '0' THEN NULL \n    ELSE year_started END as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(past_drinks_per_day as string) as value_source_value\n    FROM alcohol_status al\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = al.patient_number\n    ) as person_id,\n    {{parse_date('alcohol_assessment_date')}} as observation_date,\n    {{parse_datetime('alcohol_assessment_date')}} as observation_datetime,\n    CAST(past_days_per_week as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CASE WHEN year_stopped = '0' THEN NULL \n    ELSE year_stopped END as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(past_days_per_week as string) as value_source_value\n    FROM alcohol_status al\n)\n\nselect * from final", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.NPS_OMOP_CDM.parse_date", "macro.NPS_OMOP_CDM.parse_datetime"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.stg_observation_alcohol_status"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Observation", "alcohol_status", "intermediate_stg_alcohol_status"], "unique_id": "model.NPS_OMOP_CDM.intermediate_stg_alcohol_status", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Observation\\alcohol_status\\intermediate_stg_alcohol_status.sql", "original_file_path": "models\\staging\\Observation\\alcohol_status\\intermediate_stg_alcohol_status.sql", "name": "intermediate_stg_alcohol_status", "alias": "intermediate_stg_alcohol_status", "checksum": {"name": "sha256", "checksum": "a1f8fb784d911481de090578ca8591bbe491fd847b85313f843eba1bfd9ddfae"}, "tags": [], "refs": [["stg_observation_alcohol_status"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Observation\\alcohol_status\\intermediate_stg_alcohol_status.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.277786, "compiled_sql": "with alcohol_status as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_observation_alcohol_status`\n),\n\nPerson AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\nfinal as (\n    SELECT (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = al.patient_number\n    ) as person_id,\n    \n\n    CASE WHEN REGEXP_CONTAINS(alcohol_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATE(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(alcohol_assessment_date , 7, 10),\n            SUBSTRING(alcohol_assessment_date , 4, 2), \n            SUBSTRING(alcohol_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01' AS DATE) END\n as observation_date,\n    \n\n    CASE WHEN REGEXP_CONTAINS(alcohol_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATETIME(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(alcohol_assessment_date , 7, 10),\n            SUBSTRING(alcohol_assessment_date , 4, 2), \n            SUBSTRING(alcohol_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END\n as observation_datetime,\n    CAST(drinks_per_day as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    alcohol_status_name as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(drinks_per_day as string) as value_source_value\n    FROM alcohol_status al\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = al.patient_number\n    ) as person_id,\n    \n\n    CASE WHEN REGEXP_CONTAINS(alcohol_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATE(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(alcohol_assessment_date , 7, 10),\n            SUBSTRING(alcohol_assessment_date , 4, 2), \n            SUBSTRING(alcohol_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01' AS DATE) END\n as observation_date,\n    \n\n    CASE WHEN REGEXP_CONTAINS(alcohol_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATETIME(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(alcohol_assessment_date , 7, 10),\n            SUBSTRING(alcohol_assessment_date , 4, 2), \n            SUBSTRING(alcohol_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END\n as observation_datetime,\n    CAST(days_per_week as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    alcohol_status_name as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(drinks_per_day as string) as value_source_value\n    FROM alcohol_status al\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = al.patient_number\n    ) as person_id,\n    \n\n    CASE WHEN REGEXP_CONTAINS(alcohol_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATE(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(alcohol_assessment_date , 7, 10),\n            SUBSTRING(alcohol_assessment_date , 4, 2), \n            SUBSTRING(alcohol_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01' AS DATE) END\n as observation_date,\n    \n\n    CASE WHEN REGEXP_CONTAINS(alcohol_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATETIME(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(alcohol_assessment_date , 7, 10),\n            SUBSTRING(alcohol_assessment_date , 4, 2), \n            SUBSTRING(alcohol_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END\n as observation_datetime,\n    CAST(past_drinks_per_day as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    past_alcohol_code as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(drinks_per_day as string) as value_source_value\n    FROM alcohol_status al\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = al.patient_number\n    ) as person_id,\n    \n\n    CASE WHEN REGEXP_CONTAINS(alcohol_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATE(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(alcohol_assessment_date , 7, 10),\n            SUBSTRING(alcohol_assessment_date , 4, 2), \n            SUBSTRING(alcohol_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01' AS DATE) END\n as observation_date,\n    \n\n    CASE WHEN REGEXP_CONTAINS(alcohol_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATETIME(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(alcohol_assessment_date , 7, 10),\n            SUBSTRING(alcohol_assessment_date , 4, 2), \n            SUBSTRING(alcohol_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END\n as observation_datetime,\n    CAST(past_days_per_week as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    past_alcohol_code as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(drinks_per_day as string) as value_source_value\n    FROM alcohol_status al\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = al.patient_number\n    ) as person_id,\n    \n\n    CASE WHEN REGEXP_CONTAINS(alcohol_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATE(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(alcohol_assessment_date , 7, 10),\n            SUBSTRING(alcohol_assessment_date , 4, 2), \n            SUBSTRING(alcohol_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01' AS DATE) END\n as observation_date,\n    \n\n    CASE WHEN REGEXP_CONTAINS(alcohol_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATETIME(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(alcohol_assessment_date , 7, 10),\n            SUBSTRING(alcohol_assessment_date , 4, 2), \n            SUBSTRING(alcohol_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END\n as observation_datetime,\n    CAST(past_drinks_per_day as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CASE WHEN year_started = '0' THEN NULL \n    ELSE year_started END as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(past_drinks_per_day as string) as value_source_value\n    FROM alcohol_status al\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = al.patient_number\n    ) as person_id,\n    \n\n    CASE WHEN REGEXP_CONTAINS(alcohol_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATE(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(alcohol_assessment_date , 7, 10),\n            SUBSTRING(alcohol_assessment_date , 4, 2), \n            SUBSTRING(alcohol_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01' AS DATE) END\n as observation_date,\n    \n\n    CASE WHEN REGEXP_CONTAINS(alcohol_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATETIME(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(alcohol_assessment_date , 7, 10),\n            SUBSTRING(alcohol_assessment_date , 4, 2), \n            SUBSTRING(alcohol_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END\n as observation_datetime,\n    CAST(past_days_per_week as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CASE WHEN year_stopped = '0' THEN NULL \n    ELSE year_stopped END as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(past_days_per_week as string) as value_source_value\n    FROM alcohol_status al\n)\n\nselect * from final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_alcohol_status`"}, "model.NPS_OMOP_CDM.stg_observation_alcohol_status": {"raw_sql": "with alcohol_status as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'ALCOHOL_STATUS') }}\n)\n\nselect * from alcohol_status", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ALCOHOL_STATUS"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Observation", "alcohol_status", "stg_observation_alcohol_status"], "unique_id": "model.NPS_OMOP_CDM.stg_observation_alcohol_status", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Observation\\alcohol_status\\stg_observation_alcohol_status.sql", "original_file_path": "models\\staging\\Observation\\alcohol_status\\stg_observation_alcohol_status.sql", "name": "stg_observation_alcohol_status", "alias": "stg_observation_alcohol_status", "checksum": {"name": "sha256", "checksum": "bc629e14155ea140e1bf9fb2a5b15587caa519cf3f2b0be95cdbe84a19ba1397"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "ALCOHOL_STATUS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Observation\\alcohol_status\\stg_observation_alcohol_status.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2897172, "compiled_sql": "with alcohol_status as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`ALCOHOL_STATUS`\n)\n\nselect * from alcohol_status", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_observation_alcohol_status`"}, "model.NPS_OMOP_CDM.intermediate_stg_allergy_reaction": {"raw_sql": "with allergy_reaction as (\n    SELECT * FROM {{ ref('stg_observation_allergy_reaction')}}\n),\n\nPerson AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person') }}\n),\nfinal as (\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = ar.patient_number\n    ) as person_id,\n    CASE WHEN updated_datetime is NULL \n    THEN CAST(created_datetime as DATE)  \n    ELSE CAST(updated_datetime AS DATE) END as observation_date,\n    CASE WHEN updated_datetime is NULL \n    THEN CAST(created_datetime as DATETIME)  \n    ELSE CAST(updated_datetime AS DATETIME) END as observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    allergy_status_name as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(NULL as string) as value_source_value\n    FROM allergy_reaction ar\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = ar.patient_number\n    ) as person_id,\n    CASE WHEN updated_datetime is NULL \n    THEN CAST(created_datetime as DATE)  \n    ELSE CAST(updated_datetime AS DATE) END as observation_date,\n    CASE WHEN updated_datetime is NULL \n    THEN CAST(created_datetime as DATETIME)  \n    ELSE CAST(updated_datetime AS DATETIME) END as observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    allergy_item_name as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(NULL as string) as value_source_value\n    FROM allergy_reaction ar\n)\n\nselect * from final", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.stg_observation_allergy_reaction"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Observation", "allergy_reaction", "intermediate_stg_allergy_reaction"], "unique_id": "model.NPS_OMOP_CDM.intermediate_stg_allergy_reaction", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Observation\\allergy_reaction\\intermediate_stg_allergy_reaction.sql", "original_file_path": "models\\staging\\Observation\\allergy_reaction\\intermediate_stg_allergy_reaction.sql", "name": "intermediate_stg_allergy_reaction", "alias": "intermediate_stg_allergy_reaction", "checksum": {"name": "sha256", "checksum": "f5cf77a1c3d996c76ac0e6cbd3d79bc9ea28fdc8513afd9e550b25ec2962419d"}, "tags": [], "refs": [["stg_observation_allergy_reaction"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Observation\\allergy_reaction\\intermediate_stg_allergy_reaction.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2927082, "compiled_sql": "with allergy_reaction as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_observation_allergy_reaction`\n),\n\nPerson AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\nfinal as (\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = ar.patient_number\n    ) as person_id,\n    CASE WHEN updated_datetime is NULL \n    THEN CAST(created_datetime as DATE)  \n    ELSE CAST(updated_datetime AS DATE) END as observation_date,\n    CASE WHEN updated_datetime is NULL \n    THEN CAST(created_datetime as DATETIME)  \n    ELSE CAST(updated_datetime AS DATETIME) END as observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    allergy_status_name as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(NULL as string) as value_source_value\n    FROM allergy_reaction ar\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = ar.patient_number\n    ) as person_id,\n    CASE WHEN updated_datetime is NULL \n    THEN CAST(created_datetime as DATE)  \n    ELSE CAST(updated_datetime AS DATE) END as observation_date,\n    CASE WHEN updated_datetime is NULL \n    THEN CAST(created_datetime as DATETIME)  \n    ELSE CAST(updated_datetime AS DATETIME) END as observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    allergy_item_name as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(NULL as string) as value_source_value\n    FROM allergy_reaction ar\n)\n\nselect * from final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_allergy_reaction`"}, "model.NPS_OMOP_CDM.stg_observation_allergy_reaction": {"raw_sql": "with allergy_reaction as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'ALLERGY_REACTION') }}\n)\n\nselect * from allergy_reaction", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ALLERGY_REACTION"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Observation", "allergy_reaction", "stg_observation_allergy_reaction"], "unique_id": "model.NPS_OMOP_CDM.stg_observation_allergy_reaction", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Observation\\allergy_reaction\\stg_observation_allergy_reaction.sql", "original_file_path": "models\\staging\\Observation\\allergy_reaction\\stg_observation_allergy_reaction.sql", "name": "stg_observation_allergy_reaction", "alias": "stg_observation_allergy_reaction", "checksum": {"name": "sha256", "checksum": "07ec505ab2eb13891e7f71c147a2d341fd1b4ff2b08cc46dca554b6333474cb0"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "ALLERGY_REACTION"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Observation\\allergy_reaction\\stg_observation_allergy_reaction.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.295329, "compiled_sql": "with allergy_reaction as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`ALLERGY_REACTION`\n)\n\nselect * from allergy_reaction", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_observation_allergy_reaction`"}, "model.NPS_OMOP_CDM.combine_pat_obs": {"raw_sql": "with observation as (\n    SELECT * FROM {{ ref('intermediate_stg_observation') }}\n),\n\npatient as (\n    SELECT * FROM {{ ref('intermediate_stg_patient') }}\n),\n\nrequested_test as (\n    SELECT * FROM {{ ref('intermediate_stg_requested_test') }}\n),\n\nsmoking_status as (\n    SELECT * FROM {{ ref('intermediate_stg_smoking_status') }}\n),\n\nfinal as (\n    SELECT * FROM observation\n    UNION DISTINCT\n    SELECT * FROM requested_test\n    UNION DISTINCT\n    SELECT * FROM smoking_status\n    UNION DISTINCT\n    SELECT * FROM patient pt\n)\n\nselect * from final", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.NPS_OMOP_CDM.intermediate_stg_observation", "model.NPS_OMOP_CDM.intermediate_stg_patient", "model.NPS_OMOP_CDM.intermediate_stg_requested_test", "model.NPS_OMOP_CDM.intermediate_stg_smoking_status"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Observation", "combine_patient_observation", "combine_pat_obs"], "unique_id": "model.NPS_OMOP_CDM.combine_pat_obs", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Observation\\combine_patient_observation\\combine_pat_obs.sql", "original_file_path": "models\\staging\\Observation\\combine_patient_observation\\combine_pat_obs.sql", "name": "combine_pat_obs", "alias": "combine_pat_obs", "checksum": {"name": "sha256", "checksum": "2b61cbb09711823cdc2b17d4d194b34fa91d35d4e911999583f738c85afe41e2"}, "tags": [], "refs": [["intermediate_stg_observation"], ["intermediate_stg_patient"], ["intermediate_stg_requested_test"], ["intermediate_stg_smoking_status"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Observation\\combine_patient_observation\\combine_pat_obs.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.2993183, "compiled_sql": "with observation as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_observation`\n),\n\npatient as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_patient`\n),\n\nrequested_test as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_requested_test`\n),\n\nsmoking_status as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_smoking_status`\n),\n\nfinal as (\n    SELECT * FROM observation\n    UNION DISTINCT\n    SELECT * FROM requested_test\n    UNION DISTINCT\n    SELECT * FROM smoking_status\n    UNION DISTINCT\n    SELECT * FROM patient pt\n)\n\nselect * from final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`combine_pat_obs`"}, "model.NPS_OMOP_CDM.intermediate_stg_observation": {"raw_sql": "with observation as (\n    SELECT * FROM {{ ref('stg_observation_observation') }}\n),\n\nPerson AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person') }}\n),\nfinal as (\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = ob.patient_number\n    ) as person_id,\n    CASE \n    WHEN OBSERVATION_DATETIME is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(OBSERVATION_DATETIME AS DATE) END AS observation_date,\n    CASE \n    WHEN OBSERVATION_DATETIME is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(OBSERVATION_DATETIME AS DATETIME) END AS observation_datetime,\n    NULL as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    observation_type as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    observation_value as value_source_value\n    FROM observation ob\n)\n\nselect * from final", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.stg_observation_observation"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Observation", "observation", "intermediate_stg_observation"], "unique_id": "model.NPS_OMOP_CDM.intermediate_stg_observation", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Observation\\observation\\intermediate_stg_observation.sql", "original_file_path": "models\\staging\\Observation\\observation\\intermediate_stg_observation.sql", "name": "intermediate_stg_observation", "alias": "intermediate_stg_observation", "checksum": {"name": "sha256", "checksum": "abd90346c26ed3b43b58a81a88f54143b27ff5bda75cd6ebe861d4408d6db8d3"}, "tags": [], "refs": [["stg_observation_observation"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Observation\\observation\\intermediate_stg_observation.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3012824, "compiled_sql": "with observation as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_observation_observation`\n),\n\nPerson AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\nfinal as (\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = ob.patient_number\n    ) as person_id,\n    CASE \n    WHEN OBSERVATION_DATETIME is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(OBSERVATION_DATETIME AS DATE) END AS observation_date,\n    CASE \n    WHEN OBSERVATION_DATETIME is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(OBSERVATION_DATETIME AS DATETIME) END AS observation_datetime,\n    NULL as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    observation_type as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    observation_value as value_source_value\n    FROM observation ob\n)\n\nselect * from final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_observation`"}, "model.NPS_OMOP_CDM.stg_observation_observation": {"raw_sql": "with observation as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'OBSERVATION') }}\n)\n\nselect * from observation", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.OBSERVATION"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Observation", "observation", "stg_observation_observation"], "unique_id": "model.NPS_OMOP_CDM.stg_observation_observation", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Observation\\observation\\stg_observation_observation.sql", "original_file_path": "models\\staging\\Observation\\observation\\stg_observation_observation.sql", "name": "stg_observation_observation", "alias": "stg_observation_observation", "checksum": {"name": "sha256", "checksum": "d88f37130505f3e0401d3a380cc247aefd35d1d7d35aa53b5112e26746beb4dd"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "OBSERVATION"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Observation\\observation\\stg_observation_observation.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3033674, "compiled_sql": "with observation as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`OBSERVATION`\n)\n\nselect * from observation", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_observation_observation`"}, "model.NPS_OMOP_CDM.intermediate_stg_patient": {"raw_sql": "with patient as (\n    SELECT * FROM {{ ref('stg_observation_patient') }}\n),\n\nPerson AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\nfinal as (\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pt.patient_number\n    ) as person_id,\n    CAST('1800-01-01' as DATE) as observation_date,\n    CAST(NULL AS DATETIME) as observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    cis_patient_status_name as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(NULL as string) as value_source_value\n    FROM patient pt\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pt.patient_number\n    ) as person_id,\n    CAST('1800-01-01' as DATE) as observation_date,\n    NULL as observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    pension_name as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(NULL as string) as value_source_value\n    FROM patient pt\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pt.patient_number\n    ) as person_id,\n    CAST('1800-01-01' as DATE) as observation_date,\n    NULL as observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    deceased_indicator as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(NULL as string) as value_source_value\n    FROM patient pt\n)\n\nselect * from final", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.NPS_OMOP_CDM.stg_observation_patient"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Observation", "patient", "intermediate_stg_patient"], "unique_id": "model.NPS_OMOP_CDM.intermediate_stg_patient", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Observation\\patient\\intermediate_stg_patient.sql", "original_file_path": "models\\staging\\Observation\\patient\\intermediate_stg_patient.sql", "name": "intermediate_stg_patient", "alias": "intermediate_stg_patient", "checksum": {"name": "sha256", "checksum": "c0ac9b9c8986c3b7a5b2acb8a2a86e15d4a88af5f97536197548631174b80f01"}, "tags": [], "refs": [["stg_observation_patient"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Observation\\patient\\intermediate_stg_patient.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.306328, "compiled_sql": "with patient as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_observation_patient`\n),\n\nPerson AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\nfinal as (\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pt.patient_number\n    ) as person_id,\n    CAST('1800-01-01' as DATE) as observation_date,\n    CAST(NULL AS DATETIME) as observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    cis_patient_status_name as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(NULL as string) as value_source_value\n    FROM patient pt\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pt.patient_number\n    ) as person_id,\n    CAST('1800-01-01' as DATE) as observation_date,\n    NULL as observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    pension_name as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(NULL as string) as value_source_value\n    FROM patient pt\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pt.patient_number\n    ) as person_id,\n    CAST('1800-01-01' as DATE) as observation_date,\n    NULL as observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    deceased_indicator as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    CAST(NULL as string) as value_source_value\n    FROM patient pt\n)\n\nselect * from final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_patient`"}, "model.NPS_OMOP_CDM.stg_observation_patient": {"raw_sql": "with patient as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATIENT') }}\n)\n\nselect * from patient", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Observation", "patient", "stg_observation_patient"], "unique_id": "model.NPS_OMOP_CDM.stg_observation_patient", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Observation\\patient\\stg_observation_patient.sql", "original_file_path": "models\\staging\\Observation\\patient\\stg_observation_patient.sql", "name": "stg_observation_patient", "alias": "stg_observation_patient", "checksum": {"name": "sha256", "checksum": "2fe108035f247d563c89bb9119f1cd878b0fe642e91eb553e668fdf87a86d305"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATIENT"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Observation\\patient\\stg_observation_patient.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3083231, "compiled_sql": "with patient as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATIENT`\n)\n\nselect * from patient", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_observation_patient`"}, "model.NPS_OMOP_CDM.intermediate_stg_requested_test": {"raw_sql": "with requested_test as (\n    SELECT * FROM {{ ref('stg_observation_requested_test') }}\n),\n\nPerson AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person') }}\n),\nfinal as (\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(smear_site as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    request_status_code as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(pregnant as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE WHEN last_menstrual_period_date is NULL \n    THEN CAST('1800-01-01' as DATE)\n    ELSE CAST(last_menstrual_period_date AS DATE) END as observation_date,\n    CASE WHEN last_menstrual_period_date is NULL \n    THEN CAST('1800-01-01 00:00:00.000' as DATETIME)\n    ELSE CAST(last_menstrual_period_date AS DATETIME) END as observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(pregnant as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE WHEN estimated_confinement_date is NULL \n    THEN CAST('1800-01-01' as DATE)\n    ELSE CAST(estimated_confinement_date AS DATE) END as observation_date,\n    CASE WHEN estimated_confinement_date is NULL \n    THEN CAST('1800-01-01 00:00:00.000' as DATETIME)\n    ELSE CAST(estimated_confinement_date AS DATETIME) END as observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(pregnant as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(pap_register as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(bleeding as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(cervix as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(erosion as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(ectropion as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(post_natal as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(post_menopausal as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string, \n    CAST(oral_contraceptive_pill as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(hormone_replacement_therapy as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(hysterectomy as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(radiorx as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n)\n\nselect * from final", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.stg_observation_requested_test"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Observation", "requested_Test", "intermediate_stg_requested_test"], "unique_id": "model.NPS_OMOP_CDM.intermediate_stg_requested_test", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Observation\\requested_Test\\intermediate_stg_requested_test.sql", "original_file_path": "models\\staging\\Observation\\requested_Test\\intermediate_stg_requested_test.sql", "name": "intermediate_stg_requested_test", "alias": "intermediate_stg_requested_test", "checksum": {"name": "sha256", "checksum": "7e6b0559cdd352236dd377850dfc513d6cbec4a2d4ea6e9fdcd60b11d324a497"}, "tags": [], "refs": [["stg_observation_requested_test"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Observation\\requested_Test\\intermediate_stg_requested_test.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3113534, "compiled_sql": "with requested_test as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_observation_requested_test`\n),\n\nPerson AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\nfinal as (\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(smear_site as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    request_status_code as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(pregnant as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE WHEN last_menstrual_period_date is NULL \n    THEN CAST('1800-01-01' as DATE)\n    ELSE CAST(last_menstrual_period_date AS DATE) END as observation_date,\n    CASE WHEN last_menstrual_period_date is NULL \n    THEN CAST('1800-01-01 00:00:00.000' as DATETIME)\n    ELSE CAST(last_menstrual_period_date AS DATETIME) END as observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(pregnant as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE WHEN estimated_confinement_date is NULL \n    THEN CAST('1800-01-01' as DATE)\n    ELSE CAST(estimated_confinement_date AS DATE) END as observation_date,\n    CASE WHEN estimated_confinement_date is NULL \n    THEN CAST('1800-01-01 00:00:00.000' as DATETIME)\n    ELSE CAST(estimated_confinement_date AS DATETIME) END as observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(pregnant as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(pap_register as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(bleeding as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(cervix as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(erosion as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(ectropion as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(post_natal as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(post_menopausal as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string, \n    CAST(oral_contraceptive_pill as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(hormone_replacement_therapy as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(hysterectomy as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = rq.patient_number\n    ) as person_id,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01' AS DATE) \n    ELSE CAST(REQUEST_DATE AS DATE) END AS observation_date,\n    CASE \n    WHEN REQUEST_DATE is NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME) \n    ELSE CAST(REQUEST_DATE AS DATETIME) END AS observation_datetime,\n    CAST(NULL as float64) as value_as_number,\n    CAST(NULL as string) as value_as_string,\n    CAST(radiorx as string) as observation_source_value,\n    CAST(NULL as string) as unit_source_value,\n    request_status_code as value_source_value\n    FROM requested_test rq\n)\n\nselect * from final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_requested_test`"}, "model.NPS_OMOP_CDM.stg_observation_requested_test": {"raw_sql": "with requested_test as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'REQUESTED_TEST') }}\n)\n\nselect * from requested_test", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.REQUESTED_TEST"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Observation", "requested_Test", "stg_observation_requested_test"], "unique_id": "model.NPS_OMOP_CDM.stg_observation_requested_test", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Observation\\requested_Test\\stg_observation_requested_test.sql", "original_file_path": "models\\staging\\Observation\\requested_Test\\stg_observation_requested_test.sql", "name": "stg_observation_requested_test", "alias": "stg_observation_requested_test", "checksum": {"name": "sha256", "checksum": "50987cb15f14764259a31b151f5a360be61f3f8ef91aeb980c1cd9550d40fff4"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "REQUESTED_TEST"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Observation\\requested_Test\\stg_observation_requested_test.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3133488, "compiled_sql": "with requested_test as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`REQUESTED_TEST`\n)\n\nselect * from requested_test", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_observation_requested_test`"}, "model.NPS_OMOP_CDM.intermediate_stg_smoking_status": {"raw_sql": "with smoking_status as (\n    SELECT * FROM {{ ref('stg_observation_smoking_status') }}\n),\n\nPerson AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person') }}\n),\nfinal as (\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    {{parse_date('smoking_assessment_date')}} as observation_date,\n    {{parse_datetime('smoking_assessment_date')}} as observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    smoking_status_name as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    {{parse_date('smoking_assessment_date')}} as observation_date,\n    {{parse_datetime('smoking_assessment_date')}} as observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    CAST(smoking_product_type as string) as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    {{parse_date('smoking_assessment_date')}} as observation_date,\n    {{parse_datetime('smoking_assessment_date')}} as observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    CAST(past_smoking_code as string) as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    {{parse_date('smoking_assessment_date')}} as observation_date,\n    {{parse_datetime('smoking_assessment_date')}} as observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    smoking_longest_abstinence_duration as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    CASE WHEN smoking_start_year = '0' THEN CAST('1800-01-01' AS DATE)\n    WHEN smoking_start_year is NULL THEN CAST('1800-01-01' AS DATE)\n    WHEN REGEXP_CONTAINS(CAST(smoking_start_year as string)  , r'^[0-9]{4}') THEN\n    CAST(CONCAT(smoking_start_year,'-01-01') AS DATE)\n    ELSE CAST('1800-01-01' AS DATE) END AS observation_date,\n    CASE WHEN smoking_start_year = '0' THEN CAST('1800-01-01 00:00:00.000' AS DATETIME)\n    WHEN REGEXP_CONTAINS(CAST(smoking_start_year as string)  , r'^[0-9]{4}') THEN\n    CAST(CONCAT(smoking_start_year,'-01-01 00:00:00.000') AS DATETIME)\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END AS observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    smoking_status_name as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    CASE WHEN past_smoking_start_year = 0 THEN CAST('1800-01-01' AS DATE)\n    WHEN past_smoking_start_year is NULL THEN CAST('1800-01-01' AS DATE)\n    WHEN REGEXP_CONTAINS(CAST(past_smoking_start_year as string)  , r'^[0-9]{4}') THEN\n    CAST(CONCAT(past_smoking_start_year,'-01-01') AS DATE)\n    ELSE CAST('1800-01-01' AS DATE) END AS observation_date,\n    CASE WHEN past_smoking_start_year = 0 THEN CAST('1800-01-01 00:00:00.000' AS DATETIME)\n    WHEN REGEXP_CONTAINS(CAST(past_smoking_start_year as string)  , r'^[0-9]{4}') THEN\n    CAST(CONCAT(past_smoking_start_year,'-01-01 00:00:00.000') AS DATETIME)\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END AS observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    CAST(smoking_product_type as string) as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    CASE WHEN past_smoking_stopped_year = 0 THEN CAST('1800-01-01' AS DATE)\n    WHEN past_smoking_stopped_year is NULL THEN CAST('1800-01-01' AS DATE)\n    WHEN REGEXP_CONTAINS(CAST(past_smoking_stopped_year as string)  , r'^[0-9]{4}') THEN\n    CAST(CONCAT(past_smoking_stopped_year,'-01-01') AS DATE)\n    ELSE CAST('1800-01-01' AS DATE) END AS observation_date,\n    CASE WHEN past_smoking_stopped_year = 0 THEN CAST('1800-01-01 00:00:00.000' AS DATETIME)\n    WHEN REGEXP_CONTAINS(CAST(past_smoking_stopped_year as string)  , r'^[0-9]{4}') THEN\n    CAST(CONCAT(past_smoking_stopped_year,'-01-01 00:00:00.000') AS DATETIME)\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END AS observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    CAST(past_smoking_code as string) as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    {{parse_date('smoking_ceased_date')}} as observation_date,\n    {{parse_datetime('smoking_ceased_date')}} as observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    smoking_longest_abstinence_duration as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    {{parse_date('smoking_last_quit_attempt_date')}} as observation_date,\n    {{parse_datetime('smoking_last_quit_attempt_date')}} as observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    smoking_longest_abstinence_duration as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n)\n\nselect * from final", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.NPS_OMOP_CDM.parse_date", "macro.NPS_OMOP_CDM.parse_datetime"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.stg_observation_smoking_status"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Observation", "smoking_status", "intermediate_stg_smoking_status"], "unique_id": "model.NPS_OMOP_CDM.intermediate_stg_smoking_status", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Observation\\smoking_status\\intermediate_stg_smoking_status.sql", "original_file_path": "models\\staging\\Observation\\smoking_status\\intermediate_stg_smoking_status.sql", "name": "intermediate_stg_smoking_status", "alias": "intermediate_stg_smoking_status", "checksum": {"name": "sha256", "checksum": "cea78dc2c05c937d96296916b77d1334a92d152ccd7da6f6ee11e084bc369816"}, "tags": [], "refs": [["stg_observation_smoking_status"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Observation\\smoking_status\\intermediate_stg_smoking_status.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.315341, "compiled_sql": "with smoking_status as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_observation_smoking_status`\n),\n\nPerson AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\nfinal as (\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    \n\n    CASE WHEN REGEXP_CONTAINS(smoking_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATE(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(smoking_assessment_date , 7, 10),\n            SUBSTRING(smoking_assessment_date , 4, 2), \n            SUBSTRING(smoking_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01' AS DATE) END\n as observation_date,\n    \n\n    CASE WHEN REGEXP_CONTAINS(smoking_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATETIME(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(smoking_assessment_date , 7, 10),\n            SUBSTRING(smoking_assessment_date , 4, 2), \n            SUBSTRING(smoking_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END\n as observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    smoking_status_name as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    \n\n    CASE WHEN REGEXP_CONTAINS(smoking_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATE(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(smoking_assessment_date , 7, 10),\n            SUBSTRING(smoking_assessment_date , 4, 2), \n            SUBSTRING(smoking_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01' AS DATE) END\n as observation_date,\n    \n\n    CASE WHEN REGEXP_CONTAINS(smoking_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATETIME(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(smoking_assessment_date , 7, 10),\n            SUBSTRING(smoking_assessment_date , 4, 2), \n            SUBSTRING(smoking_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END\n as observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    CAST(smoking_product_type as string) as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    \n\n    CASE WHEN REGEXP_CONTAINS(smoking_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATE(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(smoking_assessment_date , 7, 10),\n            SUBSTRING(smoking_assessment_date , 4, 2), \n            SUBSTRING(smoking_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01' AS DATE) END\n as observation_date,\n    \n\n    CASE WHEN REGEXP_CONTAINS(smoking_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATETIME(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(smoking_assessment_date , 7, 10),\n            SUBSTRING(smoking_assessment_date , 4, 2), \n            SUBSTRING(smoking_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END\n as observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    CAST(past_smoking_code as string) as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    \n\n    CASE WHEN REGEXP_CONTAINS(smoking_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATE(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(smoking_assessment_date , 7, 10),\n            SUBSTRING(smoking_assessment_date , 4, 2), \n            SUBSTRING(smoking_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01' AS DATE) END\n as observation_date,\n    \n\n    CASE WHEN REGEXP_CONTAINS(smoking_assessment_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATETIME(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(smoking_assessment_date , 7, 10),\n            SUBSTRING(smoking_assessment_date , 4, 2), \n            SUBSTRING(smoking_assessment_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END\n as observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    smoking_longest_abstinence_duration as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    CASE WHEN smoking_start_year = '0' THEN CAST('1800-01-01' AS DATE)\n    WHEN smoking_start_year is NULL THEN CAST('1800-01-01' AS DATE)\n    WHEN REGEXP_CONTAINS(CAST(smoking_start_year as string)  , r'^[0-9]{4}') THEN\n    CAST(CONCAT(smoking_start_year,'-01-01') AS DATE)\n    ELSE CAST('1800-01-01' AS DATE) END AS observation_date,\n    CASE WHEN smoking_start_year = '0' THEN CAST('1800-01-01 00:00:00.000' AS DATETIME)\n    WHEN REGEXP_CONTAINS(CAST(smoking_start_year as string)  , r'^[0-9]{4}') THEN\n    CAST(CONCAT(smoking_start_year,'-01-01 00:00:00.000') AS DATETIME)\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END AS observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    smoking_status_name as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    CASE WHEN past_smoking_start_year = 0 THEN CAST('1800-01-01' AS DATE)\n    WHEN past_smoking_start_year is NULL THEN CAST('1800-01-01' AS DATE)\n    WHEN REGEXP_CONTAINS(CAST(past_smoking_start_year as string)  , r'^[0-9]{4}') THEN\n    CAST(CONCAT(past_smoking_start_year,'-01-01') AS DATE)\n    ELSE CAST('1800-01-01' AS DATE) END AS observation_date,\n    CASE WHEN past_smoking_start_year = 0 THEN CAST('1800-01-01 00:00:00.000' AS DATETIME)\n    WHEN REGEXP_CONTAINS(CAST(past_smoking_start_year as string)  , r'^[0-9]{4}') THEN\n    CAST(CONCAT(past_smoking_start_year,'-01-01 00:00:00.000') AS DATETIME)\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END AS observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    CAST(smoking_product_type as string) as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    CASE WHEN past_smoking_stopped_year = 0 THEN CAST('1800-01-01' AS DATE)\n    WHEN past_smoking_stopped_year is NULL THEN CAST('1800-01-01' AS DATE)\n    WHEN REGEXP_CONTAINS(CAST(past_smoking_stopped_year as string)  , r'^[0-9]{4}') THEN\n    CAST(CONCAT(past_smoking_stopped_year,'-01-01') AS DATE)\n    ELSE CAST('1800-01-01' AS DATE) END AS observation_date,\n    CASE WHEN past_smoking_stopped_year = 0 THEN CAST('1800-01-01 00:00:00.000' AS DATETIME)\n    WHEN REGEXP_CONTAINS(CAST(past_smoking_stopped_year as string)  , r'^[0-9]{4}') THEN\n    CAST(CONCAT(past_smoking_stopped_year,'-01-01 00:00:00.000') AS DATETIME)\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END AS observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    CAST(past_smoking_code as string) as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    \n\n    CASE WHEN REGEXP_CONTAINS(smoking_ceased_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATE(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(smoking_ceased_date , 7, 10),\n            SUBSTRING(smoking_ceased_date , 4, 2), \n            SUBSTRING(smoking_ceased_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01' AS DATE) END\n as observation_date,\n    \n\n    CASE WHEN REGEXP_CONTAINS(smoking_ceased_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATETIME(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(smoking_ceased_date , 7, 10),\n            SUBSTRING(smoking_ceased_date , 4, 2), \n            SUBSTRING(smoking_ceased_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END\n as observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    smoking_longest_abstinence_duration as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n\n    UNION DISTINCT\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = sm.patient_number\n    ) as person_id,\n    \n\n    CASE WHEN REGEXP_CONTAINS(smoking_last_quit_attempt_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATE(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(smoking_last_quit_attempt_date , 7, 10),\n            SUBSTRING(smoking_last_quit_attempt_date , 4, 2), \n            SUBSTRING(smoking_last_quit_attempt_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01' AS DATE) END\n as observation_date,\n    \n\n    CASE WHEN REGEXP_CONTAINS(smoking_last_quit_attempt_date  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATETIME(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING(smoking_last_quit_attempt_date , 7, 10),\n            SUBSTRING(smoking_last_quit_attempt_date , 4, 2), \n            SUBSTRING(smoking_last_quit_attempt_date , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END\n as observation_datetime,\n    CAST(smokes_per_day as float64) as value_as_number,\n    smoking_frequency as value_as_string,\n    smoking_longest_abstinence_duration as observation_source_value,\n    smoking_abstinence_unit as unit_source_value,\n    CAST(smokes_per_day as string) as value_source_value\n    FROM smoking_status sm\n)\n\nselect * from final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`intermediate_stg_smoking_status`"}, "model.NPS_OMOP_CDM.stg_observation_smoking_status": {"raw_sql": "with smoking_status as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'SMOKING_STATUS') }}\n)\n\nselect * from smoking_status", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SMOKING_STATUS"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Observation", "smoking_status", "stg_observation_smoking_status"], "unique_id": "model.NPS_OMOP_CDM.stg_observation_smoking_status", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Observation\\smoking_status\\stg_observation_smoking_status.sql", "original_file_path": "models\\staging\\Observation\\smoking_status\\stg_observation_smoking_status.sql", "name": "stg_observation_smoking_status", "alias": "stg_observation_smoking_status", "checksum": {"name": "sha256", "checksum": "2a60f3b32afdcc09d56573a87b16c972633fedadcf24b7c54a20d2d19946a487"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "SMOKING_STATUS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Observation\\smoking_status\\stg_observation_smoking_status.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3262742, "compiled_sql": "with smoking_status as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`SMOKING_STATUS`\n)\n\nselect * from smoking_status", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_observation_smoking_status`"}, "model.NPS_OMOP_CDM.stg_observation_period_encounter": {"raw_sql": "with encounter as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'ENCOUNTER') }}\n)\n\nselect * from encounter", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Observation_Period", "Encounter", "stg_observation_period_encounter"], "unique_id": "model.NPS_OMOP_CDM.stg_observation_period_encounter", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Observation_Period\\Encounter\\stg_observation_period_encounter.sql", "original_file_path": "models\\staging\\Observation_Period\\Encounter\\stg_observation_period_encounter.sql", "name": "stg_observation_period_encounter", "alias": "stg_observation_period_encounter", "checksum": {"name": "sha256", "checksum": "8289ea53c01d8f6926e56eff1ea8e9129b81d8914f3abe9377fed3226ce9578d"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "ENCOUNTER"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Observation_Period\\Encounter\\stg_observation_period_encounter.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3292658, "compiled_sql": "with encounter as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`ENCOUNTER`\n)\n\nselect * from encounter", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_observation_period_encounter`"}, "model.NPS_OMOP_CDM.stg_payer_plan_period_billing_service": {"raw_sql": "with billing_service as (\r\n    SELECT\r\n    *\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'BILLING_SERVICE') }}\r\n)\r\n\r\nSELECT * FROM billing_service", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.BILLING_SERVICE"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Payer_Plan_Period", "Billing_Service", "stg_payer_plan_period_billing_service"], "unique_id": "model.NPS_OMOP_CDM.stg_payer_plan_period_billing_service", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Payer_Plan_Period\\Billing_Service\\stg_payer_plan_period_billing_service.sql", "original_file_path": "models\\staging\\Payer_Plan_Period\\Billing_Service\\stg_payer_plan_period_billing_service.sql", "name": "stg_payer_plan_period_billing_service", "alias": "stg_payer_plan_period_billing_service", "checksum": {"name": "sha256", "checksum": "5acf4c2665f7550b2c69d9538c415e40e8eff30b85fdb381d3127da66eb23428"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "BILLING_SERVICE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Payer_Plan_Period\\Billing_Service\\stg_payer_plan_period_billing_service.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3312607, "compiled_sql": "with billing_service as (\n    SELECT\n    *\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`BILLING_SERVICE`\n)\n\nSELECT * FROM billing_service", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_payer_plan_period_billing_service`"}, "model.NPS_OMOP_CDM.stg_person_encounter": {"raw_sql": "with encounter as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'ENCOUNTER') }}\n)\n\nselect * from encounter", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Person", "Encounter", "stg_person_encounter"], "unique_id": "model.NPS_OMOP_CDM.stg_person_encounter", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Person\\Encounter\\stg_person_encounter.sql", "original_file_path": "models\\staging\\Person\\Encounter\\stg_person_encounter.sql", "name": "stg_person_encounter", "alias": "stg_person_encounter", "checksum": {"name": "sha256", "checksum": "8289ea53c01d8f6926e56eff1ea8e9129b81d8914f3abe9377fed3226ce9578d"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "ENCOUNTER"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Person\\Encounter\\stg_person_encounter.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3342524, "compiled_sql": "with encounter as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`ENCOUNTER`\n)\n\nselect * from encounter", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_person_encounter`"}, "model.NPS_OMOP_CDM.stg_person_encounter_reason": {"raw_sql": "with encounter_reason as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'ENCOUNTER_REASON') }}\n)\n\nselect * from encounter_reason", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER_REASON"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Person", "Encounter_Reason", "stg_person_encounter_reason"], "unique_id": "model.NPS_OMOP_CDM.stg_person_encounter_reason", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Person\\Encounter_Reason\\stg_person_encounter_reason.sql", "original_file_path": "models\\staging\\Person\\Encounter_Reason\\stg_person_encounter_reason.sql", "name": "stg_person_encounter_reason", "alias": "stg_person_encounter_reason", "checksum": {"name": "sha256", "checksum": "4006b159784b6affaff8ca9ba55369fc7874433fce60bd76b8df79d23d09154d"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "ENCOUNTER_REASON"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Person\\Encounter_Reason\\stg_person_encounter_reason.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.336247, "compiled_sql": "with encounter_reason as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`ENCOUNTER_REASON`\n)\n\nselect * from encounter_reason", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_person_encounter_reason`"}, "model.NPS_OMOP_CDM.stg_person_patient": {"raw_sql": "with patient as (\r\nSELECT\r\nCASE \r\nWHEN TRIM(LOWER(PATIENT_CITY)) LIKE \"x%\" THEN \"\"\r\nWHEN TRIM(LOWER(PATIENT_CITY)) = \"a\" THEN \"\" \r\nWHEN TRIM(LOWER(PATIENT_CITY)) = \"aa\" THEN \"\"\r\nELSE REGEXP_REPLACE(TRIM(LOWER(PATIENT_CITY)),r'[^a-z ]', '') END AS PATIENT_CITY,\r\nREGEXP_REPLACE(TRIM(PATIENT_POSTCODE),r'[^0-9]', '') AS PATIENT_POSTCODE, \r\nSITE_POSTCODE,\r\nPATIENT_NUMBER,\r\nSITE_ID, \r\nGENDER_CODE,\r\nGENDER_NAME,\r\nYEAR_OF_BIRTH,\r\nYEAR_OF_DEATH,\r\nDECEASED_INDICATOR,\r\nATSI_CODE,\r\nATSI_NAME,\r\nPENSION_CODE,\t\t\r\nPENSION_NAME,\t\t\r\nCIS_PATIENT_STATUS_CODE,\t\t\r\nCIS_PATIENT_STATUS_NAME,\t\t\r\nRACGP_PATIENT_STATUS_INDICATOR,\t\t\r\nPATIENT_CREATED_DATE,\t\t\r\nPATIENT_MODIFIED_DATE,\t\t\r\nPHN_CODE,\t\t\t\r\nSOURCE_SYSTEM,\t\t\r\nSOURCE_TABLE\t\t\r\nFROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATIENT') }}\r\n)\r\n\r\nSELECT \r\nCASE\r\nWHEN TRIM(PATIENT_CITY) =\"\" THEN NULL\r\nELSE PATIENT_CITY END AS PATIENT_CITY,\r\n\r\nCASE \r\nWHEN TRIM(PATIENT_POSTCODE) = \"\" THEN NULL\r\nELSE PATIENT_POSTCODE END AS PATIENT_POSTCODE,\r\nSITE_POSTCODE,\r\nPATIENT_NUMBER,\r\nSITE_ID, \r\nGENDER_CODE,\r\nGENDER_NAME,\r\nYEAR_OF_BIRTH,\r\nYEAR_OF_DEATH,\r\nDECEASED_INDICATOR,\r\nATSI_CODE,\r\nATSI_NAME,\r\nPENSION_CODE,\t\t\r\nPENSION_NAME,\t\t\r\nCIS_PATIENT_STATUS_CODE,\t\t\r\nCIS_PATIENT_STATUS_NAME,\t\t\r\nRACGP_PATIENT_STATUS_INDICATOR,\t\t\r\nPATIENT_CREATED_DATE,\t\t\r\nPATIENT_MODIFIED_DATE,\t\t\r\nPHN_CODE,\t\t\t\r\nSOURCE_SYSTEM,\t\t\r\nSOURCE_TABLE\r\nFROM patient", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Person", "Patient", "stg_person_patient"], "unique_id": "model.NPS_OMOP_CDM.stg_person_patient", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Person\\Patient\\stg_person_patient.sql", "original_file_path": "models\\staging\\Person\\Patient\\stg_person_patient.sql", "name": "stg_person_patient", "alias": "stg_person_patient", "checksum": {"name": "sha256", "checksum": "bc222e5656a0c305f58f77aad5139fdb3b6bcfbd981fe7442de733cdfd362f36"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATIENT"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Person\\Patient\\stg_person_patient.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.339241, "compiled_sql": "with patient as (\nSELECT\nCASE \nWHEN TRIM(LOWER(PATIENT_CITY)) LIKE \"x%\" THEN \"\"\nWHEN TRIM(LOWER(PATIENT_CITY)) = \"a\" THEN \"\" \nWHEN TRIM(LOWER(PATIENT_CITY)) = \"aa\" THEN \"\"\nELSE REGEXP_REPLACE(TRIM(LOWER(PATIENT_CITY)),r'[^a-z ]', '') END AS PATIENT_CITY,\nREGEXP_REPLACE(TRIM(PATIENT_POSTCODE),r'[^0-9]', '') AS PATIENT_POSTCODE, \nSITE_POSTCODE,\nPATIENT_NUMBER,\nSITE_ID, \nGENDER_CODE,\nGENDER_NAME,\nYEAR_OF_BIRTH,\nYEAR_OF_DEATH,\nDECEASED_INDICATOR,\nATSI_CODE,\nATSI_NAME,\nPENSION_CODE,\t\t\nPENSION_NAME,\t\t\nCIS_PATIENT_STATUS_CODE,\t\t\nCIS_PATIENT_STATUS_NAME,\t\t\nRACGP_PATIENT_STATUS_INDICATOR,\t\t\nPATIENT_CREATED_DATE,\t\t\nPATIENT_MODIFIED_DATE,\t\t\nPHN_CODE,\t\t\t\nSOURCE_SYSTEM,\t\t\nSOURCE_TABLE\t\t\nFROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATIENT`\n)\n\nSELECT \nCASE\nWHEN TRIM(PATIENT_CITY) =\"\" THEN NULL\nELSE PATIENT_CITY END AS PATIENT_CITY,\n\nCASE \nWHEN TRIM(PATIENT_POSTCODE) = \"\" THEN NULL\nELSE PATIENT_POSTCODE END AS PATIENT_POSTCODE,\nSITE_POSTCODE,\nPATIENT_NUMBER,\nSITE_ID, \nGENDER_CODE,\nGENDER_NAME,\nYEAR_OF_BIRTH,\nYEAR_OF_DEATH,\nDECEASED_INDICATOR,\nATSI_CODE,\nATSI_NAME,\nPENSION_CODE,\t\t\nPENSION_NAME,\t\t\nCIS_PATIENT_STATUS_CODE,\t\t\nCIS_PATIENT_STATUS_NAME,\t\t\nRACGP_PATIENT_STATUS_INDICATOR,\t\t\nPATIENT_CREATED_DATE,\t\t\nPATIENT_MODIFIED_DATE,\t\t\nPHN_CODE,\t\t\t\nSOURCE_SYSTEM,\t\t\nSOURCE_TABLE\nFROM patient", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_person_patient`"}, "model.NPS_OMOP_CDM.stg_procedure_occurrence_diagnosis": {"raw_sql": "with diagnosis as (\r\n    SELECT \r\n        *\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'DIAGNOSIS') }}\r\n)\r\n\r\nSELECT * FROM diagnosis", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.DIAGNOSIS"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Procedure_Occurrence", "Diagnosis", "stg_procedure_occurrence_diagnosis"], "unique_id": "model.NPS_OMOP_CDM.stg_procedure_occurrence_diagnosis", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Procedure_Occurrence\\Diagnosis\\stg_procedure_occurrence_diagnosis.sql", "original_file_path": "models\\staging\\Procedure_Occurrence\\Diagnosis\\stg_procedure_occurrence_diagnosis.sql", "name": "stg_procedure_occurrence_diagnosis", "alias": "stg_procedure_occurrence_diagnosis", "checksum": {"name": "sha256", "checksum": "4a6bfc6c4e253f02b7515c3b3070a464aa172ed3e90fd46a001ba0c6f97027cd"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "DIAGNOSIS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Procedure_Occurrence\\Diagnosis\\stg_procedure_occurrence_diagnosis.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3422313, "compiled_sql": "with diagnosis as (\n    SELECT \n        *\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`DIAGNOSIS`\n)\n\nSELECT * FROM diagnosis", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_procedure_occurrence_diagnosis`"}, "model.NPS_OMOP_CDM.stg_procedure_occurrence_encounter_reason": {"raw_sql": "with encounter_reason as (\r\n    SELECT \r\n        *\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'ENCOUNTER_REASON') }}\r\n)\r\n\r\nSELECT * FROM encounter_reason", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER_REASON"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Procedure_Occurrence", "Encounter_Reason", "stg_procedure_occurrence_encounter_reason"], "unique_id": "model.NPS_OMOP_CDM.stg_procedure_occurrence_encounter_reason", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Procedure_Occurrence\\Encounter_Reason\\stg_procedure_occurrence_encounter_reason.sql", "original_file_path": "models\\staging\\Procedure_Occurrence\\Encounter_Reason\\stg_procedure_occurrence_encounter_reason.sql", "name": "stg_procedure_occurrence_encounter_reason", "alias": "stg_procedure_occurrence_encounter_reason", "checksum": {"name": "sha256", "checksum": "ffac4fef64a356cbde623cf4494559f705344732104b2789b547c7e7fb733573"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "ENCOUNTER_REASON"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Procedure_Occurrence\\Encounter_Reason\\stg_procedure_occurrence_encounter_reason.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3442256, "compiled_sql": "with encounter_reason as (\n    SELECT \n        *\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`ENCOUNTER_REASON`\n)\n\nSELECT * FROM encounter_reason", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_procedure_occurrence_encounter_reason`"}, "model.NPS_OMOP_CDM.stg_procedure_occurrence_immunisation": {"raw_sql": "with immunisation as (\r\n    SELECT \r\n        *\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'IMMUNISATION') }}\r\n)\r\n\r\nSELECT * FROM immunisation", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.IMMUNISATION"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Procedure_Occurrence", "Immunisation", "stg_procedure_occurrence_immunisation"], "unique_id": "model.NPS_OMOP_CDM.stg_procedure_occurrence_immunisation", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Procedure_Occurrence\\Immunisation\\stg_procedure_occurrence_immunisation.sql", "original_file_path": "models\\staging\\Procedure_Occurrence\\Immunisation\\stg_procedure_occurrence_immunisation.sql", "name": "stg_procedure_occurrence_immunisation", "alias": "stg_procedure_occurrence_immunisation", "checksum": {"name": "sha256", "checksum": "bd2d463a7a37b57c33d8853b4c6ae09bde1dd33528f3cafc871f5a8d5a0dcbf1"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "IMMUNISATION"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Procedure_Occurrence\\Immunisation\\stg_procedure_occurrence_immunisation.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3472176, "compiled_sql": "with immunisation as (\n    SELECT \n        *\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`IMMUNISATION`\n)\n\nSELECT * FROM immunisation", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_procedure_occurrence_immunisation`"}, "model.NPS_OMOP_CDM.stg_procedure_occurrence_prescription": {"raw_sql": "with prescription as (\r\n    SELECT \r\n        *\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PRESCRIPTION') }}\r\n)\r\n\r\nSELECT * FROM prescription", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRESCRIPTION"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Procedure_Occurrence", "Prescription", "stg_procedure_occurrence_prescription"], "unique_id": "model.NPS_OMOP_CDM.stg_procedure_occurrence_prescription", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Procedure_Occurrence\\Prescription\\stg_procedure_occurrence_prescription.sql", "original_file_path": "models\\staging\\Procedure_Occurrence\\Prescription\\stg_procedure_occurrence_prescription.sql", "name": "stg_procedure_occurrence_prescription", "alias": "stg_procedure_occurrence_prescription", "checksum": {"name": "sha256", "checksum": "f6d4a175d786e462a653c9a5a1641c8444446e99be31b95546edc91bb8439c16"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PRESCRIPTION"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Procedure_Occurrence\\Prescription\\stg_procedure_occurrence_prescription.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3492124, "compiled_sql": "with prescription as (\n    SELECT \n        *\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PRESCRIPTION`\n)\n\nSELECT * FROM prescription", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_procedure_occurrence_prescription`"}, "model.NPS_OMOP_CDM.stg_procedure_occurrence_requested_test": {"raw_sql": "with requested_test as (\r\n    SELECT \r\n        *\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'REQUESTED_TEST') }}\r\n)\r\n\r\nSELECT * FROM requested_test", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.REQUESTED_TEST"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Procedure_Occurrence", "Requested_Test", "stg_procedure_occurrence_requested_test"], "unique_id": "model.NPS_OMOP_CDM.stg_procedure_occurrence_requested_test", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Procedure_Occurrence\\Requested_Test\\stg_procedure_occurrence_requested_test.sql", "original_file_path": "models\\staging\\Procedure_Occurrence\\Requested_Test\\stg_procedure_occurrence_requested_test.sql", "name": "stg_procedure_occurrence_requested_test", "alias": "stg_procedure_occurrence_requested_test", "checksum": {"name": "sha256", "checksum": "4db94a8b47cdaf0fb8de0e25eeab5945758832de607878420fc0f1b6203e7c2e"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "REQUESTED_TEST"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Procedure_Occurrence\\Requested_Test\\stg_procedure_occurrence_requested_test.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3512073, "compiled_sql": "with requested_test as (\n    SELECT \n        *\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`REQUESTED_TEST`\n)\n\nSELECT * FROM requested_test", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_procedure_occurrence_requested_test`"}, "model.NPS_OMOP_CDM.stg_procedure_occurrence_script_item": {"raw_sql": "with script_item as (\r\n    SELECT \r\n        *\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'SCRIPT_ITEM') }}\r\n)\r\n\r\nSELECT * FROM script_item", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SCRIPT_ITEM"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Procedure_Occurrence", "Script_Item", "stg_procedure_occurrence_script_item"], "unique_id": "model.NPS_OMOP_CDM.stg_procedure_occurrence_script_item", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Procedure_Occurrence\\Script_Item\\stg_procedure_occurrence_script_item.sql", "original_file_path": "models\\staging\\Procedure_Occurrence\\Script_Item\\stg_procedure_occurrence_script_item.sql", "name": "stg_procedure_occurrence_script_item", "alias": "stg_procedure_occurrence_script_item", "checksum": {"name": "sha256", "checksum": "550d2c9e1edd60348457ff66e825ddc6ab67aa364dd3ae73a9a9cdebfa682a76"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "SCRIPT_ITEM"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Procedure_Occurrence\\Script_Item\\stg_procedure_occurrence_script_item.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.354199, "compiled_sql": "with script_item as (\n    SELECT \n        *\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`SCRIPT_ITEM`\n)\n\nSELECT * FROM script_item", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_procedure_occurrence_script_item`"}, "model.NPS_OMOP_CDM.stg_provider_clinical_user": {"raw_sql": "with stg_clinical_user as (\r\n    SELECT \r\n        *\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'CLINICAL_USER') }}\r\n)\r\n\r\nSELECT * FROM stg_clinical_user", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.CLINICAL_USER"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Provider", "Clinical_User", "stg_provider_clinical_user"], "unique_id": "model.NPS_OMOP_CDM.stg_provider_clinical_user", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Provider\\Clinical_User\\stg_provider_clinical_user.sql", "original_file_path": "models\\staging\\Provider\\Clinical_User\\stg_provider_clinical_user.sql", "name": "stg_provider_clinical_user", "alias": "stg_provider_clinical_user", "checksum": {"name": "sha256", "checksum": "bcc7d0a7448d9c492167fcea2f28c67899a305ee98cb25a067e845623a9fcd71"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "CLINICAL_USER"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Provider\\Clinical_User\\stg_provider_clinical_user.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3571954, "compiled_sql": "with stg_clinical_user as (\n    SELECT \n        *\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`CLINICAL_USER`\n)\n\nSELECT * FROM stg_clinical_user", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_provider_clinical_user`"}, "model.NPS_OMOP_CDM.stg_provider_patient_matched_usual_provider": {"raw_sql": "with stg_patient_matched_usual_provider as (\r\n    SELECT \r\n        PROVIDER_FIRSTNAME,\r\n        PROVIDER_LASTNAME,\r\n        PROVIDER_TYPE,\r\n        SITE_ID,\r\n        CASE\r\n        WHEN PROVIDER_GENDER = \" \" THEN NULL\r\n        ELSE PROVIDER_GENDER END AS PROVIDER_GENDER,\r\n        PROVIDER_NUMBER\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATIENT_MATCHED_USUAL_PROVIDER') }}\r\n)\r\n\r\nSELECT * FROM stg_patient_matched_usual_provider", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT_MATCHED_USUAL_PROVIDER"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Provider", "Patient_Matched_Usual_Provider", "stg_provider_patient_matched_usual_provider"], "unique_id": "model.NPS_OMOP_CDM.stg_provider_patient_matched_usual_provider", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Provider\\Patient_Matched_Usual_Provider\\stg_provider_patient_matched_usual_provider.sql", "original_file_path": "models\\staging\\Provider\\Patient_Matched_Usual_Provider\\stg_provider_patient_matched_usual_provider.sql", "name": "stg_provider_patient_matched_usual_provider", "alias": "stg_provider_patient_matched_usual_provider", "checksum": {"name": "sha256", "checksum": "55c157a49237ea660493ba1ffa50e96a951595b4d1a08b41196216ab48982a0a"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATIENT_MATCHED_USUAL_PROVIDER"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Provider\\Patient_Matched_Usual_Provider\\stg_provider_patient_matched_usual_provider.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.360183, "compiled_sql": "with stg_patient_matched_usual_provider as (\n    SELECT \n        PROVIDER_FIRSTNAME,\n        PROVIDER_LASTNAME,\n        PROVIDER_TYPE,\n        SITE_ID,\n        CASE\n        WHEN PROVIDER_GENDER = \" \" THEN NULL\n        ELSE PROVIDER_GENDER END AS PROVIDER_GENDER,\n        PROVIDER_NUMBER\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATIENT_MATCHED_USUAL_PROVIDER`\n)\n\nSELECT * FROM stg_patient_matched_usual_provider", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_provider_patient_matched_usual_provider`"}, "model.NPS_OMOP_CDM.stg_provider_practice_contact": {"raw_sql": "with stg_practice_contact as (\r\n    SELECT\r\n        {{replace_empty_string_with_null(['CONTACT_FIRSTNAME','CONTACT_LASTNAME'])}}\r\n        SITE_ID,\r\n        PROVIDER_NUMBER\r\n    FROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PRACTICE_CONTACT') }}\r\n)\r\n\r\nSELECT * FROM stg_practice_contact", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.NPS_OMOP_CDM.replace_empty_string_with_null"], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRACTICE_CONTACT"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Provider", "Practice_Contact", "stg_provider_practice_contact"], "unique_id": "model.NPS_OMOP_CDM.stg_provider_practice_contact", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Provider\\Practice_Contact\\stg_provider_practice_contact.sql", "original_file_path": "models\\staging\\Provider\\Practice_Contact\\stg_provider_practice_contact.sql", "name": "stg_provider_practice_contact", "alias": "stg_provider_practice_contact", "checksum": {"name": "sha256", "checksum": "b416988da1c29d59fa28c76d7390d8af4484389b99f99bc41f3f6ce692366251"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PRACTICE_CONTACT"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Provider\\Practice_Contact\\stg_provider_practice_contact.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.363175, "compiled_sql": "with stg_practice_contact as (\n    SELECT\n        \n\n  \n    \n    CASE\n    WHEN CONTACT_FIRSTNAME  = \"\" THEN NULL\n    ELSE CONTACT_FIRSTNAME END AS  CONTACT_FIRSTNAME,\n\n  \n    \n    CASE\n    WHEN CONTACT_LASTNAME  = \"\" THEN NULL\n    ELSE CONTACT_LASTNAME END AS  CONTACT_LASTNAME,\n\n  \n\n        SITE_ID,\n        PROVIDER_NUMBER\n    FROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PRACTICE_CONTACT`\n)\n\nSELECT * FROM stg_practice_contact", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_provider_practice_contact`"}, "model.NPS_OMOP_CDM.stg_provider_requested_test": {"raw_sql": "with stg_requested_test as (\r\nSELECT \r\nCASE \r\nWHEN SUBSTRING(PROVIDER_LAB_NAME,1,1) LIKE \"*%\" OR SUBSTRING(PROVIDER_LAB_NAME,1,1) LIKE \"#%\" OR SUBSTRING(PROVIDER_LAB_NAME,1,1) LIKE '\"%'\r\nOR SUBSTRING(PROVIDER_LAB_NAME,1,1) LIKE \".%\"  OR SUBSTRING(PROVIDER_LAB_NAME,1,1) LIKE \"-%\" OR SUBSTRING(PROVIDER_LAB_NAME,1,1) LIKE \"+%\"\r\nTHEN REGEXP_REPLACE(TRIM(PROVIDER_LAB_NAME),r'[^a-zA-Z0-9 ]', '')\r\nWHEN  PROVIDER_LAB_NAME = '\\\\' THEN NULL\r\nELSE PROVIDER_LAB_NAME END AS PROVIDER_LAB_NAME,\r\nSITE_ID,\r\nPROVIDER_ID,\r\nFROM {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'REQUESTED_TEST') }}\r\n)\r\n\r\nSELECT \r\nCASE WHEN TRIM(PROVIDER_LAB_NAME) = \"\" THEN NULL\r\nELSE LOWER(TRIM(PROVIDER_LAB_NAME)) END AS PROVIDER_LAB_NAME,\r\nSITE_ID,\r\nPROVIDER_ID\r\nFROM stg_requested_test", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.REQUESTED_TEST"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Provider", "Requested_Test", "stg_provider_requested_test"], "unique_id": "model.NPS_OMOP_CDM.stg_provider_requested_test", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Provider\\Requested_Test\\stg_provider_requested_test.sql", "original_file_path": "models\\staging\\Provider\\Requested_Test\\stg_provider_requested_test.sql", "name": "stg_provider_requested_test", "alias": "stg_provider_requested_test", "checksum": {"name": "sha256", "checksum": "fe6f479652a855dc65eb69822a71c9ecb924d38ef8afedb077a3faeb6f12744b"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "REQUESTED_TEST"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Provider\\Requested_Test\\stg_provider_requested_test.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.367389, "compiled_sql": "with stg_requested_test as (\nSELECT \nCASE \nWHEN SUBSTRING(PROVIDER_LAB_NAME,1,1) LIKE \"*%\" OR SUBSTRING(PROVIDER_LAB_NAME,1,1) LIKE \"#%\" OR SUBSTRING(PROVIDER_LAB_NAME,1,1) LIKE '\"%'\nOR SUBSTRING(PROVIDER_LAB_NAME,1,1) LIKE \".%\"  OR SUBSTRING(PROVIDER_LAB_NAME,1,1) LIKE \"-%\" OR SUBSTRING(PROVIDER_LAB_NAME,1,1) LIKE \"+%\"\nTHEN REGEXP_REPLACE(TRIM(PROVIDER_LAB_NAME),r'[^a-zA-Z0-9 ]', '')\nWHEN  PROVIDER_LAB_NAME = '\\\\' THEN NULL\nELSE PROVIDER_LAB_NAME END AS PROVIDER_LAB_NAME,\nSITE_ID,\nPROVIDER_ID,\nFROM `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`REQUESTED_TEST`\n)\n\nSELECT \nCASE WHEN TRIM(PROVIDER_LAB_NAME) = \"\" THEN NULL\nELSE LOWER(TRIM(PROVIDER_LAB_NAME)) END AS PROVIDER_LAB_NAME,\nSITE_ID,\nPROVIDER_ID\nFROM stg_requested_test", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_provider_requested_test`"}, "model.NPS_OMOP_CDM.stg_specimen_pathology": {"raw_sql": "with pathology as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATHOLOGY') }}\n)\n\nselect * from pathology", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Specimen", "Pathology", "stg_specimen_pathology"], "unique_id": "model.NPS_OMOP_CDM.stg_specimen_pathology", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Specimen\\Pathology\\stg_specimen_pathology.sql", "original_file_path": "models\\staging\\Specimen\\Pathology\\stg_specimen_pathology.sql", "name": "stg_specimen_pathology", "alias": "stg_specimen_pathology", "checksum": {"name": "sha256", "checksum": "f55e946a1b78c5643811360efeb1934be7281603973d4b22406ffc549ebb83ea"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Specimen\\Pathology\\stg_specimen_pathology.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3693883, "compiled_sql": "with pathology as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY`\n)\n\nselect * from pathology", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_specimen_pathology`"}, "model.NPS_OMOP_CDM.stg_specimen_pathology_albumin": {"raw_sql": "with pathology_albumin as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATHOLOGY_ALBUMIN') }}\n)\n\nselect * from pathology_albumin", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_ALBUMIN"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Specimen", "Pathology_albumin", "stg_specimen_pathology_albumin"], "unique_id": "model.NPS_OMOP_CDM.stg_specimen_pathology_albumin", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Specimen\\Pathology_albumin\\stg_specimen_pathology_albumin.sql", "original_file_path": "models\\staging\\Specimen\\Pathology_albumin\\stg_specimen_pathology_albumin.sql", "name": "stg_specimen_pathology_albumin", "alias": "stg_specimen_pathology_albumin", "checksum": {"name": "sha256", "checksum": "aa465f5bce5cd7c8ddcc183982879e66253da3097fe3b8207bfcb38ca6fa9d34"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_ALBUMIN"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Specimen\\Pathology_albumin\\stg_specimen_pathology_albumin.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.372351, "compiled_sql": "with pathology_albumin as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_ALBUMIN`\n)\n\nselect * from pathology_albumin", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_specimen_pathology_albumin`"}, "model.NPS_OMOP_CDM.stg_specimen_pathology_egfr": {"raw_sql": "with pathology_egfr as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATHOLOGY_EGFR') }}\n)\n\nselect * from pathology_egfr", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_EGFR"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Specimen", "Pathology_egfr", "stg_specimen_pathology_egfr"], "unique_id": "model.NPS_OMOP_CDM.stg_specimen_pathology_egfr", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Specimen\\Pathology_egfr\\stg_specimen_pathology_egfr.sql", "original_file_path": "models\\staging\\Specimen\\Pathology_egfr\\stg_specimen_pathology_egfr.sql", "name": "stg_specimen_pathology_egfr", "alias": "stg_specimen_pathology_egfr", "checksum": {"name": "sha256", "checksum": "7bdf38b81d57855e39e9d72a55fa4ca26a2efa25daa4b9808b168d4f0adda2de"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_EGFR"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Specimen\\Pathology_egfr\\stg_specimen_pathology_egfr.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.375368, "compiled_sql": "with pathology_egfr as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_EGFR`\n)\n\nselect * from pathology_egfr", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_specimen_pathology_egfr`"}, "model.NPS_OMOP_CDM.stg_specimen_pathology_hba1c": {"raw_sql": "with pathology_hba1c as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATHOLOGY_HBA1C') }}\n)\n\nselect * from pathology_hba1c", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_HBA1C"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Specimen", "Pathology_hba1c", "stg_specimen_pathology_hba1c"], "unique_id": "model.NPS_OMOP_CDM.stg_specimen_pathology_hba1c", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Specimen\\Pathology_hba1c\\stg_specimen_pathology_hba1c.sql", "original_file_path": "models\\staging\\Specimen\\Pathology_hba1c\\stg_specimen_pathology_hba1c.sql", "name": "stg_specimen_pathology_hba1c", "alias": "stg_specimen_pathology_hba1c", "checksum": {"name": "sha256", "checksum": "6d5d1bacc6904f36a5d319e6a08c37b99183b575f043b5f56f109a670b136095"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_HBA1C"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Specimen\\Pathology_hba1c\\stg_specimen_pathology_hba1c.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3773623, "compiled_sql": "with pathology_hba1c as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_HBA1C`\n)\n\nselect * from pathology_hba1c", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_specimen_pathology_hba1c`"}, "model.NPS_OMOP_CDM.stg_specimen_pathology_lipids": {"raw_sql": "with pathology_lipids as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'PATHOLOGY_LIPIDS') }}\n)\n\nselect * from pathology_lipids", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_LIPIDS"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Specimen", "Pathology_lipids", "stg_specimen_pathology_lipids"], "unique_id": "model.NPS_OMOP_CDM.stg_specimen_pathology_lipids", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Specimen\\Pathology_lipids\\stg_specimen_pathology_lipids.sql", "original_file_path": "models\\staging\\Specimen\\Pathology_lipids\\stg_specimen_pathology_lipids.sql", "name": "stg_specimen_pathology_lipids", "alias": "stg_specimen_pathology_lipids", "checksum": {"name": "sha256", "checksum": "796abfc51129f18f3d571b2df314c3a44ac9f0f306111b08d6de76e29449c692"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_LIPIDS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Specimen\\Pathology_lipids\\stg_specimen_pathology_lipids.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3793614, "compiled_sql": "with pathology_lipids as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_LIPIDS`\n)\n\nselect * from pathology_lipids", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_specimen_pathology_lipids`"}, "model.NPS_OMOP_CDM.stg_visit_occurrence_encounter": {"raw_sql": "with encounter as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'ENCOUNTER') }}\n)\n\nselect * from encounter", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Visit_Occurrence", "Encounter", "stg_visit_occurrence_encounter"], "unique_id": "model.NPS_OMOP_CDM.stg_visit_occurrence_encounter", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Visit_Occurrence\\Encounter\\stg_visit_occurrence_encounter.sql", "original_file_path": "models\\staging\\Visit_Occurrence\\Encounter\\stg_visit_occurrence_encounter.sql", "name": "stg_visit_occurrence_encounter", "alias": "stg_visit_occurrence_encounter", "checksum": {"name": "sha256", "checksum": "8289ea53c01d8f6926e56eff1ea8e9129b81d8914f3abe9377fed3226ce9578d"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "ENCOUNTER"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Visit_Occurrence\\Encounter\\stg_visit_occurrence_encounter.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.381353, "compiled_sql": "with encounter as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`ENCOUNTER`\n)\n\nselect * from encounter", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_visit_occurrence_encounter`"}, "model.NPS_OMOP_CDM.stg_visit_occurrence_encounter_reason": {"raw_sql": "with encounter_reason as (\n    select \n        *\n    from {{ source('C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021', 'ENCOUNTER_REASON') }}\n)\n\nselect * from encounter_reason", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER_REASON"]}, "config": {"enabled": true, "alias": null, "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY", "fqn": ["NPS_OMOP_CDM", "staging", "Visit_Occurrence", "Encounter_reason", "stg_visit_occurrence_encounter_reason"], "unique_id": "model.NPS_OMOP_CDM.stg_visit_occurrence_encounter_reason", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "staging\\Visit_Occurrence\\Encounter_reason\\stg_visit_occurrence_encounter_reason.sql", "original_file_path": "models\\staging\\Visit_Occurrence\\Encounter_reason\\stg_visit_occurrence_encounter_reason.sql", "name": "stg_visit_occurrence_encounter_reason", "alias": "stg_visit_occurrence_encounter_reason", "checksum": {"name": "sha256", "checksum": "4006b159784b6affaff8ca9ba55369fc7874433fce60bd76b8df79d23d09154d"}, "tags": [], "refs": [], "sources": [["C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "ENCOUNTER_REASON"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\staging\\Visit_Occurrence\\Encounter_reason\\stg_visit_occurrence_encounter_reason.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "view", "schema": "C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY"}, "created_at": 1651482438.3833468, "compiled_sql": "with encounter_reason as (\n    select \n        *\n    from `nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`ENCOUNTER_REASON`\n)\n\nselect * from encounter_reason", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_visit_occurrence_encounter_reason`"}, "test.NPS_OMOP_CDM.generic_test": {"raw_sql": "", "resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "generic_test"], "unique_id": "test.NPS_OMOP_CDM.generic_test", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "generic_test.sql", "original_file_path": "tests\\generic_test.sql", "name": "generic_test", "alias": "generic_test", "checksum": {"name": "sha256", "checksum": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.395318}, "seed.NPS_OMOP_CDM.postcode_data": {"raw_sql": "", "compiled": true, "resource_type": "seed", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP_SEEDS_ONLY", "database": null, "tags": [], "meta": {}, "materialized": "seed", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "quote_columns": null, "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP_SEEDS_ONLY", "fqn": ["NPS_OMOP_CDM", "postcode_data"], "unique_id": "seed.NPS_OMOP_CDM.postcode_data", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "postcode_data.csv", "original_file_path": "seeds\\postcode_data.csv", "name": "postcode_data", "alias": "postcode_data", "checksum": {"name": "sha256", "checksum": "3cef351efb63b8dbb5f50cf9b6e7d42caf411ebc60975f12565b2b4901c9f211"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {"id": {"name": "id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "postcode": {"name": "postcode", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://seeds\\postcode_data.yml", "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP_SEEDS_ONLY"}, "created_at": 1651482438.8809874, "compiled_sql": "", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP_SEEDS_ONLY`.`postcode_data`"}, "test.NPS_OMOP_CDM.not_null_cost_cost_id.96e8810b57": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "cost_id", "model": "{{ get_where_subquery(ref('cost')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.cost"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Cost", "not_null_cost_cost_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_cost_cost_id.96e8810b57", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_cost_cost_id.sql", "original_file_path": "models\\CDM\\Cost\\cost.yml", "name": "not_null_cost_cost_id", "alias": "not_null_cost_cost_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["cost"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Cost\\cost.yml\\not_null_cost_cost_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.5079873, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`cost`\nwhere cost_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "cost_id", "file_key_name": "models.cost"}, "test.NPS_OMOP_CDM.unique_cost_cost_id.059b55a036": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "cost_id", "model": "{{ get_where_subquery(ref('cost')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.cost"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Cost", "unique_cost_cost_id"], "unique_id": "test.NPS_OMOP_CDM.unique_cost_cost_id.059b55a036", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "unique_cost_cost_id.sql", "original_file_path": "models\\CDM\\Cost\\cost.yml", "name": "unique_cost_cost_id", "alias": "unique_cost_cost_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["cost"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Cost\\cost.yml\\unique_cost_cost_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.509981, "compiled_sql": "\n    \n    \n\nwith dbt_test__target as (\n  \n  select cost_id as unique_field\n  from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`cost`\n  where cost_id is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "cost_id", "file_key_name": "models.cost"}, "test.NPS_OMOP_CDM.not_null_cost_cost_event_id.04919371b7": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "cost_event_id", "model": "{{ get_where_subquery(ref('cost')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.cost"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Cost", "not_null_cost_cost_event_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_cost_cost_event_id.04919371b7", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_cost_cost_event_id.sql", "original_file_path": "models\\CDM\\Cost\\cost.yml", "name": "not_null_cost_cost_event_id", "alias": "not_null_cost_cost_event_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["cost"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Cost\\cost.yml\\not_null_cost_cost_event_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.5119748, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`cost`\nwhere cost_event_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "cost_event_id", "file_key_name": "models.cost"}, "test.NPS_OMOP_CDM.not_null_fact_relationship_fact_id_1.c1a4cb78dc": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "fact_id_1", "model": "{{ get_where_subquery(ref('fact_relationship')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.fact_relationship"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Fact_Relationship", "not_null_fact_relationship_fact_id_1"], "unique_id": "test.NPS_OMOP_CDM.not_null_fact_relationship_fact_id_1.c1a4cb78dc", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_fact_relationship_fact_id_1.sql", "original_file_path": "models\\CDM\\Fact_Relationship\\fact_relationship.yml", "name": "not_null_fact_relationship_fact_id_1", "alias": "not_null_fact_relationship_fact_id_1", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["fact_relationship"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Fact_Relationship\\fact_relationship.yml\\not_null_fact_relationship_fact_id_1.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.5708182, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`fact_relationship`\nwhere fact_id_1 is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "fact_id_1", "file_key_name": "models.fact_relationship"}, "test.NPS_OMOP_CDM.not_null_fact_relationship_fact_id_2.c3b8acff83": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "fact_id_2", "model": "{{ get_where_subquery(ref('fact_relationship')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.fact_relationship"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Fact_Relationship", "not_null_fact_relationship_fact_id_2"], "unique_id": "test.NPS_OMOP_CDM.not_null_fact_relationship_fact_id_2.c3b8acff83", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_fact_relationship_fact_id_2.sql", "original_file_path": "models\\CDM\\Fact_Relationship\\fact_relationship.yml", "name": "not_null_fact_relationship_fact_id_2", "alias": "not_null_fact_relationship_fact_id_2", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["fact_relationship"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Fact_Relationship\\fact_relationship.yml\\not_null_fact_relationship_fact_id_2.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.572814, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`fact_relationship`\nwhere fact_id_2 is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "fact_id_2", "file_key_name": "models.fact_relationship"}, "test.NPS_OMOP_CDM.unique_measurement_measurement_id.a3f1e8466d": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "measurement_id", "model": "{{ get_where_subquery(ref('measurement')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.measurement"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Measurement", "unique_measurement_measurement_id"], "unique_id": "test.NPS_OMOP_CDM.unique_measurement_measurement_id.a3f1e8466d", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "unique_measurement_measurement_id.sql", "original_file_path": "models\\CDM\\Measurement\\measurement.yml", "name": "unique_measurement_measurement_id", "alias": "unique_measurement_measurement_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["measurement"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Measurement\\measurement.yml\\unique_measurement_measurement_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.5947535, "compiled_sql": "\n    \n    \n\nwith dbt_test__target as (\n  \n  select measurement_id as unique_field\n  from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`measurement`\n  where measurement_id is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "measurement_id", "file_key_name": "models.measurement"}, "test.NPS_OMOP_CDM.not_null_measurement_measurement_id.80b56c4597": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "measurement_id", "model": "{{ get_where_subquery(ref('measurement')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.measurement"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Measurement", "not_null_measurement_measurement_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_measurement_measurement_id.80b56c4597", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_measurement_measurement_id.sql", "original_file_path": "models\\CDM\\Measurement\\measurement.yml", "name": "not_null_measurement_measurement_id", "alias": "not_null_measurement_measurement_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["measurement"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Measurement\\measurement.yml\\not_null_measurement_measurement_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.649636, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`measurement`\nwhere measurement_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "measurement_id", "file_key_name": "models.measurement"}, "test.NPS_OMOP_CDM.not_null_measurement_person_id.7cf48be66f": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "person_id", "model": "{{ get_where_subquery(ref('measurement')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.measurement"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Measurement", "not_null_measurement_person_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_measurement_person_id.7cf48be66f", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_measurement_person_id.sql", "original_file_path": "models\\CDM\\Measurement\\measurement.yml", "name": "not_null_measurement_person_id", "alias": "not_null_measurement_person_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["measurement"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Measurement\\measurement.yml\\not_null_measurement_person_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.6516309, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`measurement`\nwhere person_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.measurement"}, "test.NPS_OMOP_CDM.relationships_measurement_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.e7603f5f52": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_measurement_978e2b2e6a5433f53cfe4bf355b0ad2f\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person')", "field": "person_id", "column_name": "person_id", "model": "{{ get_where_subquery(ref('measurement')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.measurement"]}, "config": {"enabled": true, "alias": "relationships_measurement_978e2b2e6a5433f53cfe4bf355b0ad2f", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Measurement", "relationships_measurement_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_"], "unique_id": "test.NPS_OMOP_CDM.relationships_measurement_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.e7603f5f52", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_measurement_978e2b2e6a5433f53cfe4bf355b0ad2f.sql", "original_file_path": "models\\CDM\\Measurement\\measurement.yml", "name": "relationships_measurement_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_", "alias": "relationships_measurement_978e2b2e6a5433f53cfe4bf355b0ad2f", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["measurement"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Measurement\\measurement.yml\\relationships_measurement_978e2b2e6a5433f53cfe4bf355b0ad2f.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_measurement_978e2b2e6a5433f53cfe4bf355b0ad2f"}, "created_at": 1651482438.6536307, "compiled_sql": "\n    \n    \n\nwith child as (\n    select person_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`measurement`\n    where person_id is not null\n),\n\nparent as (\n    select person_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.measurement"}, "test.NPS_OMOP_CDM.not_null_measurement_measurement_date.f0992e3082": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "measurement_date", "model": "{{ get_where_subquery(ref('measurement')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.measurement"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Measurement", "not_null_measurement_measurement_date"], "unique_id": "test.NPS_OMOP_CDM.not_null_measurement_measurement_date.f0992e3082", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_measurement_measurement_date.sql", "original_file_path": "models\\CDM\\Measurement\\measurement.yml", "name": "not_null_measurement_measurement_date", "alias": "not_null_measurement_measurement_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["measurement"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Measurement\\measurement.yml\\not_null_measurement_measurement_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.6616096, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`measurement`\nwhere measurement_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "measurement_date", "file_key_name": "models.measurement"}, "test.NPS_OMOP_CDM.unique_observation_observation_id.c7fcc2846f": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "observation_id", "model": "{{ get_where_subquery(ref('observation')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.observation"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Observation", "unique_observation_observation_id"], "unique_id": "test.NPS_OMOP_CDM.unique_observation_observation_id.c7fcc2846f", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "unique_observation_observation_id.sql", "original_file_path": "models\\CDM\\Observation\\observation.yml", "name": "unique_observation_observation_id", "alias": "unique_observation_observation_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["observation"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Observation\\observation.yml\\unique_observation_observation_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.6835434, "compiled_sql": "\n    \n    \n\nwith dbt_test__target as (\n  \n  select observation_id as unique_field\n  from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`observation`\n  where observation_id is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "observation_id", "file_key_name": "models.observation"}, "test.NPS_OMOP_CDM.not_null_observation_observation_id.efd24835d6": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "observation_id", "model": "{{ get_where_subquery(ref('observation')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.observation"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Observation", "not_null_observation_observation_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_observation_observation_id.efd24835d6", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_observation_observation_id.sql", "original_file_path": "models\\CDM\\Observation\\observation.yml", "name": "not_null_observation_observation_id", "alias": "not_null_observation_observation_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["observation"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Observation\\observation.yml\\not_null_observation_observation_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.686537, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`observation`\nwhere observation_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "observation_id", "file_key_name": "models.observation"}, "test.NPS_OMOP_CDM.not_null_observation_person_id.8fa7495344": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "person_id", "model": "{{ get_where_subquery(ref('observation')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.observation"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Observation", "not_null_observation_person_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_observation_person_id.8fa7495344", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_observation_person_id.sql", "original_file_path": "models\\CDM\\Observation\\observation.yml", "name": "not_null_observation_person_id", "alias": "not_null_observation_person_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["observation"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Observation\\observation.yml\\not_null_observation_person_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.6895282, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`observation`\nwhere person_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.observation"}, "test.NPS_OMOP_CDM.relationships_observation_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.64381f454b": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_observation_0b34df1708213058486222bee0ec23c9\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person')", "field": "person_id", "column_name": "person_id", "model": "{{ get_where_subquery(ref('observation')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.observation"]}, "config": {"enabled": true, "alias": "relationships_observation_0b34df1708213058486222bee0ec23c9", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Observation", "relationships_observation_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_"], "unique_id": "test.NPS_OMOP_CDM.relationships_observation_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.64381f454b", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_observation_0b34df1708213058486222bee0ec23c9.sql", "original_file_path": "models\\CDM\\Observation\\observation.yml", "name": "relationships_observation_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_", "alias": "relationships_observation_0b34df1708213058486222bee0ec23c9", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["observation"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Observation\\observation.yml\\relationships_observation_0b34df1708213058486222bee0ec23c9.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_observation_0b34df1708213058486222bee0ec23c9"}, "created_at": 1651482438.691495, "compiled_sql": "\n    \n    \n\nwith child as (\n    select person_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`observation`\n    where person_id is not null\n),\n\nparent as (\n    select person_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.observation"}, "test.NPS_OMOP_CDM.not_null_observation_period_observation_period_id.6c6fb96d33": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "observation_period_id", "model": "{{ get_where_subquery(ref('observation_period')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.observation_period"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Observation_Period", "not_null_observation_period_observation_period_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_observation_period_observation_period_id.6c6fb96d33", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_observation_period_observation_period_id.sql", "original_file_path": "models\\CDM\\Observation_Period\\observation_period.yml", "name": "not_null_observation_period_observation_period_id", "alias": "not_null_observation_period_observation_period_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["observation_period"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Observation_Period\\observation_period.yml\\not_null_observation_period_observation_period_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.7004838, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`observation_period`\nwhere observation_period_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "observation_period_id", "file_key_name": "models.observation_period"}, "test.NPS_OMOP_CDM.not_null_observation_period_person_id.71c8f248d3": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "person_id", "model": "{{ get_where_subquery(ref('observation_period')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.observation_period"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Observation_Period", "not_null_observation_period_person_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_observation_period_person_id.71c8f248d3", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_observation_period_person_id.sql", "original_file_path": "models\\CDM\\Observation_Period\\observation_period.yml", "name": "not_null_observation_period_person_id", "alias": "not_null_observation_period_person_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["observation_period"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Observation_Period\\observation_period.yml\\not_null_observation_period_person_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.7024665, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`observation_period`\nwhere person_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.observation_period"}, "test.NPS_OMOP_CDM.relationships_observation_period_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.3774a43eff": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_observation_peri_bff582c2e2a5b5384690ca091b886f59\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person')", "field": "person_id", "column_name": "person_id", "model": "{{ get_where_subquery(ref('observation_period')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.observation_period"]}, "config": {"enabled": true, "alias": "relationships_observation_peri_bff582c2e2a5b5384690ca091b886f59", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Observation_Period", "relationships_observation_period_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_"], "unique_id": "test.NPS_OMOP_CDM.relationships_observation_period_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.3774a43eff", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_observation_peri_bff582c2e2a5b5384690ca091b886f59.sql", "original_file_path": "models\\CDM\\Observation_Period\\observation_period.yml", "name": "relationships_observation_period_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_", "alias": "relationships_observation_peri_bff582c2e2a5b5384690ca091b886f59", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["observation_period"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Observation_Period\\observation_period.yml\\relationships_observation_peri_bff582c2e2a5b5384690ca091b886f59.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_observation_peri_bff582c2e2a5b5384690ca091b886f59"}, "created_at": 1651482438.7044613, "compiled_sql": "\n    \n    \n\nwith child as (\n    select person_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`observation_period`\n    where person_id is not null\n),\n\nparent as (\n    select person_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.observation_period"}, "test.NPS_OMOP_CDM.not_null_observation_period_observation_period_start_date.e88435db95": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "observation_period_start_date", "model": "{{ get_where_subquery(ref('observation_period')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.observation_period"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Observation_Period", "not_null_observation_period_observation_period_start_date"], "unique_id": "test.NPS_OMOP_CDM.not_null_observation_period_observation_period_start_date.e88435db95", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_observation_period_observation_period_start_date.sql", "original_file_path": "models\\CDM\\Observation_Period\\observation_period.yml", "name": "not_null_observation_period_observation_period_start_date", "alias": "not_null_observation_period_observation_period_start_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["observation_period"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Observation_Period\\observation_period.yml\\not_null_observation_period_observation_period_start_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.709447, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`observation_period`\nwhere observation_period_start_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "observation_period_start_date", "file_key_name": "models.observation_period"}, "test.NPS_OMOP_CDM.not_null_observation_period_observation_period_end_date.e74764a048": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "observation_period_end_date", "model": "{{ get_where_subquery(ref('observation_period')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.observation_period"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Observation_Period", "not_null_observation_period_observation_period_end_date"], "unique_id": "test.NPS_OMOP_CDM.not_null_observation_period_observation_period_end_date.e74764a048", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_observation_period_observation_period_end_date.sql", "original_file_path": "models\\CDM\\Observation_Period\\observation_period.yml", "name": "not_null_observation_period_observation_period_end_date", "alias": "not_null_observation_period_observation_period_end_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["observation_period"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Observation_Period\\observation_period.yml\\not_null_observation_period_observation_period_end_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.7134364, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`observation_period`\nwhere observation_period_end_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "observation_period_end_date", "file_key_name": "models.observation_period"}, "test.NPS_OMOP_CDM.not_null_observation_period_period_type_concept_id.b993e0023c": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "period_type_concept_id", "model": "{{ get_where_subquery(ref('observation_period')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.observation_period"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Observation_Period", "not_null_observation_period_period_type_concept_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_observation_period_period_type_concept_id.b993e0023c", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_observation_period_period_type_concept_id.sql", "original_file_path": "models\\CDM\\Observation_Period\\observation_period.yml", "name": "not_null_observation_period_period_type_concept_id", "alias": "not_null_observation_period_period_type_concept_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["observation_period"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Observation_Period\\observation_period.yml\\not_null_observation_period_period_type_concept_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.7154331, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`observation_period`\nwhere period_type_concept_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "period_type_concept_id", "file_key_name": "models.observation_period"}, "test.NPS_OMOP_CDM.not_null_payer_plan_period_payer_plan_period_id.638983fb69": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "payer_plan_period_id", "model": "{{ get_where_subquery(ref('payer_plan_period')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.payer_plan_period"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Payer_Plan_Period", "not_null_payer_plan_period_payer_plan_period_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_payer_plan_period_payer_plan_period_id.638983fb69", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_payer_plan_period_payer_plan_period_id.sql", "original_file_path": "models\\CDM\\Payer_Plan_Period\\payer_plan_period.yml", "name": "not_null_payer_plan_period_payer_plan_period_id", "alias": "not_null_payer_plan_period_payer_plan_period_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["payer_plan_period"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Payer_Plan_Period\\payer_plan_period.yml\\not_null_payer_plan_period_payer_plan_period_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.722413, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`payer_plan_period`\nwhere payer_plan_period_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "payer_plan_period_id", "file_key_name": "models.payer_plan_period"}, "test.NPS_OMOP_CDM.unique_payer_plan_period_payer_plan_period_id.68e7598f49": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "payer_plan_period_id", "model": "{{ get_where_subquery(ref('payer_plan_period')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.payer_plan_period"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Payer_Plan_Period", "unique_payer_plan_period_payer_plan_period_id"], "unique_id": "test.NPS_OMOP_CDM.unique_payer_plan_period_payer_plan_period_id.68e7598f49", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "unique_payer_plan_period_payer_plan_period_id.sql", "original_file_path": "models\\CDM\\Payer_Plan_Period\\payer_plan_period.yml", "name": "unique_payer_plan_period_payer_plan_period_id", "alias": "unique_payer_plan_period_payer_plan_period_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["payer_plan_period"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Payer_Plan_Period\\payer_plan_period.yml\\unique_payer_plan_period_payer_plan_period_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.7244086, "compiled_sql": "\n    \n    \n\nwith dbt_test__target as (\n  \n  select payer_plan_period_id as unique_field\n  from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`payer_plan_period`\n  where payer_plan_period_id is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "payer_plan_period_id", "file_key_name": "models.payer_plan_period"}, "test.NPS_OMOP_CDM.not_null_payer_plan_period_person_id.3a67e6214a": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "person_id", "model": "{{ get_where_subquery(ref('payer_plan_period')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.payer_plan_period"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Payer_Plan_Period", "not_null_payer_plan_period_person_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_payer_plan_period_person_id.3a67e6214a", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_payer_plan_period_person_id.sql", "original_file_path": "models\\CDM\\Payer_Plan_Period\\payer_plan_period.yml", "name": "not_null_payer_plan_period_person_id", "alias": "not_null_payer_plan_period_person_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["payer_plan_period"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Payer_Plan_Period\\payer_plan_period.yml\\not_null_payer_plan_period_person_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.7274077, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`payer_plan_period`\nwhere person_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.payer_plan_period"}, "test.NPS_OMOP_CDM.relationships_payer_plan_period_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.830d86145b": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_payer_plan_perio_42db34d1903fc2fad1f4db0b9164f427\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person')", "field": "person_id", "column_name": "person_id", "model": "{{ get_where_subquery(ref('payer_plan_period')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.payer_plan_period"]}, "config": {"enabled": true, "alias": "relationships_payer_plan_perio_42db34d1903fc2fad1f4db0b9164f427", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Payer_Plan_Period", "relationships_payer_plan_period_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_"], "unique_id": "test.NPS_OMOP_CDM.relationships_payer_plan_period_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.830d86145b", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_payer_plan_perio_42db34d1903fc2fad1f4db0b9164f427.sql", "original_file_path": "models\\CDM\\Payer_Plan_Period\\payer_plan_period.yml", "name": "relationships_payer_plan_period_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_", "alias": "relationships_payer_plan_perio_42db34d1903fc2fad1f4db0b9164f427", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["payer_plan_period"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Payer_Plan_Period\\payer_plan_period.yml\\relationships_payer_plan_perio_42db34d1903fc2fad1f4db0b9164f427.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_payer_plan_perio_42db34d1903fc2fad1f4db0b9164f427"}, "created_at": 1651482438.7293942, "compiled_sql": "\n    \n    \n\nwith child as (\n    select person_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`payer_plan_period`\n    where person_id is not null\n),\n\nparent as (\n    select person_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.payer_plan_period"}, "test.NPS_OMOP_CDM.not_null_payer_plan_period_payer_plan_period_start_date.ae7d04ece1": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "payer_plan_period_start_date", "model": "{{ get_where_subquery(ref('payer_plan_period')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.payer_plan_period"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Payer_Plan_Period", "not_null_payer_plan_period_payer_plan_period_start_date"], "unique_id": "test.NPS_OMOP_CDM.not_null_payer_plan_period_payer_plan_period_start_date.ae7d04ece1", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_payer_plan_period_payer_plan_period_start_date.sql", "original_file_path": "models\\CDM\\Payer_Plan_Period\\payer_plan_period.yml", "name": "not_null_payer_plan_period_payer_plan_period_start_date", "alias": "not_null_payer_plan_period_payer_plan_period_start_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["payer_plan_period"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Payer_Plan_Period\\payer_plan_period.yml\\not_null_payer_plan_period_payer_plan_period_start_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.7373736, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`payer_plan_period`\nwhere payer_plan_period_start_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "payer_plan_period_start_date", "file_key_name": "models.payer_plan_period"}, "test.NPS_OMOP_CDM.not_null_payer_plan_period_payer_plan_period_end_date.1ee2bdf9bb": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "payer_plan_period_end_date", "model": "{{ get_where_subquery(ref('payer_plan_period')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.payer_plan_period"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Payer_Plan_Period", "not_null_payer_plan_period_payer_plan_period_end_date"], "unique_id": "test.NPS_OMOP_CDM.not_null_payer_plan_period_payer_plan_period_end_date.1ee2bdf9bb", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_payer_plan_period_payer_plan_period_end_date.sql", "original_file_path": "models\\CDM\\Payer_Plan_Period\\payer_plan_period.yml", "name": "not_null_payer_plan_period_payer_plan_period_end_date", "alias": "not_null_payer_plan_period_payer_plan_period_end_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["payer_plan_period"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Payer_Plan_Period\\payer_plan_period.yml\\not_null_payer_plan_period_payer_plan_period_end_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.7433577, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`payer_plan_period`\nwhere payer_plan_period_end_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "payer_plan_period_end_date", "file_key_name": "models.payer_plan_period"}, "test.NPS_OMOP_CDM.unique_person_person_id.ee18b5e56c": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "person_id", "model": "{{ get_where_subquery(ref('person')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.person"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Person", "unique_person_person_id"], "unique_id": "test.NPS_OMOP_CDM.unique_person_person_id.ee18b5e56c", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "unique_person_person_id.sql", "original_file_path": "models\\CDM\\Person\\person.yml", "name": "unique_person_person_id", "alias": "unique_person_person_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["person"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Person\\person.yml\\unique_person_person_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.7493408, "compiled_sql": "\n    \n    \n\nwith dbt_test__target as (\n  \n  select person_id as unique_field\n  from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n  where person_id is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.person"}, "test.NPS_OMOP_CDM.not_null_person_person_id.6f9ab4b4de": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "person_id", "model": "{{ get_where_subquery(ref('person')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.person"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Person", "not_null_person_person_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_person_person_id.6f9ab4b4de", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_person_person_id.sql", "original_file_path": "models\\CDM\\Person\\person.yml", "name": "not_null_person_person_id", "alias": "not_null_person_person_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["person"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Person\\person.yml\\not_null_person_person_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.7503371, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\nwhere person_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.person"}, "test.NPS_OMOP_CDM.not_null_person_gender_concept_id.a1409c1a02": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "gender_concept_id", "model": "{{ get_where_subquery(ref('person')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.person"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Person", "not_null_person_gender_concept_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_person_gender_concept_id.a1409c1a02", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_person_gender_concept_id.sql", "original_file_path": "models\\CDM\\Person\\person.yml", "name": "not_null_person_gender_concept_id", "alias": "not_null_person_gender_concept_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["person"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Person\\person.yml\\not_null_person_gender_concept_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.7523322, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\nwhere gender_concept_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "gender_concept_id", "file_key_name": "models.person"}, "test.NPS_OMOP_CDM.not_null_person_year_of_birth.03ea95e466": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "year_of_birth", "model": "{{ get_where_subquery(ref('person')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.person"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Person", "not_null_person_year_of_birth"], "unique_id": "test.NPS_OMOP_CDM.not_null_person_year_of_birth.03ea95e466", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_person_year_of_birth.sql", "original_file_path": "models\\CDM\\Person\\person.yml", "name": "not_null_person_year_of_birth", "alias": "not_null_person_year_of_birth", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["person"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Person\\person.yml\\not_null_person_year_of_birth.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.7543268, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\nwhere year_of_birth is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "year_of_birth", "file_key_name": "models.person"}, "test.NPS_OMOP_CDM.not_null_person_race_concept_id.288243421d": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "race_concept_id", "model": "{{ get_where_subquery(ref('person')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.person"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Person", "not_null_person_race_concept_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_person_race_concept_id.288243421d", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_person_race_concept_id.sql", "original_file_path": "models\\CDM\\Person\\person.yml", "name": "not_null_person_race_concept_id", "alias": "not_null_person_race_concept_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["person"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Person\\person.yml\\not_null_person_race_concept_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.7603114, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\nwhere race_concept_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "race_concept_id", "file_key_name": "models.person"}, "test.NPS_OMOP_CDM.not_null_person_ethnicity_concept_id.e352f804af": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "ethnicity_concept_id", "model": "{{ get_where_subquery(ref('person')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.person"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Person", "not_null_person_ethnicity_concept_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_person_ethnicity_concept_id.e352f804af", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_person_ethnicity_concept_id.sql", "original_file_path": "models\\CDM\\Person\\person.yml", "name": "not_null_person_ethnicity_concept_id", "alias": "not_null_person_ethnicity_concept_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["person"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Person\\person.yml\\not_null_person_ethnicity_concept_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.7623053, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\nwhere ethnicity_concept_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "ethnicity_concept_id", "file_key_name": "models.person"}, "test.NPS_OMOP_CDM.relationships_person_location_id__location_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_location_.59c87ac44d": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_person_155b5e5a2dc575773c0f7078be878ace\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'location')", "field": "location_id", "column_name": "location_id", "model": "{{ get_where_subquery(ref('person')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.location", "model.NPS_OMOP_CDM.person"]}, "config": {"enabled": true, "alias": "relationships_person_155b5e5a2dc575773c0f7078be878ace", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Person", "relationships_person_location_id__location_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_location_"], "unique_id": "test.NPS_OMOP_CDM.relationships_person_location_id__location_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_location_.59c87ac44d", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_person_155b5e5a2dc575773c0f7078be878ace.sql", "original_file_path": "models\\CDM\\Person\\person.yml", "name": "relationships_person_location_id__location_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_location_", "alias": "relationships_person_155b5e5a2dc575773c0f7078be878ace", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["person"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "location"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Person\\person.yml\\relationships_person_155b5e5a2dc575773c0f7078be878ace.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_person_155b5e5a2dc575773c0f7078be878ace"}, "created_at": 1651482438.7642996, "compiled_sql": "\n    \n    \n\nwith child as (\n    select location_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n    where location_id is not null\n),\n\nparent as (\n    select location_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "location_id", "file_key_name": "models.person"}, "test.NPS_OMOP_CDM.relationships_person_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.a9a9fa604b": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_person_c5ec5b63f2acb44cbcb1d6707c9b9eda\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'care_site')", "field": "care_site_id", "column_name": "care_site_id", "model": "{{ get_where_subquery(ref('person')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site", "model.NPS_OMOP_CDM.person"]}, "config": {"enabled": true, "alias": "relationships_person_c5ec5b63f2acb44cbcb1d6707c9b9eda", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Person", "relationships_person_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_"], "unique_id": "test.NPS_OMOP_CDM.relationships_person_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.a9a9fa604b", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_person_c5ec5b63f2acb44cbcb1d6707c9b9eda.sql", "original_file_path": "models\\CDM\\Person\\person.yml", "name": "relationships_person_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_", "alias": "relationships_person_c5ec5b63f2acb44cbcb1d6707c9b9eda", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["person"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "care_site"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Person\\person.yml\\relationships_person_c5ec5b63f2acb44cbcb1d6707c9b9eda.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_person_c5ec5b63f2acb44cbcb1d6707c9b9eda"}, "created_at": 1651482438.7762804, "compiled_sql": "\n    \n    \n\nwith child as (\n    select care_site_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n    where care_site_id is not null\n),\n\nparent as (\n    select care_site_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`care_site`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "care_site_id", "file_key_name": "models.person"}, "test.NPS_OMOP_CDM.not_null_procedure_occurrence_procedure_occurrence_id.e3b1d90a98": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "procedure_occurrence_id", "model": "{{ get_where_subquery(ref('procedure_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.procedure_occurrence"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Procedure_Occurrence", "not_null_procedure_occurrence_procedure_occurrence_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_procedure_occurrence_procedure_occurrence_id.e3b1d90a98", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_procedure_occurrence_procedure_occurrence_id.sql", "original_file_path": "models\\CDM\\Procedure_Occurrence\\procedure_occurrence.yml", "name": "not_null_procedure_occurrence_procedure_occurrence_id", "alias": "not_null_procedure_occurrence_procedure_occurrence_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["procedure_occurrence"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Procedure_Occurrence\\procedure_occurrence.yml\\not_null_procedure_occurrence_procedure_occurrence_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.7852442, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`procedure_occurrence`\nwhere procedure_occurrence_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "procedure_occurrence_id", "file_key_name": "models.procedure_occurrence"}, "test.NPS_OMOP_CDM.unique_procedure_occurrence_procedure_occurrence_id.fb0663ac66": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "procedure_occurrence_id", "model": "{{ get_where_subquery(ref('procedure_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.procedure_occurrence"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Procedure_Occurrence", "unique_procedure_occurrence_procedure_occurrence_id"], "unique_id": "test.NPS_OMOP_CDM.unique_procedure_occurrence_procedure_occurrence_id.fb0663ac66", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "unique_procedure_occurrence_procedure_occurrence_id.sql", "original_file_path": "models\\CDM\\Procedure_Occurrence\\procedure_occurrence.yml", "name": "unique_procedure_occurrence_procedure_occurrence_id", "alias": "unique_procedure_occurrence_procedure_occurrence_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["procedure_occurrence"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Procedure_Occurrence\\procedure_occurrence.yml\\unique_procedure_occurrence_procedure_occurrence_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.7872388, "compiled_sql": "\n    \n    \n\nwith dbt_test__target as (\n  \n  select procedure_occurrence_id as unique_field\n  from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`procedure_occurrence`\n  where procedure_occurrence_id is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "procedure_occurrence_id", "file_key_name": "models.procedure_occurrence"}, "test.NPS_OMOP_CDM.not_null_procedure_occurrence_person_id.95f33a8709": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "person_id", "model": "{{ get_where_subquery(ref('procedure_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.procedure_occurrence"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Procedure_Occurrence", "not_null_procedure_occurrence_person_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_procedure_occurrence_person_id.95f33a8709", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_procedure_occurrence_person_id.sql", "original_file_path": "models\\CDM\\Procedure_Occurrence\\procedure_occurrence.yml", "name": "not_null_procedure_occurrence_person_id", "alias": "not_null_procedure_occurrence_person_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["procedure_occurrence"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Procedure_Occurrence\\procedure_occurrence.yml\\not_null_procedure_occurrence_person_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.7932234, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`procedure_occurrence`\nwhere person_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.procedure_occurrence"}, "test.NPS_OMOP_CDM.relationships_procedure_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.50cfd5655b": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_procedure_occurr_bc073af2c57ed1570195a12f5c4c1756\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person')", "field": "person_id", "column_name": "person_id", "model": "{{ get_where_subquery(ref('procedure_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.procedure_occurrence"]}, "config": {"enabled": true, "alias": "relationships_procedure_occurr_bc073af2c57ed1570195a12f5c4c1756", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Procedure_Occurrence", "relationships_procedure_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_"], "unique_id": "test.NPS_OMOP_CDM.relationships_procedure_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.50cfd5655b", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_procedure_occurr_bc073af2c57ed1570195a12f5c4c1756.sql", "original_file_path": "models\\CDM\\Procedure_Occurrence\\procedure_occurrence.yml", "name": "relationships_procedure_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_", "alias": "relationships_procedure_occurr_bc073af2c57ed1570195a12f5c4c1756", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["procedure_occurrence"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Procedure_Occurrence\\procedure_occurrence.yml\\relationships_procedure_occurr_bc073af2c57ed1570195a12f5c4c1756.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_procedure_occurr_bc073af2c57ed1570195a12f5c4c1756"}, "created_at": 1651482438.7952178, "compiled_sql": "\n    \n    \n\nwith child as (\n    select person_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`procedure_occurrence`\n    where person_id is not null\n),\n\nparent as (\n    select person_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.procedure_occurrence"}, "test.NPS_OMOP_CDM.relationships_procedure_occurrence_visit_occurrence_id__visit_occurrence_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_visit_occurrence_.d81511cbb6": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_procedure_occurr_3c244381a42da4fa8808cfef8d647e19\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'visit_occurrence')", "field": "visit_occurrence_id", "column_name": "visit_occurrence_id", "model": "{{ get_where_subquery(ref('procedure_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence", "model.NPS_OMOP_CDM.procedure_occurrence"]}, "config": {"enabled": true, "alias": "relationships_procedure_occurr_3c244381a42da4fa8808cfef8d647e19", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Procedure_Occurrence", "relationships_procedure_occurrence_visit_occurrence_id__visit_occurrence_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_visit_occurrence_"], "unique_id": "test.NPS_OMOP_CDM.relationships_procedure_occurrence_visit_occurrence_id__visit_occurrence_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_visit_occurrence_.d81511cbb6", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_procedure_occurr_3c244381a42da4fa8808cfef8d647e19.sql", "original_file_path": "models\\CDM\\Procedure_Occurrence\\procedure_occurrence.yml", "name": "relationships_procedure_occurrence_visit_occurrence_id__visit_occurrence_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_visit_occurrence_", "alias": "relationships_procedure_occurr_3c244381a42da4fa8808cfef8d647e19", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["procedure_occurrence"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "visit_occurrence"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Procedure_Occurrence\\procedure_occurrence.yml\\relationships_procedure_occurr_3c244381a42da4fa8808cfef8d647e19.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_procedure_occurr_3c244381a42da4fa8808cfef8d647e19"}, "created_at": 1651482438.8021984, "compiled_sql": "\n    \n    \n\nwith child as (\n    select visit_occurrence_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`procedure_occurrence`\n    where visit_occurrence_id is not null\n),\n\nparent as (\n    select visit_occurrence_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`visit_occurrence`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "visit_occurrence_id", "file_key_name": "models.procedure_occurrence"}, "test.NPS_OMOP_CDM.not_null_procedure_occurrence_procedure_date.7e26c7adde": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "procedure_date", "model": "{{ get_where_subquery(ref('procedure_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.procedure_occurrence"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Procedure_Occurrence", "not_null_procedure_occurrence_procedure_date"], "unique_id": "test.NPS_OMOP_CDM.not_null_procedure_occurrence_procedure_date.7e26c7adde", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_procedure_occurrence_procedure_date.sql", "original_file_path": "models\\CDM\\Procedure_Occurrence\\procedure_occurrence.yml", "name": "not_null_procedure_occurrence_procedure_date", "alias": "not_null_procedure_occurrence_procedure_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["procedure_occurrence"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Procedure_Occurrence\\procedure_occurrence.yml\\not_null_procedure_occurrence_procedure_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.810177, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`procedure_occurrence`\nwhere procedure_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "procedure_date", "file_key_name": "models.procedure_occurrence"}, "test.NPS_OMOP_CDM.not_null_provider_provider_id.3b46670424": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "provider_id", "model": "{{ get_where_subquery(ref('provider')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.provider"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Provider", "not_null_provider_provider_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_provider_provider_id.3b46670424", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_provider_provider_id.sql", "original_file_path": "models\\CDM\\Provider\\provider.yml", "name": "not_null_provider_provider_id", "alias": "not_null_provider_provider_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["provider"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Provider\\provider.yml\\not_null_provider_provider_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.814166, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`provider`\nwhere provider_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "provider_id", "file_key_name": "models.provider"}, "test.NPS_OMOP_CDM.unique_provider_provider_id.b08928e435": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "provider_id", "model": "{{ get_where_subquery(ref('provider')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.provider"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Provider", "unique_provider_provider_id"], "unique_id": "test.NPS_OMOP_CDM.unique_provider_provider_id.b08928e435", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "unique_provider_provider_id.sql", "original_file_path": "models\\CDM\\Provider\\provider.yml", "name": "unique_provider_provider_id", "alias": "unique_provider_provider_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["provider"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Provider\\provider.yml\\unique_provider_provider_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.8151634, "compiled_sql": "\n    \n    \n\nwith dbt_test__target as (\n  \n  select provider_id as unique_field\n  from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`provider`\n  where provider_id is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "provider_id", "file_key_name": "models.provider"}, "test.NPS_OMOP_CDM.relationships_provider_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.b35a07c9f4": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_provider_41d1f991cddaf2e42b61da28ccf06bcf\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'care_site')", "field": "care_site_id", "column_name": "care_site_id", "model": "{{ get_where_subquery(ref('provider')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site", "model.NPS_OMOP_CDM.provider"]}, "config": {"enabled": true, "alias": "relationships_provider_41d1f991cddaf2e42b61da28ccf06bcf", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Provider", "relationships_provider_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_"], "unique_id": "test.NPS_OMOP_CDM.relationships_provider_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.b35a07c9f4", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_provider_41d1f991cddaf2e42b61da28ccf06bcf.sql", "original_file_path": "models\\CDM\\Provider\\provider.yml", "name": "relationships_provider_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_", "alias": "relationships_provider_41d1f991cddaf2e42b61da28ccf06bcf", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["provider"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "care_site"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Provider\\provider.yml\\relationships_provider_41d1f991cddaf2e42b61da28ccf06bcf.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_provider_41d1f991cddaf2e42b61da28ccf06bcf"}, "created_at": 1651482438.8171582, "compiled_sql": "\n    \n    \n\nwith child as (\n    select care_site_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`provider`\n    where care_site_id is not null\n),\n\nparent as (\n    select care_site_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`care_site`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "care_site_id", "file_key_name": "models.provider"}, "test.NPS_OMOP_CDM.unique_postcode_data_id.1d1de585bd": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "id", "model": "{{ get_where_subquery(ref('postcode_data')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["seed.NPS_OMOP_CDM.postcode_data"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "unique_postcode_data_id"], "unique_id": "test.NPS_OMOP_CDM.unique_postcode_data_id.1d1de585bd", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "unique_postcode_data_id.sql", "original_file_path": "seeds\\postcode_data.yml", "name": "unique_postcode_data_id", "alias": "unique_postcode_data_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["postcode_data"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\seeds\\postcode_data.yml\\unique_postcode_data_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.881985, "compiled_sql": "\n    \n    \n\nwith dbt_test__target as (\n  \n  select id as unique_field\n  from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP_SEEDS_ONLY`.`postcode_data`\n  where id is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "id", "file_key_name": "seeds.postcode_data"}, "test.NPS_OMOP_CDM.not_null_postcode_data_id.f82d87e983": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "id", "model": "{{ get_where_subquery(ref('postcode_data')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["seed.NPS_OMOP_CDM.postcode_data"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "not_null_postcode_data_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_postcode_data_id.f82d87e983", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_postcode_data_id.sql", "original_file_path": "seeds\\postcode_data.yml", "name": "not_null_postcode_data_id", "alias": "not_null_postcode_data_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["postcode_data"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\seeds\\postcode_data.yml\\not_null_postcode_data_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.8839798, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP_SEEDS_ONLY`.`postcode_data`\nwhere id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "id", "file_key_name": "seeds.postcode_data"}, "test.NPS_OMOP_CDM.not_null_postcode_data_postcode.c435345986": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "postcode", "model": "{{ get_where_subquery(ref('postcode_data')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["seed.NPS_OMOP_CDM.postcode_data"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "not_null_postcode_data_postcode"], "unique_id": "test.NPS_OMOP_CDM.not_null_postcode_data_postcode.c435345986", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_postcode_data_postcode.sql", "original_file_path": "seeds\\postcode_data.yml", "name": "not_null_postcode_data_postcode", "alias": "not_null_postcode_data_postcode", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["postcode_data"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\seeds\\postcode_data.yml\\not_null_postcode_data_postcode.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651482438.8859746, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP_SEEDS_ONLY`.`postcode_data`\nwhere postcode is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "postcode", "file_key_name": "seeds.postcode_data"}, "model.NPS_OMOP_CDM.death": {"raw_sql": "WITH patient AS (\n    SELECT *\n    FROM {{ ref('stg_death_patient')}} WHERE  DECEASED_INDICATOR = \"Deceased\"\n),\n\nperson AS (\n    SELECT *\n    FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person') }}\n),\n\nvisit_occurrence AS (\n    SELECT *\n    FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'visit_occurrence') }}\n),\n\nmax_visit_end_date AS (\n    SELECT vo.person_id,max(vo.visit_end_date) as visit_end_date, p.person_source_value\n    FROM visit_occurrence vo\n    INNER JOIN\n    person p\n    ON  p.person_id = vo.person_id\n    GROUP BY vo.person_id,p.person_source_value\n),\n\nintermediate_death AS(\n    SELECT \n    (SELECT person_id FROM person WHERE person_source_value = p.patient_number) AS person_id,\n    CASE\n    WHEN YEAR_OF_DEATH IS NULL THEN (SELECT visit_end_date FROM max_visit_end_date mved WHERE mved.person_source_value =  CAST(p.patient_number AS STRING))\n    ELSE CAST(CONCAT(YEAR_OF_DEATH,'-12-','31') AS DATE) END AS death_date,\n    CAST(NULL AS DATETIME) AS death_datetime,\n    0 AS death_type_concept_id,\n    0 AS cause_concept_id, \n    CAST(NULL AS STRING) AS cause_source_value,\n    0 AS cause_source_concept_id\n    FROM patient p\n)\n\nSELECT \n*\nFROM intermediate_death ORDER BY person_id", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.stg_death_patient"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "Death", "death"], "unique_id": "model.NPS_OMOP_CDM.death", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\Death\\death.sql", "original_file_path": "models\\CDM\\Death\\death.sql", "name": "death", "alias": "death", "checksum": {"name": "sha256", "checksum": "ebe38bd48cab51735299b9af348701974f469ef9b6ce5f3487dd828f966394bd"}, "tags": [], "refs": [["stg_death_patient"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "visit_occurrence"], ["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {"person_id": {"name": "person_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "death_date": {"name": "death_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\Death\\death.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Death\\death.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651484274.7250855, "compiled_sql": "WITH patient AS (\n    SELECT *\n    FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_death_patient` WHERE  DECEASED_INDICATOR = \"Deceased\"\n),\n\nperson AS (\n    SELECT *\n    FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\n\nvisit_occurrence AS (\n    SELECT *\n    FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`visit_occurrence`\n),\n\nmax_visit_end_date AS (\n    SELECT vo.person_id,max(vo.visit_end_date) as visit_end_date, p.person_source_value\n    FROM visit_occurrence vo\n    INNER JOIN\n    person p\n    ON  p.person_id = vo.person_id\n    GROUP BY vo.person_id,p.person_source_value\n),\n\nintermediate_death AS(\n    SELECT \n    (SELECT person_id FROM person WHERE person_source_value = p.patient_number) AS person_id,\n    CASE\n    WHEN YEAR_OF_DEATH IS NULL THEN (SELECT visit_end_date FROM max_visit_end_date mved WHERE mved.person_source_value =  CAST(p.patient_number AS STRING))\n    ELSE CAST(CONCAT(YEAR_OF_DEATH,'-12-','31') AS DATE) END AS death_date,\n    CAST(NULL AS DATETIME) AS death_datetime,\n    0 AS death_type_concept_id,\n    0 AS cause_concept_id, \n    CAST(NULL AS STRING) AS cause_source_value,\n    0 AS cause_source_concept_id\n    FROM patient p\n)\n\nSELECT \n*\nFROM intermediate_death ORDER BY person_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`death`"}, "test.NPS_OMOP_CDM.unique_death_person_id.bf3e007a4d": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "person_id", "model": "{{ get_where_subquery(ref('death')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.death"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Death", "unique_death_person_id"], "unique_id": "test.NPS_OMOP_CDM.unique_death_person_id.bf3e007a4d", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "unique_death_person_id.sql", "original_file_path": "models\\CDM\\Death\\death.yml", "name": "unique_death_person_id", "alias": "unique_death_person_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["death"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Death\\death.yml\\unique_death_person_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651484274.733064, "compiled_sql": "\n    \n    \n\nwith dbt_test__target as (\n  \n  select person_id as unique_field\n  from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`death`\n  where person_id is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.death"}, "test.NPS_OMOP_CDM.not_null_death_person_id.05e446446c": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "person_id", "model": "{{ get_where_subquery(ref('death')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.death"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Death", "not_null_death_person_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_death_person_id.05e446446c", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_death_person_id.sql", "original_file_path": "models\\CDM\\Death\\death.yml", "name": "not_null_death_person_id", "alias": "not_null_death_person_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["death"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Death\\death.yml\\not_null_death_person_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651484274.7350588, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`death`\nwhere person_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.death"}, "test.NPS_OMOP_CDM.relationships_death_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.4e266aefbe": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_death_07f51d6901f45e63cd174c0e42891b7e\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person')", "field": "person_id", "column_name": "person_id", "model": "{{ get_where_subquery(ref('death')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.death"]}, "config": {"enabled": true, "alias": "relationships_death_07f51d6901f45e63cd174c0e42891b7e", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Death", "relationships_death_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_"], "unique_id": "test.NPS_OMOP_CDM.relationships_death_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.4e266aefbe", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_death_07f51d6901f45e63cd174c0e42891b7e.sql", "original_file_path": "models\\CDM\\Death\\death.yml", "name": "relationships_death_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_", "alias": "relationships_death_07f51d6901f45e63cd174c0e42891b7e", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["death"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Death\\death.yml\\relationships_death_07f51d6901f45e63cd174c0e42891b7e.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_death_07f51d6901f45e63cd174c0e42891b7e"}, "created_at": 1651484274.7360563, "compiled_sql": "\n    \n    \n\nwith child as (\n    select person_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`death`\n    where person_id is not null\n),\n\nparent as (\n    select person_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.death"}, "test.NPS_OMOP_CDM.not_null_death_death_date.7d86f6855c": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "death_date", "model": "{{ get_where_subquery(ref('death')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.death"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Death", "not_null_death_death_date"], "unique_id": "test.NPS_OMOP_CDM.not_null_death_death_date.7d86f6855c", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_death_death_date.sql", "original_file_path": "models\\CDM\\Death\\death.yml", "name": "not_null_death_death_date", "alias": "not_null_death_death_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["death"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Death\\death.yml\\not_null_death_death_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651484274.7480242, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`death`\nwhere death_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "death_date", "file_key_name": "models.death"}, "model.NPS_OMOP_CDM.location": {"raw_sql": "{% set states = {\r\n    \"NSW\": \"NS\",  \r\n    \"ACT\":\"CT\",\r\n    \"QLD\":\"QL\",\r\n    \"TAS\":\"TS\",\r\n    \"VIC\":\"VI\"\r\n} %}\r\n\r\nwith postcode_data AS (\r\n    SELECT * FROM {{ ref('postcode_data')}}\r\n),\r\n\r\npatient AS (\r\n    SELECT * FROM {{ ref('stg_location_patient')}}\r\n),\r\n\r\npostcode AS (\r\n    SELECT * FROM {{ ref('stg_location_postcode')}}\r\n),\r\n\r\nprimary_health_network AS (\r\n    SELECT * FROM {{ ref('stg_location_primary_health_network')}}\r\n),\r\n\r\nsite AS (\r\n    SELECT * FROM {{ ref('stg_location_site')}}\r\n),\r\n\r\npractice_recruitment AS (\r\n    SELECT * FROM {{ ref('stg_location_practice_recruitment')}}\r\n),\r\n\r\nintermediate_location AS\r\n(\r\nSELECT pr.PRACTICE_ADDRESS_STREET1 AS address_1, pr.PRACTICE_ADDRESS_STREET2 AS address_2, NULL AS city, \r\n(case\r\n    {% for key, value in states.items() %}\r\n    when pr.PRACTICE_STATE = \"{{key}}\" then \"{{value}}\"  \r\n    {% endfor %}\r\n    else pr.PRACTICE_STATE end \r\n) AS state,\r\npr.PRACTICE_POSTCODE AS zip, NULL AS county, \r\nSUBSTRING({{ safe_concat(['pr.PRACTICE_ADDRESS_STREET1','pr.PRACTICE_ADDRESS_STREET2','pr.PRACTICE_STATE','pr.PRACTICE_POSTCODE']) }}, 1, 50) AS location_source_value\r\nFROM practice_recruitment pr \r\n\r\nUNION DISTINCT \r\n\r\nSELECT s.SITE_ADDRESS AS address_1, NULL AS address_2, NULL AS city, \r\n(case\r\n    {% for key, value in states.items() %}\r\n    when s.STATE = \"{{key}}\" then \"{{value}}\"  \r\n    {% endfor %}\r\n    else s.STATE end \r\n) AS state, \r\nCAST(s.POSTCODE_ORIGINAL AS STRING) AS zip, NULL AS county,\r\nSUBSTRING({{ safe_concat(['s.SITE_ADDRESS','s.STATE','s.POSTCODE_ORIGINAL']) }}, 1, 50) AS location_source_value\r\nFROM site  s\r\n\r\nUNION DISTINCT\r\n\r\nSELECT NULL AS address_1, NULL AS address_2, pc.SA2_NAME_2016  AS city, \r\nNULL AS state, CAST(pc.POSTCODE_2019 AS STRING) AS zip,NULL AS county, \r\nSUBSTRING({{ safe_concat(['pc.SA2_NAME_2016','pc.POSTCODE_2019']) }}, 1, 50) AS location_source_value\r\nFROM postcode pc\r\n\r\nUNION DISTINCT\r\n\r\nSELECT NULL AS address_1, NULL AS address_2,p.patient_city AS city, \r\nNULL AS state, p.patient_postcode AS zip,NULL AS county, \r\nSUBSTRING({{ safe_concat(['p.patient_city','p.patient_postcode']) }}, 1, 50) AS location_source_value\r\nFROM patient p\r\n\r\nUNION DISTINCT\r\n\r\nSELECT NULL AS address_1, NULL AS address_2, NULL AS city, NULL AS state, \r\nCAST(p.site_postcode AS STRING) AS zip,NULL AS county, CAST(p.site_postcode AS STRING) AS location_source_value\r\nFROM patient p \r\n\r\nUNION DISTINCT\r\n\r\nSELECT NULL AS address_1, NULL AS address_2, NULL AS city, NULL AS state, NULL AS zip,\r\nSUBSTRING(phn.PHN_NAME_2017,1,20) AS county, SUBSTRING(phn.PHN_NAME_2017 , 1, 50) AS location_source_value\r\nFROM primary_health_network phn\r\n)\r\n\r\nSELECT ROW_NUMBER() OVER(ORDER BY zip ASC) AS location_id,\r\naddress_1, \r\naddress_2,\r\ncity,\r\nstate,\r\nCASE WHEN EXISTS \r\n(SELECT postcode FROM postcode_data WHERE CAST(postcode AS STRING) = intermediate_location.zip) \r\nTHEN zip ELSE NULL END AS zip,\r\ncounty,\r\nlocation_source_value,\r\n0 AS country_concept_id,\r\nCAST(NULL AS STRING) AS country_source_value, \r\nCAST(NULL AS FLOAT64) AS latitude, \r\nCAST(NULL AS FLOAT64) AS longitude FROM intermediate_location \r\nWHERE location_source_value IS NOT NULL AND location_source_value <> \"\"\r\nORDER BY location_id", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.NPS_OMOP_CDM.safe_concat"], "nodes": ["seed.NPS_OMOP_CDM.postcode_data", "model.NPS_OMOP_CDM.stg_location_patient", "model.NPS_OMOP_CDM.stg_location_postcode", "model.NPS_OMOP_CDM.stg_location_primary_health_network", "model.NPS_OMOP_CDM.stg_location_site", "model.NPS_OMOP_CDM.stg_location_practice_recruitment"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "Location", "location"], "unique_id": "model.NPS_OMOP_CDM.location", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\Location\\location.sql", "original_file_path": "models\\CDM\\Location\\location.sql", "name": "location", "alias": "location", "checksum": {"name": "sha256", "checksum": "42752258d1e53d2fbd236655708046ed7e3a37106ea7cf4b9660c7f3e645bd97"}, "tags": [], "refs": [["postcode_data"], ["stg_location_patient"], ["stg_location_postcode"], ["stg_location_primary_health_network"], ["stg_location_site"], ["stg_location_practice_recruitment"]], "sources": [], "description": "", "columns": {"location_id": {"name": "location_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "state": {"name": "state", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\Location\\location.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Location\\location.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651490924.2371433, "compiled_sql": "\n\nwith postcode_data AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP_SEEDS_ONLY`.`postcode_data`\n),\n\npatient AS (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_location_patient`\n),\n\npostcode AS (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_location_postcode`\n),\n\nprimary_health_network AS (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_location_primary_health_network`\n),\n\nsite AS (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_location_site`\n),\n\npractice_recruitment AS (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_location_practice_recruitment`\n),\n\nintermediate_location AS\n(\nSELECT pr.PRACTICE_ADDRESS_STREET1 AS address_1, pr.PRACTICE_ADDRESS_STREET2 AS address_2, NULL AS city, \n(case\n    \n    when pr.PRACTICE_STATE = \"NSW\" then \"NS\"  \n    \n    when pr.PRACTICE_STATE = \"ACT\" then \"CT\"  \n    \n    when pr.PRACTICE_STATE = \"QLD\" then \"QL\"  \n    \n    when pr.PRACTICE_STATE = \"TAS\" then \"TS\"  \n    \n    when pr.PRACTICE_STATE = \"VIC\" then \"VI\"  \n    \n    else pr.PRACTICE_STATE end \n) AS state,\npr.PRACTICE_POSTCODE AS zip, NULL AS county, \nSUBSTRING(\n  \n\n  RTRIM(CONCAT(\n    case when pr.PRACTICE_ADDRESS_STREET1 is null then \"\" \n     \n    else concat(CAST(pr.PRACTICE_ADDRESS_STREET1 AS STRING),\"_\") end, \n    \n  \n    case when pr.PRACTICE_ADDRESS_STREET2 is null then \"\" \n     \n    else concat(CAST(pr.PRACTICE_ADDRESS_STREET2 AS STRING),\"_\") end, \n    \n  \n    case when pr.PRACTICE_STATE is null then \"\" \n     \n    else concat(CAST(pr.PRACTICE_STATE AS STRING),\"_\") end, \n    \n  \n    case when pr.PRACTICE_POSTCODE is null then \"\" \n    \n    else CAST(pr.PRACTICE_POSTCODE AS STRING) end\n    \n  ), '_')\n, 1, 50) AS location_source_value\nFROM practice_recruitment pr \n\nUNION DISTINCT \n\nSELECT s.SITE_ADDRESS AS address_1, NULL AS address_2, NULL AS city, \n(case\n    \n    when s.STATE = \"NSW\" then \"NS\"  \n    \n    when s.STATE = \"ACT\" then \"CT\"  \n    \n    when s.STATE = \"QLD\" then \"QL\"  \n    \n    when s.STATE = \"TAS\" then \"TS\"  \n    \n    when s.STATE = \"VIC\" then \"VI\"  \n    \n    else s.STATE end \n) AS state, \nCAST(s.POSTCODE_ORIGINAL AS STRING) AS zip, NULL AS county,\nSUBSTRING(\n  \n\n  RTRIM(CONCAT(\n    case when s.SITE_ADDRESS is null then \"\" \n     \n    else concat(CAST(s.SITE_ADDRESS AS STRING),\"_\") end, \n    \n  \n    case when s.STATE is null then \"\" \n     \n    else concat(CAST(s.STATE AS STRING),\"_\") end, \n    \n  \n    case when s.POSTCODE_ORIGINAL is null then \"\" \n    \n    else CAST(s.POSTCODE_ORIGINAL AS STRING) end\n    \n  ), '_')\n, 1, 50) AS location_source_value\nFROM site  s\n\nUNION DISTINCT\n\nSELECT NULL AS address_1, NULL AS address_2, pc.SA2_NAME_2016  AS city, \nNULL AS state, CAST(pc.POSTCODE_2019 AS STRING) AS zip,NULL AS county, \nSUBSTRING(\n  \n\n  RTRIM(CONCAT(\n    case when pc.SA2_NAME_2016 is null then \"\" \n     \n    else concat(CAST(pc.SA2_NAME_2016 AS STRING),\"_\") end, \n    \n  \n    case when pc.POSTCODE_2019 is null then \"\" \n    \n    else CAST(pc.POSTCODE_2019 AS STRING) end\n    \n  ), '_')\n, 1, 50) AS location_source_value\nFROM postcode pc\n\nUNION DISTINCT\n\nSELECT NULL AS address_1, NULL AS address_2,p.patient_city AS city, \nNULL AS state, p.patient_postcode AS zip,NULL AS county, \nSUBSTRING(\n  \n\n  RTRIM(CONCAT(\n    case when p.patient_city is null then \"\" \n     \n    else concat(CAST(p.patient_city AS STRING),\"_\") end, \n    \n  \n    case when p.patient_postcode is null then \"\" \n    \n    else CAST(p.patient_postcode AS STRING) end\n    \n  ), '_')\n, 1, 50) AS location_source_value\nFROM patient p\n\nUNION DISTINCT\n\nSELECT NULL AS address_1, NULL AS address_2, NULL AS city, NULL AS state, \nCAST(p.site_postcode AS STRING) AS zip,NULL AS county, CAST(p.site_postcode AS STRING) AS location_source_value\nFROM patient p \n\nUNION DISTINCT\n\nSELECT NULL AS address_1, NULL AS address_2, NULL AS city, NULL AS state, NULL AS zip,\nSUBSTRING(phn.PHN_NAME_2017,1,20) AS county, SUBSTRING(phn.PHN_NAME_2017 , 1, 50) AS location_source_value\nFROM primary_health_network phn\n)\n\nSELECT ROW_NUMBER() OVER(ORDER BY zip ASC) AS location_id,\naddress_1, \naddress_2,\ncity,\nstate,\nCASE WHEN EXISTS \n(SELECT postcode FROM postcode_data WHERE CAST(postcode AS STRING) = intermediate_location.zip) \nTHEN zip ELSE NULL END AS zip,\ncounty,\nlocation_source_value,\n0 AS country_concept_id,\nCAST(NULL AS STRING) AS country_source_value, \nCAST(NULL AS FLOAT64) AS latitude, \nCAST(NULL AS FLOAT64) AS longitude FROM intermediate_location \nWHERE location_source_value IS NOT NULL AND location_source_value <> \"\"\nORDER BY location_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`location`"}, "test.NPS_OMOP_CDM.not_null_location_location_id.af91958747": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "location_id", "model": "{{ get_where_subquery(ref('location')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.location"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Location", "not_null_location_location_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_location_location_id.af91958747", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_location_location_id.sql", "original_file_path": "models\\CDM\\Location\\location.yml", "name": "not_null_location_location_id", "alias": "not_null_location_location_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["location"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Location\\location.yml\\not_null_location_location_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651490924.2481136, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`location`\nwhere location_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "location_id", "file_key_name": "models.location"}, "test.NPS_OMOP_CDM.unique_location_location_id.e30ffdeb77": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "location_id", "model": "{{ get_where_subquery(ref('location')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.location"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Location", "unique_location_location_id"], "unique_id": "test.NPS_OMOP_CDM.unique_location_location_id.e30ffdeb77", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "unique_location_location_id.sql", "original_file_path": "models\\CDM\\Location\\location.yml", "name": "unique_location_location_id", "alias": "unique_location_location_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["location"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Location\\location.yml\\unique_location_location_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651490924.251106, "compiled_sql": "\n    \n    \n\nwith dbt_test__target as (\n  \n  select location_id as unique_field\n  from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`location`\n  where location_id is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "location_id", "file_key_name": "models.location"}, "test.NPS_OMOP_CDM.accepted_values_location_state__NS__CT__QL__TS__VI__NT__SA__WA__None.8bc4117309": {"raw_sql": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_location_ff8251ae84a8be4d6e1b8e5564060cd6\") }}", "test_metadata": {"name": "accepted_values", "kwargs": {"values": ["NS", "CT", "QL", "TS", "VI", "NT", "SA", "WA", null], "column_name": "state", "model": "{{ get_where_subquery(ref('location')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.location"]}, "config": {"enabled": true, "alias": "accepted_values_location_ff8251ae84a8be4d6e1b8e5564060cd6", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Location", "accepted_values_location_state__NS__CT__QL__TS__VI__NT__SA__WA__None"], "unique_id": "test.NPS_OMOP_CDM.accepted_values_location_state__NS__CT__QL__TS__VI__NT__SA__WA__None.8bc4117309", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "accepted_values_location_ff8251ae84a8be4d6e1b8e5564060cd6.sql", "original_file_path": "models\\CDM\\Location\\location.yml", "name": "accepted_values_location_state__NS__CT__QL__TS__VI__NT__SA__WA__None", "alias": "accepted_values_location_ff8251ae84a8be4d6e1b8e5564060cd6", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["location"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Location\\location.yml\\accepted_values_location_ff8251ae84a8be4d6e1b8e5564060cd6.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "accepted_values_location_ff8251ae84a8be4d6e1b8e5564060cd6"}, "created_at": 1651490924.253101, "compiled_sql": "\n    \n    \n\nwith all_values as (\n\n    select\n        state as value_field,\n        count(*) as n_records\n\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`location`\n    group by state\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'NS','CT','QL','TS','VI','NT','SA','WA','None'\n)\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "state", "file_key_name": "models.location"}, "model.NPS_OMOP_CDM.care_site": {"raw_sql": "with site as (\r\n\r\n    SELECT \r\n    *\r\n    FROM {{ ref('stg_care_site_site')}}\r\n\r\n),\r\n\r\nlocation as (\r\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'location') }}\r\n),\r\n\r\nintermediate_care_site as (\r\nSELECT SUBSTRING(s.SITE_NAME,1,255) as care_site_name,\r\n0 as place_of_service_concept_id,\r\n(SELECT loc.location_id FROM location as loc where loc.location_source_value  = SUBSTRING({{ safe_concat(['s.SITE_ADDRESS','s.STATE','s.POSTCODE_ORIGINAL']) }}, 1, 50)) as location_id, \r\nSUBSTRING(s.SITE_ID,1,50) as care_site_source_value, \r\nCAST(NULL AS STRING) as place_of_service_source_value \r\nFROM site s\r\n)\r\n\r\nSELECT \r\nROW_NUMBER() OVER(ORDER BY care_site_name ASC) AS care_site_id,\r\ncare_site_name, \r\nplace_of_service_concept_id,\r\nlocation_id,\r\ncare_site_source_value,\r\nCAST(place_of_service_source_value AS STRING) AS place_of_service_source_value\r\nFROM intermediate_care_site ORDER BY care_site_id", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.NPS_OMOP_CDM.safe_concat"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.location", "model.NPS_OMOP_CDM.stg_care_site_site"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "Care_Site", "care_site"], "unique_id": "model.NPS_OMOP_CDM.care_site", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\Care_Site\\care_site.sql", "original_file_path": "models\\CDM\\Care_Site\\care_site.sql", "name": "care_site", "alias": "care_site", "checksum": {"name": "sha256", "checksum": "9408bfdd27732722ac29ba27e476575f1681f8bb7c6f31f324c096a364c99215"}, "tags": [], "refs": [["stg_care_site_site"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "location"]], "description": "", "columns": {"care_site_id": {"name": "care_site_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "location_id": {"name": "location_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\Care_Site\\care_site.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Care_Site\\care_site.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651564782.1480205, "compiled_sql": "with site as (\n\n    SELECT \n    *\n    FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_care_site_site`\n\n),\n\nlocation as (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`location`\n),\n\nintermediate_care_site as (\nSELECT SUBSTRING(s.SITE_NAME,1,255) as care_site_name,\n0 as place_of_service_concept_id,\n(SELECT loc.location_id FROM location as loc where loc.location_source_value  = SUBSTRING(\n  \n\n  RTRIM(CONCAT(\n    case when s.SITE_ADDRESS is null then \"\" \n     \n    else concat(CAST(s.SITE_ADDRESS AS STRING),\"_\") end, \n    \n  \n    case when s.STATE is null then \"\" \n     \n    else concat(CAST(s.STATE AS STRING),\"_\") end, \n    \n  \n    case when s.POSTCODE_ORIGINAL is null then \"\" \n    \n    else CAST(s.POSTCODE_ORIGINAL AS STRING) end\n    \n  ), '_')\n, 1, 50)) as location_id, \nSUBSTRING(s.SITE_ID,1,50) as care_site_source_value, \nCAST(NULL AS STRING) as place_of_service_source_value \nFROM site s\n)\n\nSELECT \nROW_NUMBER() OVER(ORDER BY care_site_name ASC) AS care_site_id,\ncare_site_name, \nplace_of_service_concept_id,\nlocation_id,\ncare_site_source_value,\nCAST(place_of_service_source_value AS STRING) AS place_of_service_source_value\nFROM intermediate_care_site ORDER BY care_site_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`care_site`"}, "test.NPS_OMOP_CDM.not_null_care_site_care_site_id.2d320c251b": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "care_site_id", "model": "{{ get_where_subquery(ref('care_site')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.care_site"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Care_Site", "not_null_care_site_care_site_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_care_site_care_site_id.2d320c251b", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_care_site_care_site_id.sql", "original_file_path": "models\\CDM\\Care_Site\\care_site.yml", "name": "not_null_care_site_care_site_id", "alias": "not_null_care_site_care_site_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["care_site"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Care_Site\\care_site.yml\\not_null_care_site_care_site_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651564782.155999, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`care_site`\nwhere care_site_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "care_site_id", "file_key_name": "models.care_site"}, "test.NPS_OMOP_CDM.unique_care_site_care_site_id.9f2a10fa8e": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "care_site_id", "model": "{{ get_where_subquery(ref('care_site')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.care_site"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Care_Site", "unique_care_site_care_site_id"], "unique_id": "test.NPS_OMOP_CDM.unique_care_site_care_site_id.9f2a10fa8e", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "unique_care_site_care_site_id.sql", "original_file_path": "models\\CDM\\Care_Site\\care_site.yml", "name": "unique_care_site_care_site_id", "alias": "unique_care_site_care_site_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["care_site"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Care_Site\\care_site.yml\\unique_care_site_care_site_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651564782.157994, "compiled_sql": "\n    \n    \n\nwith dbt_test__target as (\n  \n  select care_site_id as unique_field\n  from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`care_site`\n  where care_site_id is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "care_site_id", "file_key_name": "models.care_site"}, "test.NPS_OMOP_CDM.relationships_care_site_location_id__location_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_location_.edadb2302e": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_care_site_82e4937a3bd5653f4d8974e9c35c2483\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'location')", "field": "location_id", "column_name": "location_id", "model": "{{ get_where_subquery(ref('care_site')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.location", "model.NPS_OMOP_CDM.care_site"]}, "config": {"enabled": true, "alias": "relationships_care_site_82e4937a3bd5653f4d8974e9c35c2483", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Care_Site", "relationships_care_site_location_id__location_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_location_"], "unique_id": "test.NPS_OMOP_CDM.relationships_care_site_location_id__location_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_location_.edadb2302e", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_care_site_82e4937a3bd5653f4d8974e9c35c2483.sql", "original_file_path": "models\\CDM\\Care_Site\\care_site.yml", "name": "relationships_care_site_location_id__location_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_location_", "alias": "relationships_care_site_82e4937a3bd5653f4d8974e9c35c2483", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["care_site"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "location"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Care_Site\\care_site.yml\\relationships_care_site_82e4937a3bd5653f4d8974e9c35c2483.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_care_site_82e4937a3bd5653f4d8974e9c35c2483"}, "created_at": 1651564782.1589913, "compiled_sql": "\n    \n    \n\nwith child as (\n    select location_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`care_site`\n    where location_id is not null\n),\n\nparent as (\n    select location_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "location_id", "file_key_name": "models.care_site"}, "model.NPS_OMOP_CDM.condition_occurrence": {"raw_sql": "with diagnosis AS (\r\n    SELECT \r\n    *\r\n    FROM {{ ref('stg_condition_occurrence_diagnosis')}}\r\n),\r\n\r\nencounter_reason AS (\r\n    SELECT \r\n    *\r\n    FROM {{ ref('stg_condition_occurrence_encounter_reason')}}\r\n),\r\n\r\nprescription AS (\r\n    SELECT * FROM {{ ref('stg_condition_occurrence_prescription')}}\r\n),\r\n\r\nvisit_occurrence AS(\r\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'visit_occurrence') }}\r\n),\r\n\r\nperson AS(\r\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person') }}\r\n),\r\n\r\ncare_site AS(\r\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'care_site') }}\r\n),\r\n\r\nintermediate_condition_occurrence AS (\r\n\r\nSELECT \r\n(SELECT person_id FROM person AS p WHERE p.person_source_value = d.patient_number ) AS person_id,\r\nCASE\r\nWHEN diagnosis_date IS NULL THEN CAST('1800-01-01' AS DATE)\r\nELSE CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', diagnosis_date)) AS DATE) END AS condition_start_date,\r\nNULL AS condition_end_date,     \r\nNULL AS visit_occurrence_id,  \r\ndiagnosis_reason AS condition_source_value\r\nFROM diagnosis d\r\n\r\nUNION DISTINCT\r\n\r\nSELECT \r\n(SELECT person_id FROM person AS p WHERE p.person_source_value = pre.patient_number ) AS person_id, \r\nCASE\r\nWHEN first_date IS NULL THEN CAST('1800-01-01' AS DATE)\r\nELSE CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', first_date)) AS DATE) END AS condition_start_date,\r\nCAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', last_date)) AS DATE) AS condition_end_date,   \r\nNULL AS visit_occurrence_id,  \r\nreason AS condition_source_value\r\nFROM prescription pre\r\n\r\nUNION DISTINCT \r\n\r\nSELECT \r\n(SELECT person_id FROM person AS p WHERE p.person_source_value = er.patient_number ) AS person_id,\r\nCASE\r\nWHEN visit_datetime IS NULL THEN CAST('1800-01-01' AS DATE)\r\nELSE CAST(visit_datetime AS DATE) END AS condition_start_date,\r\nNULL AS condition_end_date,  \r\nNULL AS visit_occurrence_id,  \r\nencounter_reasons AS condition_source_value\r\nFROM encounter_reason er\r\n\r\n)\r\n\r\nSELECT \r\nROW_NUMBER() OVER(ORDER BY person_id ASC) AS condition_occurrence_id,\r\nperson_id,\r\n0 AS condition_concept_id,\r\ncondition_start_date,\r\nCAST(NULL AS DATETIME) AS condition_start_datetime,\r\nCAST(condition_end_date AS DATE) AS condition_end_date,\r\nCAST(NULL AS DATETIME) AS condition_end_datetime,\r\n0 AS condition_type_concept_id,\r\n0 AS condition_status_concept_id,\r\nCAST(NULL AS STRING) stop_reason,\r\nCAST(NULL AS INT64) AS provider_id,\r\nCAST(visit_occurrence_id AS INT64) AS visit_occurrence_id, \r\nCAST(NULL AS INT64) AS visit_detail_id,\r\ncondition_source_value,\r\n0 AS condition_source_concept_id,\r\nCAST(NULL AS STRING) condition_status_source_value\r\nFROM intermediate_condition_occurrence ORDER BY condition_occurrence_id", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence", "model.NPS_OMOP_CDM.stg_condition_occurrence_diagnosis", "model.NPS_OMOP_CDM.stg_condition_occurrence_encounter_reason", "model.NPS_OMOP_CDM.stg_condition_occurrence_prescription"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "Condition_Occurrence", "condition_occurrence"], "unique_id": "model.NPS_OMOP_CDM.condition_occurrence", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\Condition_Occurrence\\condition_occurrence.sql", "original_file_path": "models\\CDM\\Condition_Occurrence\\condition_occurrence.sql", "name": "condition_occurrence", "alias": "condition_occurrence", "checksum": {"name": "sha256", "checksum": "59403f854b453b76370d2c3667135662c7f7dd465ef0d0a9a443b609310cff85"}, "tags": [], "refs": [["stg_condition_occurrence_diagnosis"], ["stg_condition_occurrence_encounter_reason"], ["stg_condition_occurrence_prescription"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"], ["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "care_site"], ["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "visit_occurrence"]], "description": "", "columns": {"condition_occurrence_id": {"name": "condition_occurrence_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "person_id": {"name": "person_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "visit_occurrence_id": {"name": "visit_occurrence_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "condition_start_date": {"name": "condition_start_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\Condition_Occurrence\\condition_occurrence.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Condition_Occurrence\\condition_occurrence.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651575537.036155, "compiled_sql": "with diagnosis AS (\n    SELECT \n    *\n    FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_condition_occurrence_diagnosis`\n),\n\nencounter_reason AS (\n    SELECT \n    *\n    FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_condition_occurrence_encounter_reason`\n),\n\nprescription AS (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_condition_occurrence_prescription`\n),\n\nvisit_occurrence AS(\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`visit_occurrence`\n),\n\nperson AS(\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\n\ncare_site AS(\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`care_site`\n),\n\nintermediate_condition_occurrence AS (\n\nSELECT \n(SELECT person_id FROM person AS p WHERE p.person_source_value = d.patient_number ) AS person_id,\nCASE\nWHEN diagnosis_date IS NULL THEN CAST('1800-01-01' AS DATE)\nELSE CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', diagnosis_date)) AS DATE) END AS condition_start_date,\nNULL AS condition_end_date,     \nNULL AS visit_occurrence_id,  \ndiagnosis_reason AS condition_source_value\nFROM diagnosis d\n\nUNION DISTINCT\n\nSELECT \n(SELECT person_id FROM person AS p WHERE p.person_source_value = pre.patient_number ) AS person_id, \nCASE\nWHEN first_date IS NULL THEN CAST('1800-01-01' AS DATE)\nELSE CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', first_date)) AS DATE) END AS condition_start_date,\nCAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', last_date)) AS DATE) AS condition_end_date,   \nNULL AS visit_occurrence_id,  \nreason AS condition_source_value\nFROM prescription pre\n\nUNION DISTINCT \n\nSELECT \n(SELECT person_id FROM person AS p WHERE p.person_source_value = er.patient_number ) AS person_id,\nCASE\nWHEN visit_datetime IS NULL THEN CAST('1800-01-01' AS DATE)\nELSE CAST(visit_datetime AS DATE) END AS condition_start_date,\nNULL AS condition_end_date,  \nNULL AS visit_occurrence_id,  \nencounter_reasons AS condition_source_value\nFROM encounter_reason er\n\n)\n\nSELECT \nROW_NUMBER() OVER(ORDER BY person_id ASC) AS condition_occurrence_id,\nperson_id,\n0 AS condition_concept_id,\ncondition_start_date,\nCAST(NULL AS DATETIME) AS condition_start_datetime,\nCAST(condition_end_date AS DATE) AS condition_end_date,\nCAST(NULL AS DATETIME) AS condition_end_datetime,\n0 AS condition_type_concept_id,\n0 AS condition_status_concept_id,\nCAST(NULL AS STRING) stop_reason,\nCAST(NULL AS INT64) AS provider_id,\nCAST(visit_occurrence_id AS INT64) AS visit_occurrence_id, \nCAST(NULL AS INT64) AS visit_detail_id,\ncondition_source_value,\n0 AS condition_source_concept_id,\nCAST(NULL AS STRING) condition_status_source_value\nFROM intermediate_condition_occurrence ORDER BY condition_occurrence_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`condition_occurrence`"}, "test.NPS_OMOP_CDM.not_null_condition_occurrence_condition_occurrence_id.f70111fa08": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "condition_occurrence_id", "model": "{{ get_where_subquery(ref('condition_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.condition_occurrence"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Condition_Occurrence", "not_null_condition_occurrence_condition_occurrence_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_condition_occurrence_condition_occurrence_id.f70111fa08", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_condition_occurrence_condition_occurrence_id.sql", "original_file_path": "models\\CDM\\Condition_Occurrence\\condition_occurrence.yml", "name": "not_null_condition_occurrence_condition_occurrence_id", "alias": "not_null_condition_occurrence_condition_occurrence_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["condition_occurrence"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Condition_Occurrence\\condition_occurrence.yml\\not_null_condition_occurrence_condition_occurrence_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651575537.048127, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`condition_occurrence`\nwhere condition_occurrence_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "condition_occurrence_id", "file_key_name": "models.condition_occurrence"}, "test.NPS_OMOP_CDM.unique_condition_occurrence_condition_occurrence_id.e4cb792f90": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "condition_occurrence_id", "model": "{{ get_where_subquery(ref('condition_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.condition_occurrence"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Condition_Occurrence", "unique_condition_occurrence_condition_occurrence_id"], "unique_id": "test.NPS_OMOP_CDM.unique_condition_occurrence_condition_occurrence_id.e4cb792f90", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "unique_condition_occurrence_condition_occurrence_id.sql", "original_file_path": "models\\CDM\\Condition_Occurrence\\condition_occurrence.yml", "name": "unique_condition_occurrence_condition_occurrence_id", "alias": "unique_condition_occurrence_condition_occurrence_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["condition_occurrence"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Condition_Occurrence\\condition_occurrence.yml\\unique_condition_occurrence_condition_occurrence_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651575537.0511196, "compiled_sql": "\n    \n    \n\nwith dbt_test__target as (\n  \n  select condition_occurrence_id as unique_field\n  from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`condition_occurrence`\n  where condition_occurrence_id is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "condition_occurrence_id", "file_key_name": "models.condition_occurrence"}, "test.NPS_OMOP_CDM.not_null_condition_occurrence_person_id.9f19d9c9cb": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "person_id", "model": "{{ get_where_subquery(ref('condition_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.condition_occurrence"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Condition_Occurrence", "not_null_condition_occurrence_person_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_condition_occurrence_person_id.9f19d9c9cb", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_condition_occurrence_person_id.sql", "original_file_path": "models\\CDM\\Condition_Occurrence\\condition_occurrence.yml", "name": "not_null_condition_occurrence_person_id", "alias": "not_null_condition_occurrence_person_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["condition_occurrence"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Condition_Occurrence\\condition_occurrence.yml\\not_null_condition_occurrence_person_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651575537.0531206, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`condition_occurrence`\nwhere person_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.condition_occurrence"}, "test.NPS_OMOP_CDM.relationships_condition_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.5e206dc499": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_condition_occurr_ff1900cbb8993d256f7e9a5a1811d81c\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person')", "field": "person_id", "column_name": "person_id", "model": "{{ get_where_subquery(ref('condition_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.condition_occurrence"]}, "config": {"enabled": true, "alias": "relationships_condition_occurr_ff1900cbb8993d256f7e9a5a1811d81c", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Condition_Occurrence", "relationships_condition_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_"], "unique_id": "test.NPS_OMOP_CDM.relationships_condition_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.5e206dc499", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_condition_occurr_ff1900cbb8993d256f7e9a5a1811d81c.sql", "original_file_path": "models\\CDM\\Condition_Occurrence\\condition_occurrence.yml", "name": "relationships_condition_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_", "alias": "relationships_condition_occurr_ff1900cbb8993d256f7e9a5a1811d81c", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["condition_occurrence"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Condition_Occurrence\\condition_occurrence.yml\\relationships_condition_occurr_ff1900cbb8993d256f7e9a5a1811d81c.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_condition_occurr_ff1900cbb8993d256f7e9a5a1811d81c"}, "created_at": 1651575537.0551848, "compiled_sql": "\n    \n    \n\nwith child as (\n    select person_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`condition_occurrence`\n    where person_id is not null\n),\n\nparent as (\n    select person_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.condition_occurrence"}, "test.NPS_OMOP_CDM.relationships_condition_occurrence_visit_occurrence_id__visit_occurrence_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_visit_occurrence_.106dee8b71": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_condition_occurr_fb72a23c27d32d65b29f8f02a8d4962f\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'visit_occurrence')", "field": "visit_occurrence_id", "column_name": "visit_occurrence_id", "model": "{{ get_where_subquery(ref('condition_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence", "model.NPS_OMOP_CDM.condition_occurrence"]}, "config": {"enabled": true, "alias": "relationships_condition_occurr_fb72a23c27d32d65b29f8f02a8d4962f", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Condition_Occurrence", "relationships_condition_occurrence_visit_occurrence_id__visit_occurrence_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_visit_occurrence_"], "unique_id": "test.NPS_OMOP_CDM.relationships_condition_occurrence_visit_occurrence_id__visit_occurrence_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_visit_occurrence_.106dee8b71", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_condition_occurr_fb72a23c27d32d65b29f8f02a8d4962f.sql", "original_file_path": "models\\CDM\\Condition_Occurrence\\condition_occurrence.yml", "name": "relationships_condition_occurrence_visit_occurrence_id__visit_occurrence_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_visit_occurrence_", "alias": "relationships_condition_occurr_fb72a23c27d32d65b29f8f02a8d4962f", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["condition_occurrence"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "visit_occurrence"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Condition_Occurrence\\condition_occurrence.yml\\relationships_condition_occurr_fb72a23c27d32d65b29f8f02a8d4962f.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_condition_occurr_fb72a23c27d32d65b29f8f02a8d4962f"}, "created_at": 1651575537.0730612, "compiled_sql": "\n    \n    \n\nwith child as (\n    select visit_occurrence_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`condition_occurrence`\n    where visit_occurrence_id is not null\n),\n\nparent as (\n    select visit_occurrence_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`visit_occurrence`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "visit_occurrence_id", "file_key_name": "models.condition_occurrence"}, "test.NPS_OMOP_CDM.not_null_condition_occurrence_condition_start_date.6cbb11717a": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "condition_start_date", "model": "{{ get_where_subquery(ref('condition_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.condition_occurrence"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Condition_Occurrence", "not_null_condition_occurrence_condition_start_date"], "unique_id": "test.NPS_OMOP_CDM.not_null_condition_occurrence_condition_start_date.6cbb11717a", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_condition_occurrence_condition_start_date.sql", "original_file_path": "models\\CDM\\Condition_Occurrence\\condition_occurrence.yml", "name": "not_null_condition_occurrence_condition_start_date", "alias": "not_null_condition_occurrence_condition_start_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["condition_occurrence"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Condition_Occurrence\\condition_occurrence.yml\\not_null_condition_occurrence_condition_start_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651575537.0800421, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`condition_occurrence`\nwhere condition_start_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "condition_start_date", "file_key_name": "models.condition_occurrence"}, "model.NPS_OMOP_CDM.device_exposure": {"raw_sql": "with pathology_lipids as (\n    SELECT * FROM {{ ref('stg_device_exposure_pathology_lipids')}}\n),\n\npathology_hba1c as (\n    SELECT * FROM {{ ref('stg_device_exposure_pathology_hba1c')}}\n),\n\npathology_egfr as (\n    SELECT * FROM {{ ref('stg_device_exposure_pathology_egfr') }}\n),\n\npathology_albumin as (\n    SELECT * FROM {{ ref('stg_device_exposure_pathology_albumin') }}\n),\n\npathology as (\n    SELECT * FROM {{ ref('stg_device_exposure_pathology') }}\n),\n\npathology_result as (\n    SELECT * FROM {{ ref('stg_device_exposure_pathology_result') }}\n),\n\nimmunisation as (\n    SELECT * FROM {{ ref('stg_device_exposure_immunisation') }}\n),\n\nPerson AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person') }}\n),\n\nintermediate_device_exposure as (\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pl.patient_number\n    ) as person_id,\n    CASE WHEN pathology_test_datetime is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(pathology_test_datetime) END as device_exposure_start_date,\n    DATETIME(pathology_test_datetime) as device_exposure_start_datetime,\n    NULL as device_exposure_end_date,\n    NULL as device_exposure_end_datetime,\n    NULL as provider_id,\n    pathology_test_type as device_source_value,\n    detected_cis_unit_of_measure as unit_source_value,\n    FROM pathology_lipids pl\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = ph.patient_number\n    ) as person_id,\n    CASE WHEN pathology_test_datetime is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(pathology_test_datetime) END as device_exposure_start_date,\n    DATETIME(pathology_test_datetime) as device_exposure_start_datetime,\n    NULL as device_exposure_end_date,\n    NULL as device_exposure_end_datetime,\n    NULL as provider_id,\n    pathology_test_type as device_source_value,\n    detected_cis_unit_of_measure as unit_source_value,\n    FROM pathology_hba1c ph\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pe.patient_number\n    ) as person_id,\n    CASE WHEN pathology_test_datetime is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(pathology_test_datetime) END as device_exposure_start_date,\n    DATETIME(pathology_test_datetime) as device_exposure_start_datetime,\n    NULL as device_exposure_end_date,\n    NULL as device_exposure_end_datetime,\n    NULL as provider_id,\n    pathology_test_type as device_source_value,\n    detected_cis_unit_of_measure as unit_source_value,\n    FROM pathology_egfr pe\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pa.patient_number\n    ) as person_id,\n    CASE\n    {{ convert_datetime_string_to_date('pathology_test_datetime') }}\n    ELSE CAST('1800-01-01' AS DATE) END as device_exposure_start_date,\n    CASE \n    {{ convert_datetime_string_to_datetime('pathology_test_datetime') }}\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END as device_exposure_start_datetime,\n    NULL as device_exposure_end_date,\n    NULL as device_exposure_end_datetime,\n    NULL as provider_id,\n    pathology_test_type as device_source_value,\n    detected_cis_unit_of_measure as unit_source_value,\n    FROM pathology_albumin pa\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pat.patient_number\n    ) as person_id,\n    CASE WHEN report_date is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(report_date) END as device_exposure_start_date,\n    DATETIME(report_date) as device_exposure_start_datetime,\n    NULL as device_exposure_end_date,\n    NULL as device_exposure_end_datetime,\n    NULL as provider_id,\n    result_name as device_source_value,\n    NULL as unit_source_value,\n    FROM pathology pat\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = im.patient_number\n    ) as person_id,\n    CASE WHEN given_date is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(given_date) END as device_exposure_start_date,\n    DATETIME(given_date) as device_exposure_start_datetime,\n    given_date as device_exposure_end_date,\n    given_date as device_exposure_end_datetime,\n    NULL as provider_id,\n    vaccine_name as device_source_value,\n    NULL as unit_source_value,\n    FROM immunisation im\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pr.patient_number\n    ) as person_id,\n    CASE WHEN result_date is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(result_date) END as device_exposure_start_date,\n    DATETIME(result_date) as device_exposure_start_datetime,\n    NULL as device_exposure_end_date,\n    NULL as device_exposure_end_datetime,\n    NULL as provider_id,\n    result_name as device_source_value,\n    units as unit_source_value,\n    FROM pathology_result pr\n)\n\nSELECT \nROW_NUMBER() OVER(ORDER BY device_source_value ASC) AS device_exposure_id,\nperson_id,\n0 as device_concept_id,\ndevice_exposure_start_date,\ndevice_exposure_start_datetime,\nCAST(device_exposure_end_date AS DATE) AS device_exposure_end_date,\nCAST(device_exposure_end_datetime AS DATETIME) AS device_exposure_end_datetime,\n0 as device_type_concept_id,\nCAST(NULL AS STRING) as unique_device_id,\nCAST(NULL AS STRING) as production_id,\nNULL as quantity,\nprovider_id,\nNULL as visit_occurrence_id,\nNULL as visit_detail_id,\ndevice_source_value,\n0 as device_source_concept_id,\n0 as unit_concept_id,\nunit_source_value,\n0 as unit_source_concept_id\nFROM intermediate_device_exposure ORDER BY device_exposure_id", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.NPS_OMOP_CDM.convert_datetime_string_to_date", "macro.NPS_OMOP_CDM.convert_datetime_string_to_datetime"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.stg_device_exposure_pathology_lipids", "model.NPS_OMOP_CDM.stg_device_exposure_pathology_hba1c", "model.NPS_OMOP_CDM.stg_device_exposure_pathology_egfr", "model.NPS_OMOP_CDM.stg_device_exposure_pathology_albumin", "model.NPS_OMOP_CDM.stg_device_exposure_pathology", "model.NPS_OMOP_CDM.stg_device_exposure_pathology_result", "model.NPS_OMOP_CDM.stg_device_exposure_immunisation"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "Device_Exposure", "device_exposure"], "unique_id": "model.NPS_OMOP_CDM.device_exposure", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\Device_Exposure\\device_exposure.sql", "original_file_path": "models\\CDM\\Device_Exposure\\device_exposure.sql", "name": "device_exposure", "alias": "device_exposure", "checksum": {"name": "sha256", "checksum": "87aab7d376e934a87f0b726c8e530cd0c41e57e664b87ebab49d62d02f04268c"}, "tags": [], "refs": [["stg_device_exposure_pathology_lipids"], ["stg_device_exposure_pathology_hba1c"], ["stg_device_exposure_pathology_egfr"], ["stg_device_exposure_pathology_albumin"], ["stg_device_exposure_pathology"], ["stg_device_exposure_pathology_result"], ["stg_device_exposure_immunisation"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {"device_exposure_id": {"name": "device_exposure_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "person_id": {"name": "person_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "device_exposure_start_date": {"name": "device_exposure_start_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "device_concept_id": {"name": "device_concept_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\Device_Exposure\\device_exposure.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Device_Exposure\\device_exposure.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651587190.9708445, "compiled_sql": "with pathology_lipids as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_device_exposure_pathology_lipids`\n),\n\npathology_hba1c as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_device_exposure_pathology_hba1c`\n),\n\npathology_egfr as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_device_exposure_pathology_egfr`\n),\n\npathology_albumin as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_device_exposure_pathology_albumin`\n),\n\npathology as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_device_exposure_pathology`\n),\n\npathology_result as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_device_exposure_pathology_result`\n),\n\nimmunisation as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_device_exposure_immunisation`\n),\n\nPerson AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\n\nintermediate_device_exposure as (\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pl.patient_number\n    ) as person_id,\n    CASE WHEN pathology_test_datetime is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(pathology_test_datetime) END as device_exposure_start_date,\n    DATETIME(pathology_test_datetime) as device_exposure_start_datetime,\n    NULL as device_exposure_end_date,\n    NULL as device_exposure_end_datetime,\n    NULL as provider_id,\n    pathology_test_type as device_source_value,\n    detected_cis_unit_of_measure as unit_source_value,\n    FROM pathology_lipids pl\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = ph.patient_number\n    ) as person_id,\n    CASE WHEN pathology_test_datetime is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(pathology_test_datetime) END as device_exposure_start_date,\n    DATETIME(pathology_test_datetime) as device_exposure_start_datetime,\n    NULL as device_exposure_end_date,\n    NULL as device_exposure_end_datetime,\n    NULL as provider_id,\n    pathology_test_type as device_source_value,\n    detected_cis_unit_of_measure as unit_source_value,\n    FROM pathology_hba1c ph\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pe.patient_number\n    ) as person_id,\n    CASE WHEN pathology_test_datetime is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(pathology_test_datetime) END as device_exposure_start_date,\n    DATETIME(pathology_test_datetime) as device_exposure_start_datetime,\n    NULL as device_exposure_end_date,\n    NULL as device_exposure_end_datetime,\n    NULL as provider_id,\n    pathology_test_type as device_source_value,\n    detected_cis_unit_of_measure as unit_source_value,\n    FROM pathology_egfr pe\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pa.patient_number\n    ) as person_id,\n    CASE\n    \n \n        WHEN REGEXP_CONTAINS(pathology_test_datetime  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \n        THEN CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', pathology_test_datetime)) AS DATE) \n    \n\n    ELSE CAST('1800-01-01' AS DATE) END as device_exposure_start_date,\n    CASE \n    \n \n WHEN REGEXP_CONTAINS(pathology_test_datetime  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \n THEN PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', pathology_test_datetime) \n    \n\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END as device_exposure_start_datetime,\n    NULL as device_exposure_end_date,\n    NULL as device_exposure_end_datetime,\n    NULL as provider_id,\n    pathology_test_type as device_source_value,\n    detected_cis_unit_of_measure as unit_source_value,\n    FROM pathology_albumin pa\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pat.patient_number\n    ) as person_id,\n    CASE WHEN report_date is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(report_date) END as device_exposure_start_date,\n    DATETIME(report_date) as device_exposure_start_datetime,\n    NULL as device_exposure_end_date,\n    NULL as device_exposure_end_datetime,\n    NULL as provider_id,\n    result_name as device_source_value,\n    NULL as unit_source_value,\n    FROM pathology pat\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = im.patient_number\n    ) as person_id,\n    CASE WHEN given_date is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(given_date) END as device_exposure_start_date,\n    DATETIME(given_date) as device_exposure_start_datetime,\n    given_date as device_exposure_end_date,\n    given_date as device_exposure_end_datetime,\n    NULL as provider_id,\n    vaccine_name as device_source_value,\n    NULL as unit_source_value,\n    FROM immunisation im\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pr.patient_number\n    ) as person_id,\n    CASE WHEN result_date is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(result_date) END as device_exposure_start_date,\n    DATETIME(result_date) as device_exposure_start_datetime,\n    NULL as device_exposure_end_date,\n    NULL as device_exposure_end_datetime,\n    NULL as provider_id,\n    result_name as device_source_value,\n    units as unit_source_value,\n    FROM pathology_result pr\n)\n\nSELECT \nROW_NUMBER() OVER(ORDER BY device_source_value ASC) AS device_exposure_id,\nperson_id,\n0 as device_concept_id,\ndevice_exposure_start_date,\ndevice_exposure_start_datetime,\nCAST(device_exposure_end_date AS DATE) AS device_exposure_end_date,\nCAST(device_exposure_end_datetime AS DATETIME) AS device_exposure_end_datetime,\n0 as device_type_concept_id,\nCAST(NULL AS STRING) as unique_device_id,\nCAST(NULL AS STRING) as production_id,\nNULL as quantity,\nprovider_id,\nNULL as visit_occurrence_id,\nNULL as visit_detail_id,\ndevice_source_value,\n0 as device_source_concept_id,\n0 as unit_concept_id,\nunit_source_value,\n0 as unit_source_concept_id\nFROM intermediate_device_exposure ORDER BY device_exposure_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`device_exposure`"}, "test.NPS_OMOP_CDM.unique_device_exposure_device_exposure_id.cdcba3488d": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "device_exposure_id", "model": "{{ get_where_subquery(ref('device_exposure')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.device_exposure"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Device_Exposure", "unique_device_exposure_device_exposure_id"], "unique_id": "test.NPS_OMOP_CDM.unique_device_exposure_device_exposure_id.cdcba3488d", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "unique_device_exposure_device_exposure_id.sql", "original_file_path": "models\\CDM\\Device_Exposure\\device_exposure.yml", "name": "unique_device_exposure_device_exposure_id", "alias": "unique_device_exposure_device_exposure_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["device_exposure"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Device_Exposure\\device_exposure.yml\\unique_device_exposure_device_exposure_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651587190.9897885, "compiled_sql": "\n    \n    \n\nwith dbt_test__target as (\n  \n  select device_exposure_id as unique_field\n  from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`device_exposure`\n  where device_exposure_id is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "device_exposure_id", "file_key_name": "models.device_exposure"}, "test.NPS_OMOP_CDM.not_null_device_exposure_device_exposure_id.ab1d5a2fe5": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "device_exposure_id", "model": "{{ get_where_subquery(ref('device_exposure')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.device_exposure"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Device_Exposure", "not_null_device_exposure_device_exposure_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_device_exposure_device_exposure_id.ab1d5a2fe5", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_device_exposure_device_exposure_id.sql", "original_file_path": "models\\CDM\\Device_Exposure\\device_exposure.yml", "name": "not_null_device_exposure_device_exposure_id", "alias": "not_null_device_exposure_device_exposure_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["device_exposure"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Device_Exposure\\device_exposure.yml\\not_null_device_exposure_device_exposure_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651587190.994775, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`device_exposure`\nwhere device_exposure_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "device_exposure_id", "file_key_name": "models.device_exposure"}, "test.NPS_OMOP_CDM.not_null_device_exposure_person_id.1330a61d39": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "person_id", "model": "{{ get_where_subquery(ref('device_exposure')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.device_exposure"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Device_Exposure", "not_null_device_exposure_person_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_device_exposure_person_id.1330a61d39", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_device_exposure_person_id.sql", "original_file_path": "models\\CDM\\Device_Exposure\\device_exposure.yml", "name": "not_null_device_exposure_person_id", "alias": "not_null_device_exposure_person_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["device_exposure"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Device_Exposure\\device_exposure.yml\\not_null_device_exposure_person_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651587190.998763, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`device_exposure`\nwhere person_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.device_exposure"}, "test.NPS_OMOP_CDM.relationships_device_exposure_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.948ad4fe61": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_device_exposure_b51d3281c67c4d9c563f018b7ac985c4\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person')", "field": "person_id", "column_name": "person_id", "model": "{{ get_where_subquery(ref('device_exposure')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.device_exposure"]}, "config": {"enabled": true, "alias": "relationships_device_exposure_b51d3281c67c4d9c563f018b7ac985c4", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Device_Exposure", "relationships_device_exposure_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_"], "unique_id": "test.NPS_OMOP_CDM.relationships_device_exposure_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.948ad4fe61", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_device_exposure_b51d3281c67c4d9c563f018b7ac985c4.sql", "original_file_path": "models\\CDM\\Device_Exposure\\device_exposure.yml", "name": "relationships_device_exposure_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_", "alias": "relationships_device_exposure_b51d3281c67c4d9c563f018b7ac985c4", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["device_exposure"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Device_Exposure\\device_exposure.yml\\relationships_device_exposure_b51d3281c67c4d9c563f018b7ac985c4.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_device_exposure_b51d3281c67c4d9c563f018b7ac985c4"}, "created_at": 1651587191.002746, "compiled_sql": "\n    \n    \n\nwith child as (\n    select person_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`device_exposure`\n    where person_id is not null\n),\n\nparent as (\n    select person_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.device_exposure"}, "test.NPS_OMOP_CDM.not_null_device_exposure_device_exposure_start_date.23aa3e8aea": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "device_exposure_start_date", "model": "{{ get_where_subquery(ref('device_exposure')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.device_exposure"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Device_Exposure", "not_null_device_exposure_device_exposure_start_date"], "unique_id": "test.NPS_OMOP_CDM.not_null_device_exposure_device_exposure_start_date.23aa3e8aea", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_device_exposure_device_exposure_start_date.sql", "original_file_path": "models\\CDM\\Device_Exposure\\device_exposure.yml", "name": "not_null_device_exposure_device_exposure_start_date", "alias": "not_null_device_exposure_device_exposure_start_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["device_exposure"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Device_Exposure\\device_exposure.yml\\not_null_device_exposure_device_exposure_start_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651587191.035628, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`device_exposure`\nwhere device_exposure_start_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "device_exposure_start_date", "file_key_name": "models.device_exposure"}, "test.NPS_OMOP_CDM.not_null_device_exposure_device_concept_id.041c422e55": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "device_concept_id", "model": "{{ get_where_subquery(ref('device_exposure')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.device_exposure"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Device_Exposure", "not_null_device_exposure_device_concept_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_device_exposure_device_concept_id.041c422e55", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_device_exposure_device_concept_id.sql", "original_file_path": "models\\CDM\\Device_Exposure\\device_exposure.yml", "name": "not_null_device_exposure_device_concept_id", "alias": "not_null_device_exposure_device_concept_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["device_exposure"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Device_Exposure\\device_exposure.yml\\not_null_device_exposure_device_concept_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651587191.0406148, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`device_exposure`\nwhere device_concept_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "device_concept_id", "file_key_name": "models.device_exposure"}, "model.NPS_OMOP_CDM.drug_exposure": {"raw_sql": "WITH immunisation AS (\n    SELECT *\n    FROM {{ ref('stg_drug_exposure_immunisation')}}\n),\nprescription AS (\n    SELECT *\n    FROM {{ ref('stg_drug_exposure_prescription')}}\n),\n\nscript_item AS (\n    SELECT *\n    FROM {{ ref('stg_drug_exposure_script_item')}}\n),\nprovider AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'provider') }}\n),\n\nperson AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person') }}\n),\n\nintermediate_drug_exposure AS (\n    SELECT \n    (\n        SELECT p.person_id FROM person p WHERE p.person_source_value = im.patient_number\n    ) as person_id,\n    CASE WHEN GIVEN_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(GIVEN_DATE) END AS drug_exposure_start_date,\n    CASE WHEN GIVEN_DATE IS NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME)\n    ELSE DATETIME(GIVEN_DATE) END AS drug_exposure_start_datetime,\n    CASE WHEN GIVEN_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(GIVEN_DATE) END AS drug_exposure_end_date,\n    CASE WHEN GIVEN_DATE IS NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME)\n    ELSE DATETIME(GIVEN_DATE) END AS drug_exposure_end_datetime,\n    CAST(NULL AS DATE) AS verbatim_end_date,\n    -- CAST(NULL AS FLOAT64) as quantity,\n    NULL as quantity,\n    CAST(NULL AS INT64) as days_supply,\n    NULL as sig,\n    BATCH_NUMBER as lot_number,\n    (SELECT provider_id FROM provider pr WHERE pr.provider_source_value = im.provider_id) AS provider_id,\n    VACCINE_NAME as drug_source_value,\n    ADMINISTERED_ROUTE as route_source_value,\n    NULL as dose_unit_source_value\n    FROM immunisation im\n\n    UNION DISTINCT\n\n    SELECT \n    (\n        SELECT p.person_id FROM person p WHERE p.person_source_value = pre.patient_number\n    ) as person_id,\n    CASE \n    {{ convert_datetime_string_to_date('FIRST_DATE') }}\n    ELSE CAST('1800-01-01' AS DATE) END AS drug_exposure_start_date,\n    CASE \n    {{ convert_datetime_string_to_datetime('FIRST_DATE') }}\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END AS drug_exposure_start_datetime,\n    CASE \n    {{ convert_datetime_string_to_date('LAST_DATE') }}\n    ELSE CAST('1800-01-01' AS DATE) END AS drug_exposure_end_date,\n    CASE \n    {{ convert_datetime_string_to_datetime('LAST_DATE') }}\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END AS drug_exposure_end_datetime,\n    CAST(NULL AS DATE) AS verbatim_end_date,\n    QUANTITY as quantity,\n    CAST(NULL AS INT64) as days_supply,\n    INSTRUCTIONS as sig,\n    NULL as lot_number,\n    NULL AS provider_id,\n    MEDICINE_NAME as drug_source_value,\n    ROUTE as route_source_value,\n    DOSE as dose_unit_source_value\n    FROM prescription pre\n\n    UNION DISTINCT\n\n    SELECT \n    (\n        SELECT p.person_id FROM person p WHERE p.person_source_value = sc.patient_number\n    ) as person_id,\n    CASE \n    {{ convert_datetime_string_to_date('SCRIPT_DATE') }}\n    ELSE CAST('1800-01-01' AS DATE) END AS drug_exposure_start_date,\n    CASE\n    {{ convert_datetime_string_to_datetime('SCRIPT_DATE') }} \n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END AS drug_exposure_start_datetime,\n    CAST('1800-01-01' AS DATE) AS drug_exposure_end_date,\n    CAST('1800-01-01 00:00:00.000' AS DATETIME) AS drug_exposure_end_datetime,\n    CAST(NULL AS DATE) AS verbatim_end_date,\n    QUANTITY as quantity,\n    CAST(NULL AS INT64) as days_supply,\n    INSTRUCTIONS as sig,\n    NULL as lot_number,\n    (SELECT provider_id FROM provider pr WHERE pr.provider_source_value = sc.provider_id) AS provider_id,\n    MEDICINE_NAME as drug_source_value,\n    ROUTE as route_source_value,\n    DOSE as dose_unit_source_value\n    FROM script_item sc\n\n)\n\nSELECT\nROW_NUMBER() OVER(ORDER BY drug_exposure_start_date ASC) AS drug_exposure_id,\nperson_id,\n0 as drug_concept_id,\ndrug_exposure_start_date,\ndrug_exposure_start_datetime,\ndrug_exposure_end_date,\ndrug_exposure_end_datetime,\nCAST(verbatim_end_date AS DATE) AS verbatim_end_date,\n0 as drug_type_concept_id,\nCAST(NULL AS STRING) as stop_reason,\n0 as refills,\n-- CAST(quantity AS FLOAT64) AS quantity,\nquantity,\nCAST(days_supply AS INT64) AS days_supply,\nsig,\n0 as route_concept_id,\nlot_number,\nprovider_id,\n0 as visit_occurrence_id,\n0 as visit_detail_id,\ndrug_source_value,\n0 as drug_source_concept_id,\nroute_source_value,\ndose_unit_source_value \nFROM intermediate_drug_exposure ORDER BY drug_exposure_id", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.NPS_OMOP_CDM.convert_datetime_string_to_date", "macro.NPS_OMOP_CDM.convert_datetime_string_to_datetime"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.provider", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.stg_drug_exposure_immunisation", "model.NPS_OMOP_CDM.stg_drug_exposure_prescription", "model.NPS_OMOP_CDM.stg_drug_exposure_script_item"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "Drug_Exposure", "drug_exposure"], "unique_id": "model.NPS_OMOP_CDM.drug_exposure", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\Drug_Exposure\\drug_exposure.sql", "original_file_path": "models\\CDM\\Drug_Exposure\\drug_exposure.sql", "name": "drug_exposure", "alias": "drug_exposure", "checksum": {"name": "sha256", "checksum": "7b56d39d3cdcee02688d45934f911966b3d7a522486e9b75f09375a9eb2087a4"}, "tags": [], "refs": [["stg_drug_exposure_immunisation"], ["stg_drug_exposure_prescription"], ["stg_drug_exposure_script_item"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "provider"], ["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {"drug_exposure_id": {"name": "drug_exposure_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "person_id": {"name": "person_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "drug_exposure_start_date": {"name": "drug_exposure_start_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "drug_exposure_end_date": {"name": "drug_exposure_end_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "provider_id": {"name": "provider_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\Drug_Exposure\\drug_exposure.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Drug_Exposure\\drug_exposure.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651589292.9415233, "compiled_sql": "WITH immunisation AS (\n    SELECT *\n    FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_drug_exposure_immunisation`\n),\nprescription AS (\n    SELECT *\n    FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_drug_exposure_prescription`\n),\n\nscript_item AS (\n    SELECT *\n    FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_drug_exposure_script_item`\n),\nprovider AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`provider`\n),\n\nperson AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\n\nintermediate_drug_exposure AS (\n    SELECT \n    (\n        SELECT p.person_id FROM person p WHERE p.person_source_value = im.patient_number\n    ) as person_id,\n    CASE WHEN GIVEN_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(GIVEN_DATE) END AS drug_exposure_start_date,\n    CASE WHEN GIVEN_DATE IS NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME)\n    ELSE DATETIME(GIVEN_DATE) END AS drug_exposure_start_datetime,\n    CASE WHEN GIVEN_DATE IS NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(GIVEN_DATE) END AS drug_exposure_end_date,\n    CASE WHEN GIVEN_DATE IS NULL THEN CAST('1800-01-01 00:00:00.000' AS DATETIME)\n    ELSE DATETIME(GIVEN_DATE) END AS drug_exposure_end_datetime,\n    CAST(NULL AS DATE) AS verbatim_end_date,\n    -- CAST(NULL AS FLOAT64) as quantity,\n    NULL as quantity,\n    CAST(NULL AS INT64) as days_supply,\n    NULL as sig,\n    BATCH_NUMBER as lot_number,\n    (SELECT provider_id FROM provider pr WHERE pr.provider_source_value = im.provider_id) AS provider_id,\n    VACCINE_NAME as drug_source_value,\n    ADMINISTERED_ROUTE as route_source_value,\n    NULL as dose_unit_source_value\n    FROM immunisation im\n\n    UNION DISTINCT\n\n    SELECT \n    (\n        SELECT p.person_id FROM person p WHERE p.person_source_value = pre.patient_number\n    ) as person_id,\n    CASE \n    \n \n        WHEN REGEXP_CONTAINS(FIRST_DATE  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \n        THEN CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', FIRST_DATE)) AS DATE) \n    \n\n    ELSE CAST('1800-01-01' AS DATE) END AS drug_exposure_start_date,\n    CASE \n    \n \n WHEN REGEXP_CONTAINS(FIRST_DATE  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \n THEN PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', FIRST_DATE) \n    \n\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END AS drug_exposure_start_datetime,\n    CASE \n    \n \n        WHEN REGEXP_CONTAINS(LAST_DATE  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \n        THEN CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', LAST_DATE)) AS DATE) \n    \n\n    ELSE CAST('1800-01-01' AS DATE) END AS drug_exposure_end_date,\n    CASE \n    \n \n WHEN REGEXP_CONTAINS(LAST_DATE  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \n THEN PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', LAST_DATE) \n    \n\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END AS drug_exposure_end_datetime,\n    CAST(NULL AS DATE) AS verbatim_end_date,\n    QUANTITY as quantity,\n    CAST(NULL AS INT64) as days_supply,\n    INSTRUCTIONS as sig,\n    NULL as lot_number,\n    NULL AS provider_id,\n    MEDICINE_NAME as drug_source_value,\n    ROUTE as route_source_value,\n    DOSE as dose_unit_source_value\n    FROM prescription pre\n\n    UNION DISTINCT\n\n    SELECT \n    (\n        SELECT p.person_id FROM person p WHERE p.person_source_value = sc.patient_number\n    ) as person_id,\n    CASE \n    \n \n        WHEN REGEXP_CONTAINS(SCRIPT_DATE  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \n        THEN CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', SCRIPT_DATE)) AS DATE) \n    \n\n    ELSE CAST('1800-01-01' AS DATE) END AS drug_exposure_start_date,\n    CASE\n    \n \n WHEN REGEXP_CONTAINS(SCRIPT_DATE  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \n THEN PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', SCRIPT_DATE) \n    \n \n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END AS drug_exposure_start_datetime,\n    CAST('1800-01-01' AS DATE) AS drug_exposure_end_date,\n    CAST('1800-01-01 00:00:00.000' AS DATETIME) AS drug_exposure_end_datetime,\n    CAST(NULL AS DATE) AS verbatim_end_date,\n    QUANTITY as quantity,\n    CAST(NULL AS INT64) as days_supply,\n    INSTRUCTIONS as sig,\n    NULL as lot_number,\n    (SELECT provider_id FROM provider pr WHERE pr.provider_source_value = sc.provider_id) AS provider_id,\n    MEDICINE_NAME as drug_source_value,\n    ROUTE as route_source_value,\n    DOSE as dose_unit_source_value\n    FROM script_item sc\n\n)\n\nSELECT\nROW_NUMBER() OVER(ORDER BY drug_exposure_start_date ASC) AS drug_exposure_id,\nperson_id,\n0 as drug_concept_id,\ndrug_exposure_start_date,\ndrug_exposure_start_datetime,\ndrug_exposure_end_date,\ndrug_exposure_end_datetime,\nCAST(verbatim_end_date AS DATE) AS verbatim_end_date,\n0 as drug_type_concept_id,\nCAST(NULL AS STRING) as stop_reason,\n0 as refills,\n-- CAST(quantity AS FLOAT64) AS quantity,\nquantity,\nCAST(days_supply AS INT64) AS days_supply,\nsig,\n0 as route_concept_id,\nlot_number,\nprovider_id,\n0 as visit_occurrence_id,\n0 as visit_detail_id,\ndrug_source_value,\n0 as drug_source_concept_id,\nroute_source_value,\ndose_unit_source_value \nFROM intermediate_drug_exposure ORDER BY drug_exposure_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`drug_exposure`"}, "test.NPS_OMOP_CDM.unique_drug_exposure_drug_exposure_id.6e11199bfc": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "drug_exposure_id", "model": "{{ get_where_subquery(ref('drug_exposure')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.drug_exposure"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Drug_Exposure", "unique_drug_exposure_drug_exposure_id"], "unique_id": "test.NPS_OMOP_CDM.unique_drug_exposure_drug_exposure_id.6e11199bfc", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "unique_drug_exposure_drug_exposure_id.sql", "original_file_path": "models\\CDM\\Drug_Exposure\\drug_exposure.yml", "name": "unique_drug_exposure_drug_exposure_id", "alias": "unique_drug_exposure_drug_exposure_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["drug_exposure"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Drug_Exposure\\drug_exposure.yml\\unique_drug_exposure_drug_exposure_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651589292.9624667, "compiled_sql": "\n    \n    \n\nwith dbt_test__target as (\n  \n  select drug_exposure_id as unique_field\n  from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`drug_exposure`\n  where drug_exposure_id is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "drug_exposure_id", "file_key_name": "models.drug_exposure"}, "test.NPS_OMOP_CDM.not_null_drug_exposure_drug_exposure_id.a57f0904e3": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "drug_exposure_id", "model": "{{ get_where_subquery(ref('drug_exposure')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.drug_exposure"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Drug_Exposure", "not_null_drug_exposure_drug_exposure_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_drug_exposure_drug_exposure_id.a57f0904e3", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_drug_exposure_drug_exposure_id.sql", "original_file_path": "models\\CDM\\Drug_Exposure\\drug_exposure.yml", "name": "not_null_drug_exposure_drug_exposure_id", "alias": "not_null_drug_exposure_drug_exposure_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["drug_exposure"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Drug_Exposure\\drug_exposure.yml\\not_null_drug_exposure_drug_exposure_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651589292.9664574, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`drug_exposure`\nwhere drug_exposure_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "drug_exposure_id", "file_key_name": "models.drug_exposure"}, "test.NPS_OMOP_CDM.relationships_drug_exposure_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.07271b7683": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_drug_exposure_36b2fe2cf0a63929a4484ef6ce316677\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person')", "field": "person_id", "column_name": "person_id", "model": "{{ get_where_subquery(ref('drug_exposure')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.drug_exposure"]}, "config": {"enabled": true, "alias": "relationships_drug_exposure_36b2fe2cf0a63929a4484ef6ce316677", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Drug_Exposure", "relationships_drug_exposure_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_"], "unique_id": "test.NPS_OMOP_CDM.relationships_drug_exposure_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.07271b7683", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_drug_exposure_36b2fe2cf0a63929a4484ef6ce316677.sql", "original_file_path": "models\\CDM\\Drug_Exposure\\drug_exposure.yml", "name": "relationships_drug_exposure_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_", "alias": "relationships_drug_exposure_36b2fe2cf0a63929a4484ef6ce316677", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["drug_exposure"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Drug_Exposure\\drug_exposure.yml\\relationships_drug_exposure_36b2fe2cf0a63929a4484ef6ce316677.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_drug_exposure_36b2fe2cf0a63929a4484ef6ce316677"}, "created_at": 1651589292.9704456, "compiled_sql": "\n    \n    \n\nwith child as (\n    select person_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`drug_exposure`\n    where person_id is not null\n),\n\nparent as (\n    select person_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.drug_exposure"}, "test.NPS_OMOP_CDM.not_null_drug_exposure_drug_exposure_start_date.61d182cfaa": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "drug_exposure_start_date", "model": "{{ get_where_subquery(ref('drug_exposure')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.drug_exposure"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Drug_Exposure", "not_null_drug_exposure_drug_exposure_start_date"], "unique_id": "test.NPS_OMOP_CDM.not_null_drug_exposure_drug_exposure_start_date.61d182cfaa", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_drug_exposure_drug_exposure_start_date.sql", "original_file_path": "models\\CDM\\Drug_Exposure\\drug_exposure.yml", "name": "not_null_drug_exposure_drug_exposure_start_date", "alias": "not_null_drug_exposure_drug_exposure_start_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["drug_exposure"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Drug_Exposure\\drug_exposure.yml\\not_null_drug_exposure_drug_exposure_start_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651589293.016287, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`drug_exposure`\nwhere drug_exposure_start_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "drug_exposure_start_date", "file_key_name": "models.drug_exposure"}, "test.NPS_OMOP_CDM.not_null_drug_exposure_drug_exposure_end_date.89e020fdd4": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "drug_exposure_end_date", "model": "{{ get_where_subquery(ref('drug_exposure')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.drug_exposure"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Drug_Exposure", "not_null_drug_exposure_drug_exposure_end_date"], "unique_id": "test.NPS_OMOP_CDM.not_null_drug_exposure_drug_exposure_end_date.89e020fdd4", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_drug_exposure_drug_exposure_end_date.sql", "original_file_path": "models\\CDM\\Drug_Exposure\\drug_exposure.yml", "name": "not_null_drug_exposure_drug_exposure_end_date", "alias": "not_null_drug_exposure_drug_exposure_end_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["drug_exposure"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Drug_Exposure\\drug_exposure.yml\\not_null_drug_exposure_drug_exposure_end_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651589293.0212734, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`drug_exposure`\nwhere drug_exposure_end_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "drug_exposure_end_date", "file_key_name": "models.drug_exposure"}, "test.NPS_OMOP_CDM.relationships_drug_exposure_provider_id__provider_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_provider_.e855c95c18": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_drug_exposure_3cbb641e0f4f623e8ba3a4ebbb9d4be7\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'provider')", "field": "provider_id", "column_name": "provider_id", "model": "{{ get_where_subquery(ref('drug_exposure')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.provider", "model.NPS_OMOP_CDM.drug_exposure"]}, "config": {"enabled": true, "alias": "relationships_drug_exposure_3cbb641e0f4f623e8ba3a4ebbb9d4be7", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Drug_Exposure", "relationships_drug_exposure_provider_id__provider_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_provider_"], "unique_id": "test.NPS_OMOP_CDM.relationships_drug_exposure_provider_id__provider_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_provider_.e855c95c18", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_drug_exposure_3cbb641e0f4f623e8ba3a4ebbb9d4be7.sql", "original_file_path": "models\\CDM\\Drug_Exposure\\drug_exposure.yml", "name": "relationships_drug_exposure_provider_id__provider_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_provider_", "alias": "relationships_drug_exposure_3cbb641e0f4f623e8ba3a4ebbb9d4be7", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["drug_exposure"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "provider"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Drug_Exposure\\drug_exposure.yml\\relationships_drug_exposure_3cbb641e0f4f623e8ba3a4ebbb9d4be7.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_drug_exposure_3cbb641e0f4f623e8ba3a4ebbb9d4be7"}, "created_at": 1651589293.0262604, "compiled_sql": "\n    \n    \n\nwith child as (\n    select provider_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`drug_exposure`\n    where provider_id is not null\n),\n\nparent as (\n    select provider_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`provider`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "provider_id", "file_key_name": "models.drug_exposure"}, "model.NPS_OMOP_CDM.visit_occurrence": {"raw_sql": "with encounter as (\n    SELECT * FROM {{ ref('stg_visit_occurrence_encounter')}}\n),\n\nencounter_reason as (\n    SELECT * FROM {{ ref('stg_visit_occurrence_encounter_reason')}}\n),\n\nperson AS (\nSELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person') }}\n),\n\ncare_site AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'care_site') }}\n),\n\nintermediate_visit_occurrence as (\n    SELECT\n    (\n        SELECT p.person_id FROM person p WHERE p.person_source_value = en.patient_number\n    ) as person_id,\n    CASE \n        {{ convert_datetime_string_to_date('ENCOUNTER_START_DATETIME') }} \n        ELSE \n            CASE WHEN VISIT_DATE IS NULL THEN\n                CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', CREATED_DATETIME)) AS DATE)\n                ELSE VISIT_DATE\n            END\n    END \n    AS visit_start_date,\n    CASE \n        {{ convert_datetime_string_to_datetime('ENCOUNTER_START_DATETIME')}}\n        ELSE \n            CASE WHEN VISIT_DATETIME IS NULL THEN\n            PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', CREATED_DATETIME)  \n            ELSE CAST(VISIT_DATETIME AS DATETIME)\n            END\n    END AS visit_start_datetime,\n    CASE \n        {{ convert_datetime_string_to_date('ENCOUNTER_END_DATETIME') }}\n        ELSE \n            CASE \n                WHEN VISIT_DATE IS NULL \n                THEN CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', CREATED_DATETIME)) AS DATE)\n                ELSE VISIT_DATE\n            END\n    END as visit_end_date,\n    CASE \n    {{ convert_datetime_string_to_datetime('ENCOUNTER_END_DATETIME') }}\n    ELSE \n        CASE WHEN VISIT_DATETIME IS NULL\n        THEN DATETIME_ADD(PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', CREATED_DATETIME), INTERVAL ENCOUNTER_DURATION  SECOND)\n        ELSE \n        DATETIME_ADD(CAST(VISIT_DATETIME AS DATETIME), INTERVAL ENCOUNTER_DURATION  SECOND)\n        END\n    END as visit_end_datetime,\n    (\n        SELECT cr.care_site_id FROM care_site cr WHERE cr.care_site_source_value = en.site_id\n    ) as care_site_id,\n    encounter_id as visit_source_value,\n    0 as preceding_visit_occurrence_id\n    FROM encounter en\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM person p WHERE p.person_source_value = er.patient_number\n    ) as person_id,\n    CASE WHEN VISIT_DATETIME IS NULL THEN CAST(CREATED_DATETIME as DATE) \n    ELSE CAST(VISIT_DATETIME as DATE)\n    END as visit_start_date,\n    CASE WHEN VISIT_DATETIME IS NULL THEN CAST(CREATED_DATETIME as DATETIME) \n    ELSE CAST(VISIT_DATETIME as DATETIME)\n    END as visit_start_datetime,\n    CASE WHEN VISIT_DATETIME IS NULL THEN CAST(CREATED_DATETIME as DATE) \n    ELSE CAST(VISIT_DATETIME as DATE)\n    END as visit_end_date,\n    CASE WHEN VISIT_DATETIME IS NULL THEN CAST(CREATED_DATETIME as DATETIME) \n    ELSE CAST(VISIT_DATETIME as DATETIME)\n    END as visit_end_datetime,\n    (\n        SELECT cr.care_site_id FROM care_site cr WHERE cr.care_site_source_value = er.site_id\n    ) as care_site_id,\n    encounter_id as visit_source_value,\n    0 as preceding_visit_occurrence_id\n    FROM encounter_reason er\n)\n\nSELECT\nROW_NUMBER() OVER(ORDER BY visit_source_value ASC) AS visit_occurrence_id,\nperson_id,\n0 as visit_concept_id,\nvisit_start_date,\nvisit_start_datetime,\nvisit_end_date,\nvisit_end_datetime,\n0 as visit_type_concept_id,\nCAST(NULL AS INT64) AS provider_id,\ncare_site_id,\nvisit_source_value,\n0 as visit_source_concept_id,\n0 as admitted_from_concept_id,\nCAST(NULL AS STRING) as admitted_from_source_value,\n0 as discharge_to_concept_id,\nCAST(NULL AS STRING) as discharge_to_source_value,\npreceding_visit_occurrence_id\nFROM intermediate_visit_occurrence\nORDER BY visit_occurrence_id", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.NPS_OMOP_CDM.convert_datetime_string_to_date", "macro.NPS_OMOP_CDM.convert_datetime_string_to_datetime"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site", "model.NPS_OMOP_CDM.stg_visit_occurrence_encounter", "model.NPS_OMOP_CDM.stg_visit_occurrence_encounter_reason"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "Visit_Occurrence", "visit_occurrence"], "unique_id": "model.NPS_OMOP_CDM.visit_occurrence", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\Visit_Occurrence\\visit_occurrence.sql", "original_file_path": "models\\CDM\\Visit_Occurrence\\visit_occurrence.sql", "name": "visit_occurrence", "alias": "visit_occurrence", "checksum": {"name": "sha256", "checksum": "9a0857e5ea710f2e3f860c1180c691b2b6a3ea57f061a2f3e7ff5cb753f529c4"}, "tags": [], "refs": [["stg_visit_occurrence_encounter"], ["stg_visit_occurrence_encounter_reason"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"], ["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "care_site"]], "description": "", "columns": {"visit_occurrence_id": {"name": "visit_occurrence_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "person_id": {"name": "person_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "visit_start_date": {"name": "visit_start_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "visit_end_date": {"name": "visit_end_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "care_site_id": {"name": "care_site_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\Visit_Occurrence\\visit_occurrence.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Visit_Occurrence\\visit_occurrence.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651647668.5179658, "compiled_sql": "with encounter as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_visit_occurrence_encounter`\n),\n\nencounter_reason as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_visit_occurrence_encounter_reason`\n),\n\nperson AS (\nSELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\n\ncare_site AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`care_site`\n),\n\nintermediate_visit_occurrence as (\n    SELECT\n    (\n        SELECT p.person_id FROM person p WHERE p.person_source_value = en.patient_number\n    ) as person_id,\n    CASE \n        \n \n        WHEN REGEXP_CONTAINS(ENCOUNTER_START_DATETIME  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \n        THEN CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', ENCOUNTER_START_DATETIME)) AS DATE) \n    \n \n        ELSE \n            CASE WHEN VISIT_DATE IS NULL THEN\n                CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', CREATED_DATETIME)) AS DATE)\n                ELSE VISIT_DATE\n            END\n    END \n    AS visit_start_date,\n    CASE \n        \n \n WHEN REGEXP_CONTAINS(ENCOUNTER_START_DATETIME  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \n THEN PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', ENCOUNTER_START_DATETIME) \n    \n\n        ELSE \n            CASE WHEN VISIT_DATETIME IS NULL THEN\n            PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', CREATED_DATETIME)  \n            ELSE CAST(VISIT_DATETIME AS DATETIME)\n            END\n    END AS visit_start_datetime,\n    CASE \n        \n \n        WHEN REGEXP_CONTAINS(ENCOUNTER_END_DATETIME  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \n        THEN CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', ENCOUNTER_END_DATETIME)) AS DATE) \n    \n\n        ELSE \n            CASE \n                WHEN VISIT_DATE IS NULL \n                THEN CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', CREATED_DATETIME)) AS DATE)\n                ELSE VISIT_DATE\n            END\n    END as visit_end_date,\n    CASE \n    \n \n WHEN REGEXP_CONTAINS(ENCOUNTER_END_DATETIME  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \n THEN PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', ENCOUNTER_END_DATETIME) \n    \n\n    ELSE \n        CASE WHEN VISIT_DATETIME IS NULL\n        THEN DATETIME_ADD(PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', CREATED_DATETIME), INTERVAL ENCOUNTER_DURATION  SECOND)\n        ELSE \n        DATETIME_ADD(CAST(VISIT_DATETIME AS DATETIME), INTERVAL ENCOUNTER_DURATION  SECOND)\n        END\n    END as visit_end_datetime,\n    (\n        SELECT cr.care_site_id FROM care_site cr WHERE cr.care_site_source_value = en.site_id\n    ) as care_site_id,\n    encounter_id as visit_source_value,\n    0 as preceding_visit_occurrence_id\n    FROM encounter en\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM person p WHERE p.person_source_value = er.patient_number\n    ) as person_id,\n    CASE WHEN VISIT_DATETIME IS NULL THEN CAST(CREATED_DATETIME as DATE) \n    ELSE CAST(VISIT_DATETIME as DATE)\n    END as visit_start_date,\n    CASE WHEN VISIT_DATETIME IS NULL THEN CAST(CREATED_DATETIME as DATETIME) \n    ELSE CAST(VISIT_DATETIME as DATETIME)\n    END as visit_start_datetime,\n    CASE WHEN VISIT_DATETIME IS NULL THEN CAST(CREATED_DATETIME as DATE) \n    ELSE CAST(VISIT_DATETIME as DATE)\n    END as visit_end_date,\n    CASE WHEN VISIT_DATETIME IS NULL THEN CAST(CREATED_DATETIME as DATETIME) \n    ELSE CAST(VISIT_DATETIME as DATETIME)\n    END as visit_end_datetime,\n    (\n        SELECT cr.care_site_id FROM care_site cr WHERE cr.care_site_source_value = er.site_id\n    ) as care_site_id,\n    encounter_id as visit_source_value,\n    0 as preceding_visit_occurrence_id\n    FROM encounter_reason er\n)\n\nSELECT\nROW_NUMBER() OVER(ORDER BY visit_source_value ASC) AS visit_occurrence_id,\nperson_id,\n0 as visit_concept_id,\nvisit_start_date,\nvisit_start_datetime,\nvisit_end_date,\nvisit_end_datetime,\n0 as visit_type_concept_id,\nCAST(NULL AS INT64) AS provider_id,\ncare_site_id,\nvisit_source_value,\n0 as visit_source_concept_id,\n0 as admitted_from_concept_id,\nCAST(NULL AS STRING) as admitted_from_source_value,\n0 as discharge_to_concept_id,\nCAST(NULL AS STRING) as discharge_to_source_value,\npreceding_visit_occurrence_id\nFROM intermediate_visit_occurrence\nORDER BY visit_occurrence_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`visit_occurrence`"}, "test.NPS_OMOP_CDM.not_null_visit_occurrence_visit_occurrence_id.a3a65446cf": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "visit_occurrence_id", "model": "{{ get_where_subquery(ref('visit_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.visit_occurrence"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Visit_Occurrence", "not_null_visit_occurrence_visit_occurrence_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_visit_occurrence_visit_occurrence_id.a3a65446cf", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_visit_occurrence_visit_occurrence_id.sql", "original_file_path": "models\\CDM\\Visit_Occurrence\\visit_occurrence.yml", "name": "not_null_visit_occurrence_visit_occurrence_id", "alias": "not_null_visit_occurrence_visit_occurrence_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["visit_occurrence"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Visit_Occurrence\\visit_occurrence.yml\\not_null_visit_occurrence_visit_occurrence_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651647668.5259442, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`visit_occurrence`\nwhere visit_occurrence_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "visit_occurrence_id", "file_key_name": "models.visit_occurrence"}, "test.NPS_OMOP_CDM.unique_visit_occurrence_visit_occurrence_id.faa3aa67c6": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "visit_occurrence_id", "model": "{{ get_where_subquery(ref('visit_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.visit_occurrence"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Visit_Occurrence", "unique_visit_occurrence_visit_occurrence_id"], "unique_id": "test.NPS_OMOP_CDM.unique_visit_occurrence_visit_occurrence_id.faa3aa67c6", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "unique_visit_occurrence_visit_occurrence_id.sql", "original_file_path": "models\\CDM\\Visit_Occurrence\\visit_occurrence.yml", "name": "unique_visit_occurrence_visit_occurrence_id", "alias": "unique_visit_occurrence_visit_occurrence_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["visit_occurrence"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Visit_Occurrence\\visit_occurrence.yml\\unique_visit_occurrence_visit_occurrence_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651647668.5279124, "compiled_sql": "\n    \n    \n\nwith dbt_test__target as (\n  \n  select visit_occurrence_id as unique_field\n  from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`visit_occurrence`\n  where visit_occurrence_id is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "visit_occurrence_id", "file_key_name": "models.visit_occurrence"}, "test.NPS_OMOP_CDM.not_null_visit_occurrence_person_id.e916ff163a": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "person_id", "model": "{{ get_where_subquery(ref('visit_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.visit_occurrence"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Visit_Occurrence", "not_null_visit_occurrence_person_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_visit_occurrence_person_id.e916ff163a", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_visit_occurrence_person_id.sql", "original_file_path": "models\\CDM\\Visit_Occurrence\\visit_occurrence.yml", "name": "not_null_visit_occurrence_person_id", "alias": "not_null_visit_occurrence_person_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["visit_occurrence"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Visit_Occurrence\\visit_occurrence.yml\\not_null_visit_occurrence_person_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651647668.530949, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`visit_occurrence`\nwhere person_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.visit_occurrence"}, "test.NPS_OMOP_CDM.relationships_visit_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.15c614ba36": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_visit_occurrence_b040440626062f04602509367a111753\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person')", "field": "person_id", "column_name": "person_id", "model": "{{ get_where_subquery(ref('visit_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.visit_occurrence"]}, "config": {"enabled": true, "alias": "relationships_visit_occurrence_b040440626062f04602509367a111753", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Visit_Occurrence", "relationships_visit_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_"], "unique_id": "test.NPS_OMOP_CDM.relationships_visit_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.15c614ba36", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_visit_occurrence_b040440626062f04602509367a111753.sql", "original_file_path": "models\\CDM\\Visit_Occurrence\\visit_occurrence.yml", "name": "relationships_visit_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_", "alias": "relationships_visit_occurrence_b040440626062f04602509367a111753", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["visit_occurrence"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Visit_Occurrence\\visit_occurrence.yml\\relationships_visit_occurrence_b040440626062f04602509367a111753.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_visit_occurrence_b040440626062f04602509367a111753"}, "created_at": 1651647668.5319383, "compiled_sql": "\n    \n    \n\nwith child as (\n    select person_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`visit_occurrence`\n    where person_id is not null\n),\n\nparent as (\n    select person_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.visit_occurrence"}, "test.NPS_OMOP_CDM.not_null_visit_occurrence_visit_start_date.6ef645340a": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "visit_start_date", "model": "{{ get_where_subquery(ref('visit_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.visit_occurrence"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Visit_Occurrence", "not_null_visit_occurrence_visit_start_date"], "unique_id": "test.NPS_OMOP_CDM.not_null_visit_occurrence_visit_start_date.6ef645340a", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_visit_occurrence_visit_start_date.sql", "original_file_path": "models\\CDM\\Visit_Occurrence\\visit_occurrence.yml", "name": "not_null_visit_occurrence_visit_start_date", "alias": "not_null_visit_occurrence_visit_start_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["visit_occurrence"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Visit_Occurrence\\visit_occurrence.yml\\not_null_visit_occurrence_visit_start_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651647668.5448685, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`visit_occurrence`\nwhere visit_start_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "visit_start_date", "file_key_name": "models.visit_occurrence"}, "test.NPS_OMOP_CDM.not_null_visit_occurrence_visit_end_date.47f6967fe8": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "visit_end_date", "model": "{{ get_where_subquery(ref('visit_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.visit_occurrence"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Visit_Occurrence", "not_null_visit_occurrence_visit_end_date"], "unique_id": "test.NPS_OMOP_CDM.not_null_visit_occurrence_visit_end_date.47f6967fe8", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_visit_occurrence_visit_end_date.sql", "original_file_path": "models\\CDM\\Visit_Occurrence\\visit_occurrence.yml", "name": "not_null_visit_occurrence_visit_end_date", "alias": "not_null_visit_occurrence_visit_end_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["visit_occurrence"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Visit_Occurrence\\visit_occurrence.yml\\not_null_visit_occurrence_visit_end_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651647668.5468905, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`visit_occurrence`\nwhere visit_end_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "visit_end_date", "file_key_name": "models.visit_occurrence"}, "test.NPS_OMOP_CDM.relationships_visit_occurrence_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.64e29a2be0": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_visit_occurrence_d3bdaa34acf0e28556a6bb670403cbb5\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'care_site')", "field": "care_site_id", "column_name": "care_site_id", "model": "{{ get_where_subquery(ref('visit_occurrence')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site", "model.NPS_OMOP_CDM.visit_occurrence"]}, "config": {"enabled": true, "alias": "relationships_visit_occurrence_d3bdaa34acf0e28556a6bb670403cbb5", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Visit_Occurrence", "relationships_visit_occurrence_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_"], "unique_id": "test.NPS_OMOP_CDM.relationships_visit_occurrence_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.64e29a2be0", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_visit_occurrence_d3bdaa34acf0e28556a6bb670403cbb5.sql", "original_file_path": "models\\CDM\\Visit_Occurrence\\visit_occurrence.yml", "name": "relationships_visit_occurrence_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_", "alias": "relationships_visit_occurrence_d3bdaa34acf0e28556a6bb670403cbb5", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["visit_occurrence"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "care_site"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Visit_Occurrence\\visit_occurrence.yml\\relationships_visit_occurrence_d3bdaa34acf0e28556a6bb670403cbb5.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_visit_occurrence_d3bdaa34acf0e28556a6bb670403cbb5"}, "created_at": 1651647668.548886, "compiled_sql": "\n    \n    \n\nwith child as (\n    select care_site_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`visit_occurrence`\n    where care_site_id is not null\n),\n\nparent as (\n    select care_site_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`care_site`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "care_site_id", "file_key_name": "models.visit_occurrence"}, "model.NPS_OMOP_CDM.metadata": {"raw_sql": "with metadata as (\r\n    SELECT  1 AS metadata_id, 0 AS metadata_concept_id, 0 AS metadata_type_concept_id,\"LOCATION\" AS name,\r\n    \"The LOCATION table represents a generic way to capture physical location or address information of Persons and Care Sites. The source data contains the address information of patients and care sites details across Australia.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  2 AS metadata_id, 57 AS metadata_concept_id, 0 AS metadata_type_concept_id,\"CARE_SITE\" AS name,\r\n    \"The CARE_SITE table contains a list of uniquely identified institutional (physical or organizational) units where healthcare delivery is practiced (offices, wards, hospitals, clinics, etc.). The source data contains the single record per site with no duplicates.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n\r\n    SELECT  3 AS metadata_id, 55 AS metadata_concept_id, 0 AS metadata_type_concept_id,\"PROVIDER\" AS name,\r\n    \"The PROVIDER table contains a list of uniquely identified healthcare providers. These are individuals providing hands-on healthcare to patients, such as physicians, nurses, midwives, physical therapists etc. The source data contains the health care provider details across Australia.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  4 AS metadata_id, 56 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"PERSON\" AS name,\r\n    \"This table serves as the central identity management for all Persons in the database. The source data contains the This table contains patient demographics and other patient-associated details. Also it contains single record per patient with no duplicates. \" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  5 AS metadata_id, 8 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"VISIT_OCCURRENCE\" AS name,\r\n    \"This table contains Events where Persons engage with the healthcare system for a duration of time. They are often also called \u201cEncounters\u201d. The source data table contains information about recorded patient encounters. It can include clinical (visits, consultations, procedures, etc) and administrative encounters (phone calls, letters, checking details, etc). Also it contains reason for patient encounter,  historical and current records of the patient.\" as value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  6 AS metadata_id, 27 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"OBSERVATION\" AS name,\r\n    \"The OBSERVATION table captures clinical facts about a Person obtained in the context of examination, questioning or a procedure. The source data contains all the observations recorded by the clinician. Generally, common observations can be performed in Doctor's office. e.g., Blood Pressure, Height, Weight, BMI, Temperature, Blood Sugar, etc. Contains historical and current records.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  7 AS metadata_id, 19 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"CONDITION_OCCURRENCE\" AS name,\r\n    \"This table contains records of Events of a Person suggesting the presence of a disease or medical condition stated as a diagnosis, a sign, or a symptom, which is either observed by a Provider or reported by the patient. The source data contains the diagnosis records of a patient. Contains historical and current records.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  8 AS metadata_id, 13 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"DRUG_EXPOSURE\" AS name,\r\n    \"The 'Drug' domain captures records about the utilization of a Drug when ingested or otherwise introduced into the body. The information is extracted from vaccination and immunisation details of the patient, medications prescribed to a patient. The table contains vaccination and immunisation details of the patient. Contains historical and current records.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  9 AS metadata_id, 10 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"PROCEDURE_OCCURRENCE\" AS name,\r\n    \"The PROCEDURE_OCCURRENCE table contains records of activities or processes ordered by, or carried out by, a healthcare provider on the patient to have a diagnostic or therapeutic purpose. The information is extracted from the tests performed on patient, vaccination and immunisation details of the patient, precribed medications, and reasons of encounter.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  10 AS metadata_id, 21 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"MEASUREMENT\" AS name,\r\n    \"The MEASUREMENT table contains records of Measurement, i.e. structured values (numerical or categorical) obtained through systematic and standardized examination or testing of a Person or Person's sample. The source data contains the information about the various lab tests performed on the patient and observations recorded by the clinician. The source data contains the individual tables for ALBUMIN pathology tests, GFR pathology tests, HBA1C pathology tests, and LIPIDS pathology tests.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  11 AS metadata_id, 17 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"DEVICE_EXPOSURE\" AS name,\r\n    \"This table contains the information about the devices that are used for treatment  or diagnosis of patient. The source data not contains the direct information about devices used fro diagnosis. The information about devices is derived from the lab tests performed on the patients, medicines and vaccines givento the patient.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  12 AS metadata_id, 44819056 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"DEATH\" AS name,\r\n    \"The death domain contains the clinical event for how and when a Person dies. The information about person's death is given in source data. It contains the only the date of death. The reason of death is not specified in source data.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  13 AS metadata_id, 0 AS metadata_concept_id, 0 AS metadata_type_concept_id,\"FACT_RELATIONSHIP\" AS name,\r\n    \"The FACT_RELATIONSHIP table contains records about the relationships between facts stored as records in any table of the CDM. Relationships can be defined between facts from the same domain, or different domains.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  14 AS metadata_id, 0 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"OBSERVATION_PERIOD\" AS name,\r\n    \"This table contains records which define spans of time during which two conditions are expected to hold: (i) Clinical Events that happened to the Person are recorded in the Event tables, and (ii) absence of records indicate such Events did not occur during this span of time.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  15 AS metadata_id, 7 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"METADATA\" AS name,\r\n    \"The METADATA table contains metadata information about a dataset that has been transformed to the OMOP Common Data Model.\" AS value_as_string\r\n)\r\n\r\nSELECT \r\nmetadata_id,\r\nmetadata_concept_id,\r\nmetadata_type_concept_id,\r\nname,\r\nvalue_as_string,\r\n0 AS value_as_concept_id, \r\nCAST(NULL AS FLOAT64) AS value_as_number,\r\nCAST(NULL AS DATE) AS metadata_date,\r\nCAST(NULL AS DATETIME) AS metadata_datetime\r\nFROM metadata ORDER BY metadata_id", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "METADATA", "metadata"], "unique_id": "model.NPS_OMOP_CDM.metadata", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\METADATA\\metadata.sql", "original_file_path": "models\\CDM\\METADATA\\metadata.sql", "name": "metadata", "alias": "metadata", "checksum": {"name": "sha256", "checksum": "36dc33a4fca002ecdb86a6217e861fac0887b72f6e59ffeb9de10cb5ba30634f"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {"metadata_id": {"name": "metadata_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "metadata_concept_id": {"name": "metadata_concept_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "metadata_type_concept_id": {"name": "metadata_type_concept_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "name": {"name": "name", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\METADATA\\metadata.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\METADATA\\metadata.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651669027.2750978, "compiled_sql": "with metadata as (\r\n    SELECT  1 AS metadata_id, 0 AS metadata_concept_id, 0 AS metadata_type_concept_id,\"LOCATION\" AS name,\r\n    \"The LOCATION table represents a generic way to capture physical location or address information of Persons and Care Sites. The source data contains the address information of patients and care sites details across Australia.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  2 AS metadata_id, 57 AS metadata_concept_id, 0 AS metadata_type_concept_id,\"CARE_SITE\" AS name,\r\n    \"The CARE_SITE table contains a list of uniquely identified institutional (physical or organizational) units where healthcare delivery is practiced (offices, wards, hospitals, clinics, etc.). The source data contains the single record per site with no duplicates.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n\r\n    SELECT  3 AS metadata_id, 55 AS metadata_concept_id, 0 AS metadata_type_concept_id,\"PROVIDER\" AS name,\r\n    \"The PROVIDER table contains a list of uniquely identified healthcare providers. These are individuals providing hands-on healthcare to patients, such as physicians, nurses, midwives, physical therapists etc. The source data contains the health care provider details across Australia.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  4 AS metadata_id, 56 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"PERSON\" AS name,\r\n    \"This table serves as the central identity management for all Persons in the database. The source data contains the This table contains patient demographics and other patient-associated details. Also it contains single record per patient with no duplicates. \" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  5 AS metadata_id, 8 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"VISIT_OCCURRENCE\" AS name,\r\n    \"This table contains Events where Persons engage with the healthcare system for a duration of time. They are often also called \u201cEncounters\u201d. The source data table contains information about recorded patient encounters. It can include clinical (visits, consultations, procedures, etc) and administrative encounters (phone calls, letters, checking details, etc). Also it contains reason for patient encounter,  historical and current records of the patient.\" as value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  6 AS metadata_id, 27 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"OBSERVATION\" AS name,\r\n    \"The OBSERVATION table captures clinical facts about a Person obtained in the context of examination, questioning or a procedure. The source data contains all the observations recorded by the clinician. Generally, common observations can be performed in Doctor's office. e.g., Blood Pressure, Height, Weight, BMI, Temperature, Blood Sugar, etc. Contains historical and current records.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  7 AS metadata_id, 19 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"CONDITION_OCCURRENCE\" AS name,\r\n    \"This table contains records of Events of a Person suggesting the presence of a disease or medical condition stated as a diagnosis, a sign, or a symptom, which is either observed by a Provider or reported by the patient. The source data contains the diagnosis records of a patient. Contains historical and current records.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  8 AS metadata_id, 13 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"DRUG_EXPOSURE\" AS name,\r\n    \"The 'Drug' domain captures records about the utilization of a Drug when ingested or otherwise introduced into the body. The information is extracted from vaccination and immunisation details of the patient, medications prescribed to a patient. The table contains vaccination and immunisation details of the patient. Contains historical and current records.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  9 AS metadata_id, 10 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"PROCEDURE_OCCURRENCE\" AS name,\r\n    \"The PROCEDURE_OCCURRENCE table contains records of activities or processes ordered by, or carried out by, a healthcare provider on the patient to have a diagnostic or therapeutic purpose. The information is extracted from the tests performed on patient, vaccination and immunisation details of the patient, precribed medications, and reasons of encounter.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  10 AS metadata_id, 21 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"MEASUREMENT\" AS name,\r\n    \"The MEASUREMENT table contains records of Measurement, i.e. structured values (numerical or categorical) obtained through systematic and standardized examination or testing of a Person or Person's sample. The source data contains the information about the various lab tests performed on the patient and observations recorded by the clinician. The source data contains the individual tables for ALBUMIN pathology tests, GFR pathology tests, HBA1C pathology tests, and LIPIDS pathology tests.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  11 AS metadata_id, 17 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"DEVICE_EXPOSURE\" AS name,\r\n    \"This table contains the information about the devices that are used for treatment  or diagnosis of patient. The source data not contains the direct information about devices used fro diagnosis. The information about devices is derived from the lab tests performed on the patients, medicines and vaccines givento the patient.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  12 AS metadata_id, 44819056 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"DEATH\" AS name,\r\n    \"The death domain contains the clinical event for how and when a Person dies. The information about person's death is given in source data. It contains the only the date of death. The reason of death is not specified in source data.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  13 AS metadata_id, 0 AS metadata_concept_id, 0 AS metadata_type_concept_id,\"FACT_RELATIONSHIP\" AS name,\r\n    \"The FACT_RELATIONSHIP table contains records about the relationships between facts stored as records in any table of the CDM. Relationships can be defined between facts from the same domain, or different domains.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  14 AS metadata_id, 0 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"OBSERVATION_PERIOD\" AS name,\r\n    \"This table contains records which define spans of time during which two conditions are expected to hold: (i) Clinical Events that happened to the Person are recorded in the Event tables, and (ii) absence of records indicate such Events did not occur during this span of time.\" AS value_as_string\r\n\r\n    UNION ALL\r\n\r\n    SELECT  15 AS metadata_id, 7 AS metadata_concept_id, 1 AS metadata_type_concept_id,\"METADATA\" AS name,\r\n    \"The METADATA table contains metadata information about a dataset that has been transformed to the OMOP Common Data Model.\" AS value_as_string\r\n)\r\n\r\nSELECT \r\nmetadata_id,\r\nmetadata_concept_id,\r\nmetadata_type_concept_id,\r\nname,\r\nvalue_as_string,\r\n0 AS value_as_concept_id, \r\nCAST(NULL AS FLOAT64) AS value_as_number,\r\nCAST(NULL AS DATE) AS metadata_date,\r\nCAST(NULL AS DATETIME) AS metadata_datetime\r\nFROM metadata ORDER BY metadata_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`metadata`"}, "test.NPS_OMOP_CDM.not_null_metadata_metadata_id.245549e30d": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metadata_id", "model": "{{ get_where_subquery(ref('metadata')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.metadata"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "METADATA", "not_null_metadata_metadata_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_metadata_metadata_id.245549e30d", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_metadata_metadata_id.sql", "original_file_path": "models\\CDM\\METADATA\\metadata.yml", "name": "not_null_metadata_metadata_id", "alias": "not_null_metadata_metadata_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["metadata"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\METADATA\\metadata.yml\\not_null_metadata_metadata_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651669027.2860937, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`metadata`\nwhere metadata_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "metadata_id", "file_key_name": "models.metadata"}, "test.NPS_OMOP_CDM.unique_metadata_metadata_id.c5f9aef418": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "metadata_id", "model": "{{ get_where_subquery(ref('metadata')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.metadata"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "METADATA", "unique_metadata_metadata_id"], "unique_id": "test.NPS_OMOP_CDM.unique_metadata_metadata_id.c5f9aef418", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "unique_metadata_metadata_id.sql", "original_file_path": "models\\CDM\\METADATA\\metadata.yml", "name": "unique_metadata_metadata_id", "alias": "unique_metadata_metadata_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["metadata"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\METADATA\\metadata.yml\\unique_metadata_metadata_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651669027.288093, "compiled_sql": "\n    \n    \n\nwith dbt_test__target as (\n  \n  select metadata_id as unique_field\n  from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`metadata`\n  where metadata_id is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "metadata_id", "file_key_name": "models.metadata"}, "test.NPS_OMOP_CDM.not_null_metadata_metadata_concept_id.fbb43fc750": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metadata_concept_id", "model": "{{ get_where_subquery(ref('metadata')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.metadata"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "METADATA", "not_null_metadata_metadata_concept_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_metadata_metadata_concept_id.fbb43fc750", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_metadata_metadata_concept_id.sql", "original_file_path": "models\\CDM\\METADATA\\metadata.yml", "name": "not_null_metadata_metadata_concept_id", "alias": "not_null_metadata_metadata_concept_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["metadata"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\METADATA\\metadata.yml\\not_null_metadata_metadata_concept_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651669027.2890928, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`metadata`\nwhere metadata_concept_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "metadata_concept_id", "file_key_name": "models.metadata"}, "test.NPS_OMOP_CDM.not_null_metadata_metadata_type_concept_id.ecddd5859d": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metadata_type_concept_id", "model": "{{ get_where_subquery(ref('metadata')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.metadata"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "METADATA", "not_null_metadata_metadata_type_concept_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_metadata_metadata_type_concept_id.ecddd5859d", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_metadata_metadata_type_concept_id.sql", "original_file_path": "models\\CDM\\METADATA\\metadata.yml", "name": "not_null_metadata_metadata_type_concept_id", "alias": "not_null_metadata_metadata_type_concept_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["metadata"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\METADATA\\metadata.yml\\not_null_metadata_metadata_type_concept_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651669027.2910848, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`metadata`\nwhere metadata_type_concept_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "metadata_type_concept_id", "file_key_name": "models.metadata"}, "test.NPS_OMOP_CDM.not_null_metadata_name.21f9e599ec": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "name", "model": "{{ get_where_subquery(ref('metadata')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.metadata"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "METADATA", "not_null_metadata_name"], "unique_id": "test.NPS_OMOP_CDM.not_null_metadata_name.21f9e599ec", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_metadata_name.sql", "original_file_path": "models\\CDM\\METADATA\\metadata.yml", "name": "not_null_metadata_name", "alias": "not_null_metadata_name", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["metadata"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\METADATA\\metadata.yml\\not_null_metadata_name.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651669027.292084, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`metadata`\nwhere name is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "name", "file_key_name": "models.metadata"}, "model.NPS_OMOP_CDM.cdm_source": {"raw_sql": "with cdm_source AS (\r\nSELECT \"C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021\" AS cdm_source_name,\r\n\"C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021\" AS cdm_source_abbreviation,\r\n\"UNSW Sydney\" AS cdm_holder,\r\n\"C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021\" AS source_description,\r\n\"https://github.com/CGDHealth/NPS-MI-2021-ETL-Design-Development-OMOP/wiki\" AS source_documentation_reference,\r\n\"https://github.com/CGDHealth/NPS-MI-2021-ETL-Design-Development-OMOP\" AS cdm_etl_reference,\r\nCAST(\"2021-08-01\" AS DATE) AS source_release_date,\r\nCURRENT_DATE() AS cdm_release_date,\r\n\"5.4.0\" AS cdm_version,\r\n(SELECT concept_id FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'concept') }} WHERE VOCABULARY_ID = 'CDM' AND CONCEPT_CLASS_ID = 'CDM') AS cdm_version_concept_id,\r\n(SELECT VOCABULARY_VERSION FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'vocabulary') }} WHERE VOCABULARY_ID = 'None') AS vocabulary_version\r\n)\r\n\r\nSELECT * FROM cdm_source", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.vocabulary", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.concept"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "CDM_SOURCE", "cdm_source"], "unique_id": "model.NPS_OMOP_CDM.cdm_source", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\fix_dbt_code_bugs\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\CDM_SOURCE\\cdm_source.sql", "original_file_path": "models\\CDM\\CDM_SOURCE\\cdm_source.sql", "name": "cdm_source", "alias": "cdm_source", "checksum": {"name": "sha256", "checksum": "18a682f8eca8c2d41bd380569601a259920aa1f6af5dff4d3abdea413b54d5f1"}, "tags": [], "refs": [], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "vocabulary"], ["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "concept"]], "description": "", "columns": {"cdm_source_name": {"name": "cdm_source_name", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "cdm_source_abbreviation": {"name": "cdm_source_abbreviation", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "cdm_holder": {"name": "cdm_holder", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "source_release_date": {"name": "source_release_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "cdm_version_concept_id": {"name": "cdm_version_concept_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "cdm_release_date": {"name": "cdm_release_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "vocabulary_version": {"name": "vocabulary_version", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\CDM_SOURCE\\cdm_source.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\CDM_SOURCE\\cdm_source.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651674992.9021747, "compiled_sql": "with cdm_source AS (\nSELECT \"C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021\" AS cdm_source_name,\n\"C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021\" AS cdm_source_abbreviation,\n\"UNSW Sydney\" AS cdm_holder,\n\"C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021\" AS source_description,\n\"https://github.com/CGDHealth/NPS-MI-2021-ETL-Design-Development-OMOP/wiki\" AS source_documentation_reference,\n\"https://github.com/CGDHealth/NPS-MI-2021-ETL-Design-Development-OMOP\" AS cdm_etl_reference,\nCAST(\"2021-08-01\" AS DATE) AS source_release_date,\nCURRENT_DATE() AS cdm_release_date,\n\"5.4.0\" AS cdm_version,\n(SELECT concept_id FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`concept` WHERE VOCABULARY_ID = 'CDM' AND CONCEPT_CLASS_ID = 'CDM') AS cdm_version_concept_id,\n(SELECT VOCABULARY_VERSION FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`vocabulary` WHERE VOCABULARY_ID = 'None') AS vocabulary_version\n)\n\nSELECT * FROM cdm_source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`cdm_source`"}, "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_source_name.3290497d3b": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "cdm_source_name", "model": "{{ get_where_subquery(ref('cdm_source')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.cdm_source"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "CDM_SOURCE", "not_null_cdm_source_cdm_source_name"], "unique_id": "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_source_name.3290497d3b", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\fix_dbt_code_bugs\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_cdm_source_cdm_source_name.sql", "original_file_path": "models\\CDM\\CDM_SOURCE\\cdm_source.yml", "name": "not_null_cdm_source_cdm_source_name", "alias": "not_null_cdm_source_cdm_source_name", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["cdm_source"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\CDM_SOURCE\\cdm_source.yml\\not_null_cdm_source_cdm_source_name.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651674992.9221673, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`cdm_source`\nwhere cdm_source_name is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "cdm_source_name", "file_key_name": "models.cdm_source"}, "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_source_abbreviation.22d20f7d8c": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "cdm_source_abbreviation", "model": "{{ get_where_subquery(ref('cdm_source')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.cdm_source"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "CDM_SOURCE", "not_null_cdm_source_cdm_source_abbreviation"], "unique_id": "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_source_abbreviation.22d20f7d8c", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\fix_dbt_code_bugs\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_cdm_source_cdm_source_abbreviation.sql", "original_file_path": "models\\CDM\\CDM_SOURCE\\cdm_source.yml", "name": "not_null_cdm_source_cdm_source_abbreviation", "alias": "not_null_cdm_source_cdm_source_abbreviation", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["cdm_source"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\CDM_SOURCE\\cdm_source.yml\\not_null_cdm_source_cdm_source_abbreviation.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651674992.927144, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`cdm_source`\nwhere cdm_source_abbreviation is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "cdm_source_abbreviation", "file_key_name": "models.cdm_source"}, "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_holder.fe9eac4047": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "cdm_holder", "model": "{{ get_where_subquery(ref('cdm_source')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.cdm_source"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "CDM_SOURCE", "not_null_cdm_source_cdm_holder"], "unique_id": "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_holder.fe9eac4047", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\fix_dbt_code_bugs\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_cdm_source_cdm_holder.sql", "original_file_path": "models\\CDM\\CDM_SOURCE\\cdm_source.yml", "name": "not_null_cdm_source_cdm_holder", "alias": "not_null_cdm_source_cdm_holder", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["cdm_source"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\CDM_SOURCE\\cdm_source.yml\\not_null_cdm_source_cdm_holder.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651674992.9311428, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`cdm_source`\nwhere cdm_holder is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "cdm_holder", "file_key_name": "models.cdm_source"}, "test.NPS_OMOP_CDM.not_null_cdm_source_source_release_date.f65be0127b": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "source_release_date", "model": "{{ get_where_subquery(ref('cdm_source')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.cdm_source"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "CDM_SOURCE", "not_null_cdm_source_source_release_date"], "unique_id": "test.NPS_OMOP_CDM.not_null_cdm_source_source_release_date.f65be0127b", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\fix_dbt_code_bugs\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_cdm_source_source_release_date.sql", "original_file_path": "models\\CDM\\CDM_SOURCE\\cdm_source.yml", "name": "not_null_cdm_source_source_release_date", "alias": "not_null_cdm_source_source_release_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["cdm_source"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\CDM_SOURCE\\cdm_source.yml\\not_null_cdm_source_source_release_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651674992.9351373, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`cdm_source`\nwhere source_release_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "source_release_date", "file_key_name": "models.cdm_source"}, "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_version_concept_id.981254b839": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "cdm_version_concept_id", "model": "{{ get_where_subquery(ref('cdm_source')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.cdm_source"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "CDM_SOURCE", "not_null_cdm_source_cdm_version_concept_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_version_concept_id.981254b839", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\fix_dbt_code_bugs\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_cdm_source_cdm_version_concept_id.sql", "original_file_path": "models\\CDM\\CDM_SOURCE\\cdm_source.yml", "name": "not_null_cdm_source_cdm_version_concept_id", "alias": "not_null_cdm_source_cdm_version_concept_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["cdm_source"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\CDM_SOURCE\\cdm_source.yml\\not_null_cdm_source_cdm_version_concept_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651674992.9381294, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`cdm_source`\nwhere cdm_version_concept_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "cdm_version_concept_id", "file_key_name": "models.cdm_source"}, "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_release_date.92d247ab52": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "cdm_release_date", "model": "{{ get_where_subquery(ref('cdm_source')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.cdm_source"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "CDM_SOURCE", "not_null_cdm_source_cdm_release_date"], "unique_id": "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_release_date.92d247ab52", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\fix_dbt_code_bugs\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_cdm_source_cdm_release_date.sql", "original_file_path": "models\\CDM\\CDM_SOURCE\\cdm_source.yml", "name": "not_null_cdm_source_cdm_release_date", "alias": "not_null_cdm_source_cdm_release_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["cdm_source"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\CDM_SOURCE\\cdm_source.yml\\not_null_cdm_source_cdm_release_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651674992.9421213, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`cdm_source`\nwhere cdm_release_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "cdm_release_date", "file_key_name": "models.cdm_source"}, "test.NPS_OMOP_CDM.not_null_cdm_source_vocabulary_version.7f9ee9a3c6": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "vocabulary_version", "model": "{{ get_where_subquery(ref('cdm_source')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.cdm_source"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "CDM_SOURCE", "not_null_cdm_source_vocabulary_version"], "unique_id": "test.NPS_OMOP_CDM.not_null_cdm_source_vocabulary_version.7f9ee9a3c6", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\fix_dbt_code_bugs\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_cdm_source_vocabulary_version.sql", "original_file_path": "models\\CDM\\CDM_SOURCE\\cdm_source.yml", "name": "not_null_cdm_source_vocabulary_version", "alias": "not_null_cdm_source_vocabulary_version", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["cdm_source"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\CDM_SOURCE\\cdm_source.yml\\not_null_cdm_source_vocabulary_version.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651674992.9460838, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`cdm_source`\nwhere vocabulary_version is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "vocabulary_version", "file_key_name": "models.cdm_source"}, "model.NPS_OMOP_CDM.specimen": {"raw_sql": "with pathology_lipids as (\n    SELECT * FROM {{ ref('stg_specimen_pathology_lipids')}}\n),\n\npathology_hba1c as (\n    SELECT * FROM {{ ref('stg_specimen_pathology_hba1c')}}\n),\n\npathology_egfr as (\n    SELECT * FROM {{ ref('stg_specimen_pathology_egfr') }}\n),\n\npathology_albumin as (\n    SELECT * FROM {{ ref('stg_specimen_pathology_albumin') }}\n),\n\npathology as (\n    SELECT * FROM {{ ref('stg_specimen_pathology') }}\n),\n\nPerson AS (\n    SELECT * FROM {{ source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person') }}\n),\n\nintermediate_specimen as (\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pl.patient_number\n    ) as person_id,\n    CASE WHEN pathology_test_datetime is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(pathology_test_datetime) END as specimen_date,\n    DATETIME(pathology_test_datetime) as specimen_datetime,\n    pathology_test_type as specimen_source_value,\n    detected_cis_unit_of_measure as unit_source_value,\n    FROM pathology_lipids pl\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = ph.patient_number\n    ) as person_id,\n    CASE WHEN pathology_test_datetime is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(pathology_test_datetime) END as specimen_date,\n    DATETIME(pathology_test_datetime) as specimen_datetime,\n    pathology_test_type as device_source_value,\n    detected_cis_unit_of_measure as unit_source_value,\n    FROM pathology_hba1c ph\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pe.patient_number\n    ) as person_id,\n    CASE WHEN pathology_test_datetime is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(pathology_test_datetime) END as specimen_date,\n    DATETIME(pathology_test_datetime) as specimen_datetime,\n    pathology_test_type as device_source_value,\n    detected_cis_unit_of_measure as unit_source_value,\n    FROM pathology_egfr pe\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pa.patient_number\n    ) as person_id,\n    CASE \n    {{ convert_datetime_string_to_date('pathology_test_datetime') }}\n    ELSE CAST('1800-01-01' AS DATE) END as specimen_date,\n    CASE WHEN REGEXP_CONTAINS(pathology_test_datetime  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \n    THEN PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', pathology_test_datetime) \n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END as specimen_datetime,\n    pathology_test_type as device_source_value,\n    detected_cis_unit_of_measure as unit_source_value,\n    FROM pathology_albumin pa\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pat.patient_number\n    ) as person_id,\n    CASE WHEN report_date is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(report_date) END as specimen_date,\n    DATETIME(report_date) as specimen_datetime,\n    result_name as device_source_value,\n    NULL as unit_source_value,\n    FROM pathology pat\n)\n\nSELECT \nROW_NUMBER() OVER(ORDER BY specimen_source_value ASC) AS specimen_id,\nperson_id,\n0 as specimen_concept_id,\n0 as specimen_type_concept_id,\nspecimen_date,\nspecimen_datetime,\n0.0 as quantity,\n0 as unit_concept_id,\n0 as anatomic_site_concept_id,\n0 as disease_status_concept_id,\nCAST(NULL AS STRING) as specimen_source_id,\nspecimen_source_value,\nunit_source_value,\nCAST(NULL AS STRING) as anatomic_site_source_value,\nCAST(NULL AS STRING) as disease_status_source_value\nFROM intermediate_specimen ORDER BY specimen_id", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.NPS_OMOP_CDM.convert_datetime_string_to_date"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.stg_specimen_pathology_lipids", "model.NPS_OMOP_CDM.stg_specimen_pathology_hba1c", "model.NPS_OMOP_CDM.stg_specimen_pathology_egfr", "model.NPS_OMOP_CDM.stg_specimen_pathology_albumin", "model.NPS_OMOP_CDM.stg_specimen_pathology"]}, "config": {"enabled": true, "alias": null, "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "fqn": ["NPS_OMOP_CDM", "CDM", "Specimen", "specimen"], "unique_id": "model.NPS_OMOP_CDM.specimen", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\fix_dbt_code_bugs\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "CDM\\Specimen\\specimen.sql", "original_file_path": "models\\CDM\\Specimen\\specimen.sql", "name": "specimen", "alias": "specimen", "checksum": {"name": "sha256", "checksum": "2ec8aa5534e67aa0654ffd038d5b641398dac0ef774f98ccc932d9cd505cdd28"}, "tags": [], "refs": [["stg_specimen_pathology_lipids"], ["stg_specimen_pathology_hba1c"], ["stg_specimen_pathology_egfr"], ["stg_specimen_pathology_albumin"], ["stg_specimen_pathology"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {"specimen_id": {"name": "specimen_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "person_id": {"name": "person_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "specimen_date": {"name": "specimen_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "NPS_OMOP_CDM://models\\CDM\\Specimen\\specimen.yml", "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Specimen\\specimen.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP"}, "created_at": 1651729348.8751647, "compiled_sql": "with pathology_lipids as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_specimen_pathology_lipids`\n),\n\npathology_hba1c as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_specimen_pathology_hba1c`\n),\n\npathology_egfr as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_specimen_pathology_egfr`\n),\n\npathology_albumin as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_specimen_pathology_albumin`\n),\n\npathology as (\n    SELECT * FROM `nps-omop-project`.`C_HARMONISED_NPS_MI_RDV_BDV_OMOP_VIEWS_ONLY`.`stg_specimen_pathology`\n),\n\nPerson AS (\n    SELECT * FROM `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n),\n\nintermediate_specimen as (\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pl.patient_number\n    ) as person_id,\n    CASE WHEN pathology_test_datetime is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(pathology_test_datetime) END as specimen_date,\n    DATETIME(pathology_test_datetime) as specimen_datetime,\n    pathology_test_type as specimen_source_value,\n    detected_cis_unit_of_measure as unit_source_value,\n    FROM pathology_lipids pl\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = ph.patient_number\n    ) as person_id,\n    CASE WHEN pathology_test_datetime is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(pathology_test_datetime) END as specimen_date,\n    DATETIME(pathology_test_datetime) as specimen_datetime,\n    pathology_test_type as device_source_value,\n    detected_cis_unit_of_measure as unit_source_value,\n    FROM pathology_hba1c ph\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pe.patient_number\n    ) as person_id,\n    CASE WHEN pathology_test_datetime is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(pathology_test_datetime) END as specimen_date,\n    DATETIME(pathology_test_datetime) as specimen_datetime,\n    pathology_test_type as device_source_value,\n    detected_cis_unit_of_measure as unit_source_value,\n    FROM pathology_egfr pe\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pa.patient_number\n    ) as person_id,\n    CASE \n    \n \n        WHEN REGEXP_CONTAINS(pathology_test_datetime  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \n        THEN CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', pathology_test_datetime)) AS DATE) \n    \n\n    ELSE CAST('1800-01-01' AS DATE) END as specimen_date,\n    CASE WHEN REGEXP_CONTAINS(pathology_test_datetime  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \n    THEN PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', pathology_test_datetime) \n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END as specimen_datetime,\n    pathology_test_type as device_source_value,\n    detected_cis_unit_of_measure as unit_source_value,\n    FROM pathology_albumin pa\n\n    UNION DISTINCT\n\n    SELECT\n    (\n        SELECT p.person_id FROM Person p WHERE p.person_source_value = pat.patient_number\n    ) as person_id,\n    CASE WHEN report_date is NULL THEN CAST('1800-01-01' AS DATE)\n    ELSE DATE(report_date) END as specimen_date,\n    DATETIME(report_date) as specimen_datetime,\n    result_name as device_source_value,\n    NULL as unit_source_value,\n    FROM pathology pat\n)\n\nSELECT \nROW_NUMBER() OVER(ORDER BY specimen_source_value ASC) AS specimen_id,\nperson_id,\n0 as specimen_concept_id,\n0 as specimen_type_concept_id,\nspecimen_date,\nspecimen_datetime,\n0.0 as quantity,\n0 as unit_concept_id,\n0 as anatomic_site_concept_id,\n0 as disease_status_concept_id,\nCAST(NULL AS STRING) as specimen_source_id,\nspecimen_source_value,\nunit_source_value,\nCAST(NULL AS STRING) as anatomic_site_source_value,\nCAST(NULL AS STRING) as disease_status_source_value\nFROM intermediate_specimen ORDER BY specimen_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`specimen`"}, "test.NPS_OMOP_CDM.unique_specimen_specimen_id.fffa0ad838": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "specimen_id", "model": "{{ get_where_subquery(ref('specimen')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.specimen"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Specimen", "unique_specimen_specimen_id"], "unique_id": "test.NPS_OMOP_CDM.unique_specimen_specimen_id.fffa0ad838", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\fix_dbt_code_bugs\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "unique_specimen_specimen_id.sql", "original_file_path": "models\\CDM\\Specimen\\specimen.yml", "name": "unique_specimen_specimen_id", "alias": "unique_specimen_specimen_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["specimen"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Specimen\\specimen.yml\\unique_specimen_specimen_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651729348.8941138, "compiled_sql": "\n    \n    \n\nwith dbt_test__target as (\n  \n  select specimen_id as unique_field\n  from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`specimen`\n  where specimen_id is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "specimen_id", "file_key_name": "models.specimen"}, "test.NPS_OMOP_CDM.not_null_specimen_specimen_id.be5ba20d76": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "specimen_id", "model": "{{ get_where_subquery(ref('specimen')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.specimen"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Specimen", "not_null_specimen_specimen_id"], "unique_id": "test.NPS_OMOP_CDM.not_null_specimen_specimen_id.be5ba20d76", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\fix_dbt_code_bugs\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_specimen_specimen_id.sql", "original_file_path": "models\\CDM\\Specimen\\specimen.yml", "name": "not_null_specimen_specimen_id", "alias": "not_null_specimen_specimen_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["specimen"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Specimen\\specimen.yml\\not_null_specimen_specimen_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651729348.898103, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`specimen`\nwhere specimen_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "specimen_id", "file_key_name": "models.specimen"}, "test.NPS_OMOP_CDM.relationships_specimen_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.99d5731e1b": {"raw_sql": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_specimen_eb7bf631fc4083830cb3c6d5bc13dfc4\") }}", "test_metadata": {"name": "relationships", "kwargs": {"to": "source('D_HARMONISED_NPS_MI_RDV_BDV_OMOP', 'person')", "field": "person_id", "column_name": "person_id", "model": "{{ get_where_subquery(ref('specimen')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "model.NPS_OMOP_CDM.specimen"]}, "config": {"enabled": true, "alias": "relationships_specimen_eb7bf631fc4083830cb3c6d5bc13dfc4", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Specimen", "relationships_specimen_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_"], "unique_id": "test.NPS_OMOP_CDM.relationships_specimen_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.99d5731e1b", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\fix_dbt_code_bugs\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "relationships_specimen_eb7bf631fc4083830cb3c6d5bc13dfc4.sql", "original_file_path": "models\\CDM\\Specimen\\specimen.yml", "name": "relationships_specimen_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_", "alias": "relationships_specimen_eb7bf631fc4083830cb3c6d5bc13dfc4", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["specimen"]], "sources": [["D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Specimen\\specimen.yml\\relationships_specimen_eb7bf631fc4083830cb3c6d5bc13dfc4.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_specimen_eb7bf631fc4083830cb3c6d5bc13dfc4"}, "created_at": 1651729348.9030905, "compiled_sql": "\n    \n    \n\nwith child as (\n    select person_id as from_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`specimen`\n    where person_id is not null\n),\n\nparent as (\n    select person_id as to_field\n    from `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "person_id", "file_key_name": "models.specimen"}, "test.NPS_OMOP_CDM.not_null_specimen_specimen_date.2a2ccaf597": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "specimen_date", "model": "{{ get_where_subquery(ref('specimen')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.NPS_OMOP_CDM.specimen"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "nps-omop-project", "schema": "dbt_test__audit", "fqn": ["NPS_OMOP_CDM", "CDM", "Specimen", "not_null_specimen_specimen_date"], "unique_id": "test.NPS_OMOP_CDM.not_null_specimen_specimen_date.2a2ccaf597", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\fix_dbt_code_bugs\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "not_null_specimen_specimen_date.sql", "original_file_path": "models\\CDM\\Specimen\\specimen.yml", "name": "not_null_specimen_specimen_date", "alias": "not_null_specimen_specimen_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["specimen"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\NPS_OMOP_CDM\\models\\CDM\\Specimen\\specimen.yml\\not_null_specimen_specimen_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1651729348.9329705, "compiled_sql": "\n    \n    \n\nselect *\nfrom `nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`specimen`\nwhere specimen_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "specimen_date", "file_key_name": "models.specimen"}}, "sources": {"source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.location": {"fqn": ["NPS_OMOP_CDM", "CDM", "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "location"], "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "unique_id": "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.location", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\CDM\\src_cdm.yml", "original_file_path": "models\\CDM\\src_cdm.yml", "name": "location", "source_name": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "source_description": "", "loader": "", "identifier": "location", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`location`", "created_at": 1651482438.8869724}, "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person": {"fqn": ["NPS_OMOP_CDM", "CDM", "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "person"], "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "unique_id": "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\CDM\\src_cdm.yml", "original_file_path": "models\\CDM\\src_cdm.yml", "name": "person", "source_name": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "source_description": "", "loader": "", "identifier": "person", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`person`", "created_at": 1651482438.8869724}, "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site": {"fqn": ["NPS_OMOP_CDM", "CDM", "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "care_site"], "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "unique_id": "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\CDM\\src_cdm.yml", "original_file_path": "models\\CDM\\src_cdm.yml", "name": "care_site", "source_name": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "source_description": "", "loader": "", "identifier": "care_site", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`care_site`", "created_at": 1651482438.8869724}, "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.provider": {"fqn": ["NPS_OMOP_CDM", "CDM", "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "provider"], "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "unique_id": "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.provider", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\CDM\\src_cdm.yml", "original_file_path": "models\\CDM\\src_cdm.yml", "name": "provider", "source_name": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "source_description": "", "loader": "", "identifier": "provider", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`provider`", "created_at": 1651482438.8869724}, "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence": {"fqn": ["NPS_OMOP_CDM", "CDM", "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "visit_occurrence"], "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "unique_id": "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\CDM\\src_cdm.yml", "original_file_path": "models\\CDM\\src_cdm.yml", "name": "visit_occurrence", "source_name": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "source_description": "", "loader": "", "identifier": "visit_occurrence", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`visit_occurrence`", "created_at": 1651482438.8869724}, "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.concept": {"fqn": ["NPS_OMOP_CDM", "CDM", "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "concept"], "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "unique_id": "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.concept", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\CDM\\src_cdm.yml", "original_file_path": "models\\CDM\\src_cdm.yml", "name": "concept", "source_name": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "source_description": "", "loader": "", "identifier": "concept", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`concept`", "created_at": 1651482438.88797}, "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.vocabulary": {"fqn": ["NPS_OMOP_CDM", "CDM", "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "vocabulary"], "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "unique_id": "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.vocabulary", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\CDM\\src_cdm.yml", "original_file_path": "models\\CDM\\src_cdm.yml", "name": "vocabulary", "source_name": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "source_description": "", "loader": "", "identifier": "vocabulary", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`vocabulary`", "created_at": 1651482438.88797}, "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.measurement": {"fqn": ["NPS_OMOP_CDM", "CDM", "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "measurement"], "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "unique_id": "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.measurement", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\CDM\\src_cdm.yml", "original_file_path": "models\\CDM\\src_cdm.yml", "name": "measurement", "source_name": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "source_description": "", "loader": "", "identifier": "measurement", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`measurement`", "created_at": 1651482438.88797}, "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.specimen": {"fqn": ["NPS_OMOP_CDM", "CDM", "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "specimen"], "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "unique_id": "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.specimen", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\CDM\\src_cdm.yml", "original_file_path": "models\\CDM\\src_cdm.yml", "name": "specimen", "source_name": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "source_description": "", "loader": "", "identifier": "specimen", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`specimen`", "created_at": 1651482438.88797}, "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.drug_exposure": {"fqn": ["NPS_OMOP_CDM", "CDM", "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "drug_exposure"], "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "unique_id": "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.drug_exposure", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\CDM\\src_cdm.yml", "original_file_path": "models\\CDM\\src_cdm.yml", "name": "drug_exposure", "source_name": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "source_description": "", "loader": "", "identifier": "drug_exposure", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`drug_exposure`", "created_at": 1651482438.88797}, "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.procedure_occurrence": {"fqn": ["NPS_OMOP_CDM", "CDM", "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "procedure_occurrence"], "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "unique_id": "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.procedure_occurrence", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\CDM\\src_cdm.yml", "original_file_path": "models\\CDM\\src_cdm.yml", "name": "procedure_occurrence", "source_name": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "source_description": "", "loader": "", "identifier": "procedure_occurrence", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`procedure_occurrence`", "created_at": 1651482438.88797}, "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.condition_occurrence": {"fqn": ["NPS_OMOP_CDM", "CDM", "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "condition_occurrence"], "database": "nps-omop-project", "schema": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "unique_id": "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.condition_occurrence", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\CDM\\src_cdm.yml", "original_file_path": "models\\CDM\\src_cdm.yml", "name": "condition_occurrence", "source_name": "D_HARMONISED_NPS_MI_RDV_BDV_OMOP", "source_description": "", "loader": "", "identifier": "condition_occurrence", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`D_HARMONISED_NPS_MI_RDV_BDV_OMOP`.`condition_occurrence`", "created_at": 1651482438.8889682}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ALCOHOL_STATUS": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "ALCOHOL_STATUS"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ALCOHOL_STATUS", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "ALCOHOL_STATUS", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "ALCOHOL_STATUS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`ALCOHOL_STATUS`", "created_at": 1651482438.8889682}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ALLERGY_REACTION": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "ALLERGY_REACTION"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ALLERGY_REACTION", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "ALLERGY_REACTION", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "ALLERGY_REACTION", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`ALLERGY_REACTION`", "created_at": 1651482438.8899724}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.BILLING_SERVICE": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "BILLING_SERVICE"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.BILLING_SERVICE", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "BILLING_SERVICE", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "BILLING_SERVICE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`BILLING_SERVICE`", "created_at": 1651482438.8899724}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.CLINICAL_USER": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "CLINICAL_USER"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.CLINICAL_USER", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "CLINICAL_USER", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "CLINICAL_USER", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`CLINICAL_USER`", "created_at": 1651482438.8899724}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.DIAGNOSIS": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "DIAGNOSIS"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.DIAGNOSIS", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "DIAGNOSIS", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "DIAGNOSIS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`DIAGNOSIS`", "created_at": 1651482438.890961}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "ENCOUNTER"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "ENCOUNTER", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "ENCOUNTER", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`ENCOUNTER`", "created_at": 1651482438.890961}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER_REASON": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "ENCOUNTER_REASON"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER_REASON", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "ENCOUNTER_REASON", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "ENCOUNTER_REASON", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`ENCOUNTER_REASON`", "created_at": 1651482438.890961}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.IMMUNISATION": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "IMMUNISATION"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.IMMUNISATION", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "IMMUNISATION", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "IMMUNISATION", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`IMMUNISATION`", "created_at": 1651482438.890961}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.OBSERVATION": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "OBSERVATION"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.OBSERVATION", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "OBSERVATION", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "OBSERVATION", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`OBSERVATION`", "created_at": 1651482438.890961}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "PATHOLOGY", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "PATHOLOGY", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY`", "created_at": 1651482438.890961}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_ALBUMIN": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_ALBUMIN"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_ALBUMIN", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "PATHOLOGY_ALBUMIN", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "PATHOLOGY_ALBUMIN", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_ALBUMIN`", "created_at": 1651482438.890961}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_EGFR": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_EGFR"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_EGFR", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "PATHOLOGY_EGFR", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "PATHOLOGY_EGFR", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_EGFR`", "created_at": 1651482438.890961}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_HBA1C": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_HBA1C"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_HBA1C", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "PATHOLOGY_HBA1C", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "PATHOLOGY_HBA1C", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_HBA1C`", "created_at": 1651482438.891986}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_LIPIDS": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_LIPIDS"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_LIPIDS", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "PATHOLOGY_LIPIDS", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "PATHOLOGY_LIPIDS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_LIPIDS`", "created_at": 1651482438.891986}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_RESULT": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATHOLOGY_RESULT"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_RESULT", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "PATHOLOGY_RESULT", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "PATHOLOGY_RESULT", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATHOLOGY_RESULT`", "created_at": 1651482438.891986}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATIENT"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "PATIENT", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "PATIENT", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATIENT`", "created_at": 1651482438.891986}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT_MATCHED_USUAL_PROVIDER": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PATIENT_MATCHED_USUAL_PROVIDER"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT_MATCHED_USUAL_PROVIDER", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "PATIENT_MATCHED_USUAL_PROVIDER", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "PATIENT_MATCHED_USUAL_PROVIDER", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PATIENT_MATCHED_USUAL_PROVIDER`", "created_at": 1651482438.891986}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.POSTCODE": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "POSTCODE"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.POSTCODE", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "POSTCODE", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "POSTCODE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`POSTCODE`", "created_at": 1651482438.891986}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRACTICE_CONTACT": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PRACTICE_CONTACT"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRACTICE_CONTACT", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "PRACTICE_CONTACT", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "PRACTICE_CONTACT", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PRACTICE_CONTACT`", "created_at": 1651482438.891986}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRACTICE_RECRUITMENT": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PRACTICE_RECRUITMENT"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRACTICE_RECRUITMENT", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "PRACTICE_RECRUITMENT", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "PRACTICE_RECRUITMENT", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PRACTICE_RECRUITMENT`", "created_at": 1651482438.891986}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRESCRIPTION": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PRESCRIPTION"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRESCRIPTION", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "PRESCRIPTION", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "PRESCRIPTION", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PRESCRIPTION`", "created_at": 1651482438.891986}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRIMARY_HEALTH_NETWORK": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "PRIMARY_HEALTH_NETWORK"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRIMARY_HEALTH_NETWORK", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "PRIMARY_HEALTH_NETWORK", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "PRIMARY_HEALTH_NETWORK", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`PRIMARY_HEALTH_NETWORK`", "created_at": 1651482438.8929553}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.REFERRALS": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "REFERRALS"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.REFERRALS", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "REFERRALS", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "REFERRALS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`REFERRALS`", "created_at": 1651482438.8929553}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.REQUESTED_TEST": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "REQUESTED_TEST"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.REQUESTED_TEST", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "REQUESTED_TEST", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "REQUESTED_TEST", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`REQUESTED_TEST`", "created_at": 1651482438.8929553}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SCRIPT_ITEM": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "SCRIPT_ITEM"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SCRIPT_ITEM", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "SCRIPT_ITEM", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "SCRIPT_ITEM", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`SCRIPT_ITEM`", "created_at": 1651482438.8929553}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SITE": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "SITE"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SITE", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "SITE", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "SITE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`SITE`", "created_at": 1651482438.8929553}, "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SMOKING_STATUS": {"fqn": ["NPS_OMOP_CDM", "staging", "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "SMOKING_STATUS"], "database": "nps-omop-project", "schema": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "unique_id": "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SMOKING_STATUS", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "models\\staging\\src_staging.yml", "original_file_path": "models\\staging\\src_staging.yml", "name": "SMOKING_STATUS", "source_name": "C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021", "source_description": "", "loader": "", "identifier": "SMOKING_STATUS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "`nps-omop-project`.`C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021`.`SMOKING_STATUS`", "created_at": 1651482438.8929553}}, "macros": {"macro.NPS_OMOP_CDM.convert_datetime_string_to_date": {"unique_id": "macro.NPS_OMOP_CDM.convert_datetime_string_to_date", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "macros\\convert_datetime_string_to_date.sql", "original_file_path": "macros\\convert_datetime_string_to_date.sql", "name": "convert_datetime_string_to_date", "macro_sql": "{% macro convert_datetime_string_to_date(field_name) %}\r\n \r\n        WHEN REGEXP_CONTAINS({{field_name}}  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \r\n        THEN CAST(FORMAT_DATE(\"%Y-%m-%d\", PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', {{field_name}})) AS DATE) \r\n    \r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.4894729}, "macro.NPS_OMOP_CDM.convert_datetime_string_to_datetime": {"unique_id": "macro.NPS_OMOP_CDM.convert_datetime_string_to_datetime", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "macros\\convert_datetime_string_to_datetime.sql", "original_file_path": "macros\\convert_datetime_string_to_datetime.sql", "name": "convert_datetime_string_to_datetime", "macro_sql": "{% macro convert_datetime_string_to_datetime(field_name) %}\r\n \r\n WHEN REGEXP_CONTAINS({{field_name}}  , r'^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z') \r\n THEN PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', {{field_name}}) \r\n    \r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.4904685}, "macro.NPS_OMOP_CDM.generate_schema_name": {"unique_id": "macro.NPS_OMOP_CDM.generate_schema_name", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "macros\\generate_schema_name.sql", "original_file_path": "macros\\generate_schema_name.sql", "name": "generate_schema_name", "macro_sql": "{% macro generate_schema_name(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if custom_schema_name is none -%}\n\n        {{ default_schema }}\n\n    {%- else -%}\n\n        {{ custom_schema_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.4914644}, "macro.NPS_OMOP_CDM.parse_date": {"unique_id": "macro.NPS_OMOP_CDM.parse_date", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "macros\\parse_date.sql", "original_file_path": "macros\\parse_date.sql", "name": "parse_date", "macro_sql": "{% macro parse_date(field) %}\n\n    CASE WHEN REGEXP_CONTAINS({{field}}  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATE(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING({{field}} , 7, 10),\n            SUBSTRING({{field}} , 4, 2), \n            SUBSTRING({{field}} , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01' AS DATE) END\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.4924643}, "macro.NPS_OMOP_CDM.parse_datetime": {"unique_id": "macro.NPS_OMOP_CDM.parse_datetime", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "macros\\parse_datetime.sql", "original_file_path": "macros\\parse_datetime.sql", "name": "parse_datetime", "macro_sql": "{% macro parse_datetime(field) %}\n\n    CASE WHEN REGEXP_CONTAINS({{field}}  , r'^[0-9]{2}/[0-9]{2}/[0-9]{4}') \n    THEN PARSE_DATETIME(\"%Y%m%d\", \n        CONCAT(\n            SUBSTRING({{field}} , 7, 10),\n            SUBSTRING({{field}} , 4, 2), \n            SUBSTRING({{field}} , 0, 2)\n            )\n        )\n    ELSE CAST('1800-01-01 00:00:00.000' AS DATETIME) END\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.493487}, "macro.NPS_OMOP_CDM.replace_empty_string_with_null": {"unique_id": "macro.NPS_OMOP_CDM.replace_empty_string_with_null", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "macros\\replace_empty_string_with_null.sql", "original_file_path": "macros\\replace_empty_string_with_null.sql", "name": "replace_empty_string_with_null", "macro_sql": "{% macro replace_empty_string_with_null(field_list) %}\r\n\r\n  {% for f in field_list %}\r\n    \r\n    CASE\r\n    WHEN {{f}}  = \"\" THEN NULL\r\n    ELSE {{f}} END AS  {{f}},\r\n\r\n  {% endfor %}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.4944844}, "macro.NPS_OMOP_CDM.safe_concat": {"unique_id": "macro.NPS_OMOP_CDM.safe_concat", "package_name": "NPS_OMOP_CDM", "root_path": "D:\\NPS_ETL\\GH_CLONE\\main\\NPS-MI-2021-ETL-Design-Development-OMOP\\NPS_OMOP_CDM", "path": "macros\\safe_concat.sql", "original_file_path": "macros\\safe_concat.sql", "name": "safe_concat", "macro_sql": "{% macro safe_concat(field_list) %}\r\n  {# Takes an input list and generates a concat() statement with each argument in the list safe_casted to a string and wrapped in an ifnull() #}\r\n\r\n  RTRIM(CONCAT({% for f in field_list %}\r\n    case when {{f}} is null then \"\" \r\n    {% if not loop.last %} \r\n    else concat(CAST({{f}} AS STRING),\"_\") end, \r\n    {% else %}\r\n    else CAST({{f}} AS STRING) end\r\n    {% endif %}\r\n  {% endfor %}), '_')\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.495481}, "macro.dbt_bigquery.partition_by": {"unique_id": "macro.dbt_bigquery.partition_by", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "partition_by", "macro_sql": "{% macro partition_by(partition_config) -%}\n    {%- if partition_config is none -%}\n      {% do return('') %}\n    {%- elif partition_config.data_type | lower in ('date','timestamp','datetime') -%}\n        partition by {{ partition_config.render() }}\n    {%- elif partition_config.data_type | lower in ('int64') -%}\n        {%- set range = partition_config.range -%}\n        partition by range_bucket(\n            {{ partition_config.field }},\n            generate_array({{ range.start}}, {{ range.end }}, {{ range.interval }})\n        )\n    {%- endif -%}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5054271}, "macro.dbt_bigquery.cluster_by": {"unique_id": "macro.dbt_bigquery.cluster_by", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "cluster_by", "macro_sql": "{% macro cluster_by(raw_cluster_by) %}\n  {%- if raw_cluster_by is not none -%}\n  cluster by {% if raw_cluster_by is string -%}\n    {% set raw_cluster_by = [raw_cluster_by] %}\n  {%- endif -%}\n  {%- for cluster in raw_cluster_by -%}\n    {{ cluster }}\n    {%- if not loop.last -%}, {% endif -%}\n  {%- endfor -%}\n\n  {% endif %}\n\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.506425}, "macro.dbt_bigquery.bigquery_options": {"unique_id": "macro.dbt_bigquery.bigquery_options", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery_options", "macro_sql": "{% macro bigquery_options(opts) %}\n  {% set options -%}\n    OPTIONS({% for opt_key, opt_val in opts.items() %}\n      {{ opt_key }}={{ opt_val }}{{ \",\" if not loop.last }}\n    {% endfor %})\n  {%- endset %}\n  {%- do return(options) -%}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.507431}, "macro.dbt_bigquery.bigquery_table_options": {"unique_id": "macro.dbt_bigquery.bigquery_table_options", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery_table_options", "macro_sql": "{% macro bigquery_table_options(config, node, temporary) %}\n  {% set opts = adapter.get_table_options(config, node, temporary) %}\n  {%- do return(bigquery_options(opts)) -%}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery_options"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5084205}, "macro.dbt_bigquery.bigquery__create_table_as": {"unique_id": "macro.dbt_bigquery.bigquery__create_table_as", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__create_table_as", "macro_sql": "{% macro bigquery__create_table_as(temporary, relation, sql) -%}\n  {%- set raw_partition_by = config.get('partition_by', none) -%}\n  {%- set raw_cluster_by = config.get('cluster_by', none) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {%- set partition_config = adapter.parse_partition_by(raw_partition_by) -%}\n\n  {{ sql_header if sql_header is not none }}\n\n  create or replace table {{ relation }}\n  {{ partition_by(partition_config) }}\n  {{ cluster_by(raw_cluster_by) }}\n  {{ bigquery_table_options(config, model, temporary) }}\n  as (\n    {{ sql }}\n  );\n\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.partition_by", "macro.dbt_bigquery.cluster_by", "macro.dbt_bigquery.bigquery_table_options"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5104406}, "macro.dbt_bigquery.bigquery_view_options": {"unique_id": "macro.dbt_bigquery.bigquery_view_options", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery_view_options", "macro_sql": "{% macro bigquery_view_options(config, node) %}\n  {% set opts = adapter.get_view_options(config, node) %}\n  {%- do return(bigquery_options(opts)) -%}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery_options"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5104406}, "macro.dbt_bigquery.bigquery__create_view_as": {"unique_id": "macro.dbt_bigquery.bigquery__create_view_as", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__create_view_as", "macro_sql": "{% macro bigquery__create_view_as(relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n\n  create or replace view {{ relation }}\n  {{ bigquery_view_options(config, model) }}\n  as {{ sql }};\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery_view_options"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5114386}, "macro.dbt_bigquery.bigquery__create_schema": {"unique_id": "macro.dbt_bigquery.bigquery__create_schema", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__create_schema", "macro_sql": "{% macro bigquery__create_schema(relation) -%}\n  {{ adapter.create_schema(relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.512437}, "macro.dbt_bigquery.bigquery__drop_schema": {"unique_id": "macro.dbt_bigquery.bigquery__drop_schema", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__drop_schema", "macro_sql": "{% macro bigquery__drop_schema(relation) -%}\n  {{ adapter.drop_schema(relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.512437}, "macro.dbt_bigquery.bigquery__drop_relation": {"unique_id": "macro.dbt_bigquery.bigquery__drop_relation", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__drop_relation", "macro_sql": "{% macro bigquery__drop_relation(relation) -%}\n  {% call statement('drop_relation') -%}\n    drop {{ relation.type }} if exists {{ relation }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.512437}, "macro.dbt_bigquery.bigquery__get_columns_in_relation": {"unique_id": "macro.dbt_bigquery.bigquery__get_columns_in_relation", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__get_columns_in_relation", "macro_sql": "{% macro bigquery__get_columns_in_relation(relation) -%}\n  {{ return(adapter.get_columns_in_relation(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5134327}, "macro.dbt_bigquery.bigquery__list_relations_without_caching": {"unique_id": "macro.dbt_bigquery.bigquery__list_relations_without_caching", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__list_relations_without_caching", "macro_sql": "{% macro bigquery__list_relations_without_caching(schema_relation) -%}\n  {{ return(adapter.list_relations_without_caching(schema_relation)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5134327}, "macro.dbt_bigquery.bigquery__current_timestamp": {"unique_id": "macro.dbt_bigquery.bigquery__current_timestamp", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__current_timestamp", "macro_sql": "{% macro bigquery__current_timestamp() -%}\n  CURRENT_TIMESTAMP()\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5134327}, "macro.dbt_bigquery.bigquery__snapshot_string_as_time": {"unique_id": "macro.dbt_bigquery.bigquery__snapshot_string_as_time", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__snapshot_string_as_time", "macro_sql": "{% macro bigquery__snapshot_string_as_time(timestamp) -%}\n    {%- set result = 'TIMESTAMP(\"' ~ timestamp ~ '\")' -%}\n    {{ return(result) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5144339}, "macro.dbt_bigquery.bigquery__list_schemas": {"unique_id": "macro.dbt_bigquery.bigquery__list_schemas", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__list_schemas", "macro_sql": "{% macro bigquery__list_schemas(database) -%}\n  {{ return(adapter.list_schemas(database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5144339}, "macro.dbt_bigquery.bigquery__check_schema_exists": {"unique_id": "macro.dbt_bigquery.bigquery__check_schema_exists", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__check_schema_exists", "macro_sql": "{% macro bigquery__check_schema_exists(information_schema, schema) %}\n  {{ return(adapter.check_schema_exists(information_schema.database, schema)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.515428}, "macro.dbt_bigquery.bigquery__persist_docs": {"unique_id": "macro.dbt_bigquery.bigquery__persist_docs", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__persist_docs", "macro_sql": "{% macro bigquery__persist_docs(relation, model, for_relation, for_columns) -%}\n  {% if for_columns and config.persist_column_docs() and model.columns %}\n    {% do alter_column_comment(relation, model.columns) %}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.alter_column_comment"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.515428}, "macro.dbt_bigquery.bigquery__alter_column_comment": {"unique_id": "macro.dbt_bigquery.bigquery__alter_column_comment", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__alter_column_comment", "macro_sql": "{% macro bigquery__alter_column_comment(relation, column_dict) -%}\n  {% do adapter.update_columns(relation, column_dict) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5164304}, "macro.dbt_bigquery.bigquery__rename_relation": {"unique_id": "macro.dbt_bigquery.bigquery__rename_relation", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__rename_relation", "macro_sql": "{% macro bigquery__rename_relation(from_relation, to_relation) -%}\n  {% do adapter.rename_relation(from_relation, to_relation) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5164304}, "macro.dbt_bigquery.bigquery__alter_relation_add_columns": {"unique_id": "macro.dbt_bigquery.bigquery__alter_relation_add_columns", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__alter_relation_add_columns", "macro_sql": "{% macro bigquery__alter_relation_add_columns(relation, add_columns) %}\n  \n  {% set sql -%}\n     \n     alter {{ relation.type }} {{ relation }}\n        {% for column in add_columns %}\n          add column {{ column.name }} {{ column.data_type }}{{ ',' if not loop.last }}\n        {% endfor %}\n  \n  {%- endset -%}\n\n  {{ return(run_query(sql)) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5173957}, "macro.dbt_bigquery.bigquery__alter_relation_drop_columns": {"unique_id": "macro.dbt_bigquery.bigquery__alter_relation_drop_columns", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__alter_relation_drop_columns", "macro_sql": "{% macro bigquery__alter_relation_drop_columns(relation, drop_columns) %}\n  \n  {% set sql -%}\n     \n     alter {{ relation.type }} {{ relation }}\n\n        {% for column in drop_columns %}\n          drop column {{ column.name }}{{ ',' if not loop.last }}\n        {% endfor %}\n  \n  {%- endset -%}\n  \n  {{ return(run_query(sql)) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5184197}, "macro.dbt_bigquery.bigquery__alter_column_type": {"unique_id": "macro.dbt_bigquery.bigquery__alter_column_type", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__alter_column_type", "macro_sql": "{% macro bigquery__alter_column_type(relation, column_name, new_column_type) -%}\n  {#-- Changing a column's data type using a query requires you to scan the entire table.\n    The query charges can be significant if the table is very large.\n\n    https://cloud.google.com/bigquery/docs/manually-changing-schemas#changing_a_columns_data_type\n  #}\n  {% set relation_columns = get_columns_in_relation(relation) %}\n\n  {% set sql %}\n    select\n      {%- for col in relation_columns -%}\n        {% if col.column == column_name %}\n          CAST({{ col.quoted }} AS {{ new_column_type }}) AS {{ col.quoted }}\n        {%- else %}\n          {{ col.quoted }}\n        {%- endif %}\n        {%- if not loop.last %},{% endif -%}\n      {%- endfor %}\n    from {{ relation }}\n  {% endset %}\n\n  {% call statement('alter_column_type') %}\n    {{ create_table_as(False, relation, sql)}}\n  {%- endcall %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_columns_in_relation", "macro.dbt.statement", "macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5204186}, "macro.dbt_bigquery.bigquery__test_unique": {"unique_id": "macro.dbt_bigquery.bigquery__test_unique", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "bigquery__test_unique", "macro_sql": "{% macro bigquery__test_unique(model, column_name) %}\n\nwith dbt_test__target as (\n  \n  select {{ column_name }} as unique_field\n  from {{ model }}\n  where {{ column_name }} is not null\n  \n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5204186}, "macro.dbt_bigquery.bigquery__get_catalog": {"unique_id": "macro.dbt_bigquery.bigquery__get_catalog", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\catalog.sql", "original_file_path": "macros\\catalog.sql", "name": "bigquery__get_catalog", "macro_sql": "{% macro bigquery__get_catalog(information_schema, schemas) -%}\n\n  {%- if (schemas | length) == 0 -%}\n    {# Hopefully nothing cares about the columns we return when there are no rows #}\n    {%- set query  = \"select 1 as id limit 0\" -%}\n  {%- else -%}\n\n  {%- set query -%}\n    with tables as (\n        select\n            project_id as table_database,\n            dataset_id as table_schema,\n            table_id as original_table_name,\n\n            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,\n\n            row_count,\n            size_bytes as size_bytes,\n            case\n                when type = 1 then 'table'\n                when type = 2 then 'view'\n                else 'external'\n            end as table_type,\n\n            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,\n            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,\n            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name\n\n        from {{ information_schema.replace(information_schema_view='__TABLES__') }}\n        where (\n          {%- for schema in schemas -%}\n            upper(dataset_id) = upper('{{ schema }}'){%- if not loop.last %} or {% endif -%}\n          {%- endfor -%}\n        )\n    ),\n\n    extracted as (\n\n        select *,\n            case\n                when is_date_shard then shard_base_name\n                else original_table_name\n            end as table_name\n\n        from tables\n\n    ),\n\n    unsharded_tables as (\n\n        select\n            table_database,\n            table_schema,\n            table_name,\n            coalesce(table_type, 'external') as table_type,\n            is_date_shard,\n\n            struct(\n                min(shard_name) as shard_min,\n                max(shard_name) as shard_max,\n                count(*) as shard_count\n            ) as table_shards,\n\n            sum(size_bytes) as size_bytes,\n            sum(row_count) as row_count,\n\n            max(relation_id) as relation_id\n\n        from extracted\n        group by 1,2,3,4,5\n\n    ),\n\n    info_schema_columns as (\n\n        select\n            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,\n            table_catalog as table_database,\n            table_schema,\n            table_name,\n\n            -- use the \"real\" column name from the paths query below\n            column_name as base_column_name,\n            ordinal_position as column_index,\n\n            is_partitioning_column,\n            clustering_ordinal_position\n\n        from {{ information_schema.replace(information_schema_view='COLUMNS') }}\n        where ordinal_position is not null\n\n    ),\n\n    info_schema_column_paths as (\n\n        select\n            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,\n            field_path as column_name,\n            data_type as column_type,\n            column_name as base_column_name,\n            description as column_comment\n\n        from {{ information_schema.replace(information_schema_view='COLUMN_FIELD_PATHS') }}\n\n    ),\n\n    columns as (\n\n        select * except (base_column_name)\n        from info_schema_columns\n        join info_schema_column_paths using (relation_id, base_column_name)\n\n    ),\n\n    column_stats as (\n\n        select\n            table_database,\n            table_schema,\n            table_name,\n            max(relation_id) as relation_id,\n            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,\n            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,\n            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,\n            array_to_string(\n                array_agg(\n                    case\n                        when clustering_ordinal_position is not null then column_name\n                        else null\n                    end ignore nulls\n                    order by clustering_ordinal_position\n                ), ', '\n            ) as clustering_columns\n\n        from columns\n        group by 1,2,3\n\n    )\n\n    select\n        unsharded_tables.table_database,\n        unsharded_tables.table_schema,\n        case\n            when is_date_shard then concat(unsharded_tables.table_name, '*')\n            else unsharded_tables.table_name\n        end as table_name,\n        unsharded_tables.table_type,\n\n        -- coalesce name and type for External tables - these columns are not\n        -- present in the COLUMN_FIELD_PATHS resultset\n        coalesce(columns.column_name, '<unknown>') as column_name,\n        -- invent a row number to account for nested fields -- BQ does\n        -- not treat these nested properties as independent fields\n        row_number() over (\n            partition by relation_id\n            order by columns.column_index, columns.column_name\n        ) as column_index,\n        coalesce(columns.column_type, '<unknown>') as column_type,\n        columns.column_comment,\n\n        'Shard count' as `stats__date_shards__label`,\n        table_shards.shard_count as `stats__date_shards__value`,\n        'The number of date shards in this table' as `stats__date_shards__description`,\n        is_date_shard as `stats__date_shards__include`,\n\n        'Shard (min)' as `stats__date_shard_min__label`,\n        table_shards.shard_min as `stats__date_shard_min__value`,\n        'The first date shard in this table' as `stats__date_shard_min__description`,\n        is_date_shard as `stats__date_shard_min__include`,\n\n        'Shard (max)' as `stats__date_shard_max__label`,\n        table_shards.shard_max as `stats__date_shard_max__value`,\n        'The last date shard in this table' as `stats__date_shard_max__description`,\n        is_date_shard as `stats__date_shard_max__include`,\n\n        '# Rows' as `stats__num_rows__label`,\n        row_count as `stats__num_rows__value`,\n        'Approximate count of rows in this table' as `stats__num_rows__description`,\n        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,\n\n        'Approximate Size' as `stats__num_bytes__label`,\n        size_bytes as `stats__num_bytes__value`,\n        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,\n        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,\n\n        'Partitioned By' as `stats__partitioning_type__label`,\n        partition_column as `stats__partitioning_type__value`,\n        'The partitioning column for this table' as `stats__partitioning_type__description`,\n        is_partitioned as `stats__partitioning_type__include`,\n\n        'Clustered By' as `stats__clustering_fields__label`,\n        clustering_columns as `stats__clustering_fields__value`,\n        'The clustering columns for this table' as `stats__clustering_fields__description`,\n        is_clustered as `stats__clustering_fields__include`\n\n    -- join using relation_id (an actual relation, not a shard prefix) to make\n    -- sure that column metadata is picked up through the join. This will only\n    -- return the column information for the \"max\" table in a date-sharded table set\n    from unsharded_tables\n    left join columns using (relation_id)\n    left join column_stats using (relation_id)\n  {%- endset -%}\n\n  {%- endif -%}\n\n  {{ return(run_query(query)) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5293646}, "macro.dbt_bigquery.date_sharded_table": {"unique_id": "macro.dbt_bigquery.date_sharded_table", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\etc.sql", "original_file_path": "macros\\etc.sql", "name": "date_sharded_table", "macro_sql": "{% macro date_sharded_table(base_name) %}\n    {{ return(base_name ~ \"[DBT__PARTITION_DATE]\") }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.530362}, "macro.dbt_bigquery.grant_access_to": {"unique_id": "macro.dbt_bigquery.grant_access_to", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\etc.sql", "original_file_path": "macros\\etc.sql", "name": "grant_access_to", "macro_sql": "{% macro grant_access_to(entity, entity_type, role, grant_target_dict) -%}\n  {% do adapter.grant_access_to(entity, entity_type, role, grant_target_dict) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.530362}, "macro.dbt_bigquery.get_partitions_metadata": {"unique_id": "macro.dbt_bigquery.get_partitions_metadata", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\etc.sql", "original_file_path": "macros\\etc.sql", "name": "get_partitions_metadata", "macro_sql": "\n\n{%- macro get_partitions_metadata(table) -%}\n  {%- if execute -%}\n    {%- set res = adapter.get_partitions_metadata(table) -%}\n    {{- return(res) -}}\n  {%- endif -%}\n  {{- return(None) -}}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.531359}, "macro.dbt_bigquery.materialization_copy_bigquery": {"unique_id": "macro.dbt_bigquery.materialization_copy_bigquery", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\materializations\\copy.sql", "original_file_path": "macros\\materializations\\copy.sql", "name": "materialization_copy_bigquery", "macro_sql": "{% materialization copy, adapter='bigquery' -%}\n\n  {# Setup #}\n  {{ run_hooks(pre_hooks) }}\n\n  {% set destination = this.incorporate(type='table') %}\n\n  {# there can be several ref() or source() according to BQ copy API docs #}\n  {# cycle over ref() and source() to create source tables array #}\n  {% set source_array = [] %}\n  {% for ref_table in model.refs %}\n    {{ source_array.append(ref(*ref_table)) }}\n  {% endfor %}\n\n  {% for src_table in model.sources %}\n    {{ source_array.append(source(*src_table)) }}\n  {% endfor %}\n\n  {# Call adapter's copy_table function #}\n  {%- set result_str = adapter.copy_table(\n      source_array,\n      destination,\n      config.get('copy_materialization', default = 'table')) -%}\n\n  {{ store_result('main', response=result_str) }}\n\n  {# Clean up #}\n  {{ run_hooks(post_hooks) }}\n  {{ adapter.commit() }}\n\n  {{ return({'relations': [destination]}) }}\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_hooks"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5353482}, "macro.dbt_bigquery.declare_dbt_max_partition": {"unique_id": "macro.dbt_bigquery.declare_dbt_max_partition", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\materializations\\incremental.sql", "original_file_path": "macros\\materializations\\incremental.sql", "name": "declare_dbt_max_partition", "macro_sql": "{% macro declare_dbt_max_partition(relation, partition_by, sql) %}\n\n  {% if '_dbt_max_partition' in sql %}\n\n    declare _dbt_max_partition {{ partition_by.data_type }} default (\n      select max({{ partition_by.field }}) from {{ this }}\n      where {{ partition_by.field }} is not null\n    );\n  \n  {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5423298}, "macro.dbt_bigquery.dbt_bigquery_validate_get_incremental_strategy": {"unique_id": "macro.dbt_bigquery.dbt_bigquery_validate_get_incremental_strategy", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\materializations\\incremental.sql", "original_file_path": "macros\\materializations\\incremental.sql", "name": "dbt_bigquery_validate_get_incremental_strategy", "macro_sql": "{% macro dbt_bigquery_validate_get_incremental_strategy(config) %}\n  {#-- Find and validate the incremental strategy #}\n  {%- set strategy = config.get(\"incremental_strategy\", default=\"merge\") -%}\n\n  {% set invalid_strategy_msg -%}\n    Invalid incremental strategy provided: {{ strategy }}\n    Expected one of: 'merge', 'insert_overwrite'\n  {%- endset %}\n  {% if strategy not in ['merge', 'insert_overwrite'] %}\n    {% do exceptions.raise_compiler_error(invalid_strategy_msg) %}\n  {% endif %}\n\n  {% do return(strategy) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5433252}, "macro.dbt_bigquery.bq_insert_overwrite": {"unique_id": "macro.dbt_bigquery.bq_insert_overwrite", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\materializations\\incremental.sql", "original_file_path": "macros\\materializations\\incremental.sql", "name": "bq_insert_overwrite", "macro_sql": "{% macro bq_insert_overwrite(\n    tmp_relation, target_relation, sql, unique_key, partition_by, partitions, dest_columns, tmp_relation_exists\n) %}\n\n  {% if partitions is not none and partitions != [] %} {# static #}\n\n      {% set predicate -%}\n          {{ partition_by.render(alias='DBT_INTERNAL_DEST') }} in (\n              {{ partitions | join (', ') }}\n          )\n      {%- endset %}\n\n      {%- set source_sql -%}\n        (\n          {{sql}}\n        )\n      {%- endset -%}\n\n      {{ get_insert_overwrite_merge_sql(target_relation, source_sql, dest_columns, [predicate], include_sql_header=true) }}\n\n  {% else %} {# dynamic #}\n\n      {% set predicate -%}\n          {{ partition_by.render(alias='DBT_INTERNAL_DEST') }} in unnest(dbt_partitions_for_replacement)\n      {%- endset %}\n\n      {%- set source_sql -%}\n      (\n        select * from {{ tmp_relation }}\n      )\n      {%- endset -%}\n\n      -- generated script to merge partitions into {{ target_relation }}\n      declare dbt_partitions_for_replacement array<{{ partition_by.data_type }}>;\n\n      {# have we already created the temp table to check for schema changes? #}\n      {% if not tmp_relation_exists %}\n        {{ declare_dbt_max_partition(this, partition_by, sql) }}\n        \n        -- 1. create a temp table\n        {{ create_table_as(True, tmp_relation, sql) }}\n      {% else %}\n        -- 1. temp table already exists, we used it to check for schema changes\n      {% endif %}\n\n      -- 2. define partitions to update\n      set (dbt_partitions_for_replacement) = (\n          select as struct\n              array_agg(distinct {{ partition_by.render() }})\n          from {{ tmp_relation }}\n      );\n\n      {#\n        TODO: include_sql_header is a hack; consider a better approach that includes\n              the sql_header at the materialization-level instead\n      #}\n      -- 3. run the merge statement\n      {{ get_insert_overwrite_merge_sql(target_relation, source_sql, dest_columns, [predicate], include_sql_header=false) }};\n\n      -- 4. clean up the temp table\n      drop table if exists {{ tmp_relation }}\n\n  {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_insert_overwrite_merge_sql", "macro.dbt_bigquery.declare_dbt_max_partition", "macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5473163}, "macro.dbt_bigquery.bq_generate_incremental_build_sql": {"unique_id": "macro.dbt_bigquery.bq_generate_incremental_build_sql", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\materializations\\incremental.sql", "original_file_path": "macros\\materializations\\incremental.sql", "name": "bq_generate_incremental_build_sql", "macro_sql": "{% macro bq_generate_incremental_build_sql(\n    strategy, tmp_relation, target_relation, sql, unique_key, partition_by, partitions, dest_columns, tmp_relation_exists\n) %}\n  {#-- if partitioned, use BQ scripting to get the range of partition values to be updated --#}\n  {% if strategy == 'insert_overwrite' %}\n\n    {% set missing_partition_msg -%}\n      The 'insert_overwrite' strategy requires the `partition_by` config.\n    {%- endset %}\n    {% if partition_by is none %}\n      {% do exceptions.raise_compiler_error(missing_partition_msg) %}\n    {% endif %}\n\n    {% set build_sql = bq_insert_overwrite(\n        tmp_relation, target_relation, sql, unique_key, partition_by, partitions, dest_columns, on_schema_change\n    ) %}\n\n  {% else %} {# strategy == 'merge' #}\n    {%- set source_sql -%}\n      {%- if tmp_relation_exists -%}\n        (\n          select * from {{ tmp_relation }}\n        )\n      {%- else -%} {#-- wrap sql in parens to make it a subquery --#}\n        (\n          {{sql}}\n        )\n      {%- endif -%}\n    {%- endset -%}\n\n    {% set build_sql = get_merge_sql(target_relation, source_sql, unique_key, dest_columns) %}\n\n  {% endif %}\n\n  {{ return(build_sql) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bq_insert_overwrite", "macro.dbt.get_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.550308}, "macro.dbt_bigquery.materialization_incremental_bigquery": {"unique_id": "macro.dbt_bigquery.materialization_incremental_bigquery", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\materializations\\incremental.sql", "original_file_path": "macros\\materializations\\incremental.sql", "name": "materialization_incremental_bigquery", "macro_sql": "{% materialization incremental, adapter='bigquery' -%}\n\n  {%- set unique_key = config.get('unique_key') -%}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n\n  {%- set target_relation = this %}\n  {%- set existing_relation = load_relation(this) %}\n  {%- set tmp_relation = make_temp_relation(this) %}\n\n  {#-- Validate early so we don't run SQL if the strategy is invalid --#}\n  {% set strategy = dbt_bigquery_validate_get_incremental_strategy(config) -%}\n\n  {%- set raw_partition_by = config.get('partition_by', none) -%}\n  {%- set partition_by = adapter.parse_partition_by(raw_partition_by) -%}\n  {%- set partitions = config.get('partitions', none) -%}\n  {%- set cluster_by = config.get('cluster_by', none) -%}\n\n  {% set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), default='ignore') %}\n\n  {{ run_hooks(pre_hooks) }}\n\n  {% if existing_relation is none %}\n      {% set build_sql = create_table_as(False, target_relation, sql) %}\n  \n  {% elif existing_relation.is_view %}\n      {#-- There's no way to atomically replace a view with a table on BQ --#}\n      {{ adapter.drop_relation(existing_relation) }}\n      {% set build_sql = create_table_as(False, target_relation, sql) %}\n  \n  {% elif full_refresh_mode %}\n      {#-- If the partition/cluster config has changed, then we must drop and recreate --#}\n      {% if not adapter.is_replaceable(existing_relation, partition_by, cluster_by) %}\n          {% do log(\"Hard refreshing \" ~ existing_relation ~ \" because it is not replaceable\") %}\n          {{ adapter.drop_relation(existing_relation) }}\n      {% endif %}\n      {% set build_sql = create_table_as(False, target_relation, sql) %}\n  \n  {% else %}\n    {% set tmp_relation_exists = false %}\n    {% if on_schema_change != 'ignore' %} {# Check first, since otherwise we may not build a temp table #}\n      {% do run_query(\n        declare_dbt_max_partition(this, partition_by, sql) + create_table_as(True, tmp_relation, sql)\n      ) %}\n      {% set tmp_relation_exists = true %}\n      {#-- Process schema changes. Returns dict of changes if successful. Use source columns for upserting/merging --#}\n      {% set dest_columns = process_schema_changes(on_schema_change, tmp_relation, existing_relation) %}\n    {% endif %}\n    {% if not dest_columns %}\n      {% set dest_columns = adapter.get_columns_in_relation(existing_relation) %}\n    {% endif %}\n    {% set build_sql = bq_generate_incremental_build_sql(\n        strategy, tmp_relation, target_relation, sql, unique_key, partition_by, partitions, dest_columns, tmp_relation_exists\n    ) %}\n\n  {% endif %}\n\n  {%- call statement('main') -%}\n    {{ build_sql }}\n  {% endcall %}\n\n  {{ run_hooks(post_hooks) }}\n\n  {% set target_relation = this.incorporate(type='table') %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_full_refresh", "macro.dbt.load_relation", "macro.dbt.make_temp_relation", "macro.dbt_bigquery.dbt_bigquery_validate_get_incremental_strategy", "macro.dbt.incremental_validate_on_schema_change", "macro.dbt.run_hooks", "macro.dbt.create_table_as", "macro.dbt.run_query", "macro.dbt_bigquery.declare_dbt_max_partition", "macro.dbt.process_schema_changes", "macro.dbt_bigquery.bq_generate_incremental_build_sql", "macro.dbt.statement", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5582874}, "macro.dbt_bigquery.bigquery__create_csv_table": {"unique_id": "macro.dbt_bigquery.bigquery__create_csv_table", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\materializations\\seed.sql", "original_file_path": "macros\\materializations\\seed.sql", "name": "bigquery__create_csv_table", "macro_sql": "{% macro bigquery__create_csv_table(model, agate_table) %}\n    -- no-op\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5592844}, "macro.dbt_bigquery.bigquery__reset_csv_table": {"unique_id": "macro.dbt_bigquery.bigquery__reset_csv_table", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\materializations\\seed.sql", "original_file_path": "macros\\materializations\\seed.sql", "name": "bigquery__reset_csv_table", "macro_sql": "{% macro bigquery__reset_csv_table(model, full_refresh, old_relation, agate_table) %}\n    {{ adapter.drop_relation(old_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5602818}, "macro.dbt_bigquery.bigquery__load_csv_rows": {"unique_id": "macro.dbt_bigquery.bigquery__load_csv_rows", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\materializations\\seed.sql", "original_file_path": "macros\\materializations\\seed.sql", "name": "bigquery__load_csv_rows", "macro_sql": "{% macro bigquery__load_csv_rows(model, agate_table) %}\n\n  {%- set column_override = model['config'].get('column_types', {}) -%}\n  {{ adapter.load_dataframe(model['database'], model['schema'], model['alias'],\n  \t\t\t\t\t\t\tagate_table, column_override) }}\n  {% if config.persist_relation_docs() and 'description' in model %}\n\n  \t{{ adapter.update_table_description(model['database'], model['schema'], model['alias'], model['description']) }}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5622761}, "macro.dbt_bigquery.bigquery__snapshot_hash_arguments": {"unique_id": "macro.dbt_bigquery.bigquery__snapshot_hash_arguments", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\materializations\\snapshot.sql", "original_file_path": "macros\\materializations\\snapshot.sql", "name": "bigquery__snapshot_hash_arguments", "macro_sql": "{% macro bigquery__snapshot_hash_arguments(args) -%}\n  to_hex(md5(concat({%- for arg in args -%}\n    coalesce(cast({{ arg }} as string), ''){% if not loop.last %}, '|',{% endif -%}\n  {%- endfor -%}\n  )))\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5632737}, "macro.dbt_bigquery.bigquery__create_columns": {"unique_id": "macro.dbt_bigquery.bigquery__create_columns", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\materializations\\snapshot.sql", "original_file_path": "macros\\materializations\\snapshot.sql", "name": "bigquery__create_columns", "macro_sql": "{% macro bigquery__create_columns(relation, columns) %}\n  {{ adapter.alter_table_add_columns(relation, columns) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5632737}, "macro.dbt_bigquery.bigquery__post_snapshot": {"unique_id": "macro.dbt_bigquery.bigquery__post_snapshot", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\materializations\\snapshot.sql", "original_file_path": "macros\\materializations\\snapshot.sql", "name": "bigquery__post_snapshot", "macro_sql": "{% macro bigquery__post_snapshot(staging_relation) %}\n  -- Clean up the snapshot temp table\n  {% do drop_relation(staging_relation) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.drop_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5632737}, "macro.dbt_bigquery.materialization_table_bigquery": {"unique_id": "macro.dbt_bigquery.materialization_table_bigquery", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\materializations\\table.sql", "original_file_path": "macros\\materializations\\table.sql", "name": "materialization_table_bigquery", "macro_sql": "{% materialization table, adapter='bigquery' -%}\n\n  {%- set identifier = model['alias'] -%}\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set exists_not_as_table = (old_relation is not none and not old_relation.is_table) -%}\n  {%- set target_relation = api.Relation.create(database=database, schema=schema, identifier=identifier, type='table') -%}\n\n  {{ run_hooks(pre_hooks) }}\n\n  {#\n      We only need to drop this thing if it is not a table.\n      If it _is_ already a table, then we can overwrite it without downtime\n      Unlike table -> view, no need for `--full-refresh`: dropping a view is no big deal\n  #}\n  {%- if exists_not_as_table -%}\n      {{ adapter.drop_relation(old_relation) }}\n  {%- endif -%}\n\n  -- build model\n  {%- set raw_partition_by = config.get('partition_by', none) -%}\n  {%- set partition_by = adapter.parse_partition_by(raw_partition_by) -%}\n  {%- set cluster_by = config.get('cluster_by', none) -%}\n  {% if not adapter.is_replaceable(old_relation, partition_by, cluster_by) %}\n    {% do log(\"Hard refreshing \" ~ old_relation ~ \" because it is not replaceable\") %}\n    {% do adapter.drop_relation(old_relation) %}\n  {% endif %}\n  {% call statement('main') -%}\n    {{ create_table_as(False, target_relation, sql) }}\n  {% endcall -%}\n\n  {{ run_hooks(post_hooks) }}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5692575}, "macro.dbt_bigquery.bigquery__handle_existing_table": {"unique_id": "macro.dbt_bigquery.bigquery__handle_existing_table", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\materializations\\view.sql", "original_file_path": "macros\\materializations\\view.sql", "name": "bigquery__handle_existing_table", "macro_sql": "{% macro bigquery__handle_existing_table(full_refresh, old_relation) %}\n    {%- if full_refresh -%}\n      {{ adapter.drop_relation(old_relation) }}\n    {%- else -%}\n      {{ exceptions.relation_wrong_type(old_relation, 'view') }}\n    {%- endif -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.570255}, "macro.dbt_bigquery.materialization_view_bigquery": {"unique_id": "macro.dbt_bigquery.materialization_view_bigquery", "package_name": "dbt_bigquery", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\bigquery", "path": "macros\\materializations\\view.sql", "original_file_path": "macros\\materializations\\view.sql", "name": "materialization_view_bigquery", "macro_sql": "{% materialization view, adapter='bigquery' -%}\n    {% set to_return = create_or_replace_view() %}\n\n    {% set target_relation = this.incorporate(type='view') %}\n    {% do persist_docs(target_relation, model) %}\n\n    {% if config.get('grant_access_to') %}\n      {% for grant_target_dict in config.get('grant_access_to') %}\n        {% do adapter.grant_access_to(this, 'view', None, grant_target_dict) %}\n      {% endfor %}\n    {% endif %}\n\n    {% do return(to_return) %}\n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_or_replace_view", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5722482}, "macro.dbt.get_columns_in_relation": {"unique_id": "macro.dbt.get_columns_in_relation", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "get_columns_in_relation", "macro_sql": "{% macro get_columns_in_relation(relation) -%}\n  {{ return(adapter.dispatch('get_columns_in_relation', 'dbt')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__get_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5762377}, "macro.dbt.default__get_columns_in_relation": {"unique_id": "macro.dbt.default__get_columns_in_relation", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "default__get_columns_in_relation", "macro_sql": "{% macro default__get_columns_in_relation(relation) -%}\n  {{ exceptions.raise_not_implemented(\n    'get_columns_in_relation macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5762377}, "macro.dbt.sql_convert_columns_in_relation": {"unique_id": "macro.dbt.sql_convert_columns_in_relation", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "sql_convert_columns_in_relation", "macro_sql": "{% macro sql_convert_columns_in_relation(table) -%}\n  {% set columns = [] %}\n  {% for row in table %}\n    {% do columns.append(api.Column(*row)) %}\n  {% endfor %}\n  {{ return(columns) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5772347}, "macro.dbt.get_columns_in_query": {"unique_id": "macro.dbt.get_columns_in_query", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "get_columns_in_query", "macro_sql": "{% macro get_columns_in_query(select_sql) -%}\n  {{ return(adapter.dispatch('get_columns_in_query', 'dbt')(select_sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_columns_in_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.578232}, "macro.dbt.default__get_columns_in_query": {"unique_id": "macro.dbt.default__get_columns_in_query", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "default__get_columns_in_query", "macro_sql": "{% macro default__get_columns_in_query(select_sql) %}\n    {% call statement('get_columns_in_query', fetch_result=True, auto_begin=False) -%}\n        select * from (\n            {{ select_sql }}\n        ) as __dbt_sbq\n        where false\n        limit 0\n    {% endcall %}\n\n    {{ return(load_result('get_columns_in_query').table.columns | map(attribute='name') | list) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.578232}, "macro.dbt.alter_column_type": {"unique_id": "macro.dbt.alter_column_type", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "alter_column_type", "macro_sql": "{% macro alter_column_type(relation, column_name, new_column_type) -%}\n  {{ return(adapter.dispatch('alter_column_type', 'dbt')(relation, column_name, new_column_type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__alter_column_type"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5792294}, "macro.dbt.default__alter_column_type": {"unique_id": "macro.dbt.default__alter_column_type", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "default__alter_column_type", "macro_sql": "{% macro default__alter_column_type(relation, column_name, new_column_type) -%}\n  {#\n    1. Create a new column (w/ temp name and correct type)\n    2. Copy data over to it\n    3. Drop the existing column (cascade!)\n    4. Rename the new column to existing column\n  #}\n  {%- set tmp_column = column_name + \"__dbt_alter\" -%}\n\n  {% call statement('alter_column_type') %}\n    alter table {{ relation }} add column {{ adapter.quote(tmp_column) }} {{ new_column_type }};\n    update {{ relation }} set {{ adapter.quote(tmp_column) }} = {{ adapter.quote(column_name) }};\n    alter table {{ relation }} drop column {{ adapter.quote(column_name) }} cascade;\n    alter table {{ relation }} rename column {{ adapter.quote(tmp_column) }} to {{ adapter.quote(column_name) }}\n  {% endcall %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.580227}, "macro.dbt.alter_relation_add_remove_columns": {"unique_id": "macro.dbt.alter_relation_add_remove_columns", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "alter_relation_add_remove_columns", "macro_sql": "{% macro alter_relation_add_remove_columns(relation, add_columns = none, remove_columns = none) -%}\n  {{ return(adapter.dispatch('alter_relation_add_remove_columns', 'dbt')(relation, add_columns, remove_columns)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__alter_relation_add_remove_columns"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.581224}, "macro.dbt.default__alter_relation_add_remove_columns": {"unique_id": "macro.dbt.default__alter_relation_add_remove_columns", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "default__alter_relation_add_remove_columns", "macro_sql": "{% macro default__alter_relation_add_remove_columns(relation, add_columns, remove_columns) %}\n  \n  {% if add_columns is none %}\n    {% set add_columns = [] %}\n  {% endif %}\n  {% if remove_columns is none %}\n    {% set remove_columns = [] %}\n  {% endif %}\n  \n  {% set sql -%}\n     \n     alter {{ relation.type }} {{ relation }}\n       \n            {% for column in add_columns %}\n               add column {{ column.name }} {{ column.data_type }}{{ ',' if not loop.last }}\n            {% endfor %}{{ ',' if add_columns and remove_columns }}\n            \n            {% for column in remove_columns %}\n                drop column {{ column.name }}{{ ',' if not loop.last }}\n            {% endfor %}\n  \n  {%- endset -%}\n\n  {% do run_query(sql) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5832186}, "macro.dbt.current_timestamp": {"unique_id": "macro.dbt.current_timestamp", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\freshness.sql", "original_file_path": "macros\\adapters\\freshness.sql", "name": "current_timestamp", "macro_sql": "{% macro current_timestamp() -%}\n  {{ adapter.dispatch('current_timestamp', 'dbt')() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5842164}, "macro.dbt.default__current_timestamp": {"unique_id": "macro.dbt.default__current_timestamp", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\freshness.sql", "original_file_path": "macros\\adapters\\freshness.sql", "name": "default__current_timestamp", "macro_sql": "{% macro default__current_timestamp() -%}\n  {{ exceptions.raise_not_implemented(\n    'current_timestamp macro not implemented for adapter '+adapter.type()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5852134}, "macro.dbt.collect_freshness": {"unique_id": "macro.dbt.collect_freshness", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\freshness.sql", "original_file_path": "macros\\adapters\\freshness.sql", "name": "collect_freshness", "macro_sql": "{% macro collect_freshness(source, loaded_at_field, filter) %}\n  {{ return(adapter.dispatch('collect_freshness', 'dbt')(source, loaded_at_field, filter))}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__collect_freshness"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5852134}, "macro.dbt.default__collect_freshness": {"unique_id": "macro.dbt.default__collect_freshness", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\freshness.sql", "original_file_path": "macros\\adapters\\freshness.sql", "name": "default__collect_freshness", "macro_sql": "{% macro default__collect_freshness(source, loaded_at_field, filter) %}\n  {% call statement('collect_freshness', fetch_result=True, auto_begin=False) -%}\n    select\n      max({{ loaded_at_field }}) as max_loaded_at,\n      {{ current_timestamp() }} as snapshotted_at\n    from {{ source }}\n    {% if filter %}\n    where {{ filter }}\n    {% endif %}\n  {% endcall %}\n  {{ return(load_result('collect_freshness').table) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.587208}, "macro.dbt.get_create_index_sql": {"unique_id": "macro.dbt.get_create_index_sql", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\indexes.sql", "original_file_path": "macros\\adapters\\indexes.sql", "name": "get_create_index_sql", "macro_sql": "{% macro get_create_index_sql(relation, index_dict) -%}\n  {{ return(adapter.dispatch('get_create_index_sql', 'dbt')(relation, index_dict)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_create_index_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5882056}, "macro.dbt.default__get_create_index_sql": {"unique_id": "macro.dbt.default__get_create_index_sql", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\indexes.sql", "original_file_path": "macros\\adapters\\indexes.sql", "name": "default__get_create_index_sql", "macro_sql": "{% macro default__get_create_index_sql(relation, index_dict) -%}\n  {% do return(None) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.589204}, "macro.dbt.create_indexes": {"unique_id": "macro.dbt.create_indexes", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\indexes.sql", "original_file_path": "macros\\adapters\\indexes.sql", "name": "create_indexes", "macro_sql": "{% macro create_indexes(relation) -%}\n  {{ adapter.dispatch('create_indexes', 'dbt')(relation) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.589204}, "macro.dbt.default__create_indexes": {"unique_id": "macro.dbt.default__create_indexes", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\indexes.sql", "original_file_path": "macros\\adapters\\indexes.sql", "name": "default__create_indexes", "macro_sql": "{% macro default__create_indexes(relation) -%}\n  {%- set _indexes = config.get('indexes', default=[]) -%}\n\n  {% for _index_dict in _indexes %}\n    {% set create_index_sql = get_create_index_sql(relation, _index_dict) %}\n    {% if create_index_sql %}\n      {% do run_query(create_index_sql) %}\n    {% endif %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_create_index_sql", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5902004}, "macro.dbt.get_catalog": {"unique_id": "macro.dbt.get_catalog", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "get_catalog", "macro_sql": "{% macro get_catalog(information_schema, schemas) -%}\n  {{ return(adapter.dispatch('get_catalog', 'dbt')(information_schema, schemas)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__get_catalog"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5941894}, "macro.dbt.default__get_catalog": {"unique_id": "macro.dbt.default__get_catalog", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "default__get_catalog", "macro_sql": "{% macro default__get_catalog(information_schema, schemas) -%}\n\n  {% set typename = adapter.type() %}\n  {% set msg -%}\n    get_catalog not implemented for {{ typename }}\n  {%- endset %}\n\n  {{ exceptions.raise_compiler_error(msg) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5941894}, "macro.dbt.information_schema_name": {"unique_id": "macro.dbt.information_schema_name", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "information_schema_name", "macro_sql": "{% macro information_schema_name(database) %}\n  {{ return(adapter.dispatch('information_schema_name', 'dbt')(database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__information_schema_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5951867}, "macro.dbt.default__information_schema_name": {"unique_id": "macro.dbt.default__information_schema_name", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "default__information_schema_name", "macro_sql": "{% macro default__information_schema_name(database) -%}\n  {%- if database -%}\n    {{ database }}.INFORMATION_SCHEMA\n  {%- else -%}\n    INFORMATION_SCHEMA\n  {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5951867}, "macro.dbt.list_schemas": {"unique_id": "macro.dbt.list_schemas", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "list_schemas", "macro_sql": "{% macro list_schemas(database) -%}\n  {{ return(adapter.dispatch('list_schemas', 'dbt')(database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__list_schemas"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5951867}, "macro.dbt.default__list_schemas": {"unique_id": "macro.dbt.default__list_schemas", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "default__list_schemas", "macro_sql": "{% macro default__list_schemas(database) -%}\n  {% set sql %}\n    select distinct schema_name\n    from {{ information_schema_name(database) }}.SCHEMATA\n    where catalog_name ilike '{{ database }}'\n  {% endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.information_schema_name", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5961838}, "macro.dbt.check_schema_exists": {"unique_id": "macro.dbt.check_schema_exists", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "check_schema_exists", "macro_sql": "{% macro check_schema_exists(information_schema, schema) -%}\n  {{ return(adapter.dispatch('check_schema_exists', 'dbt')(information_schema, schema)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__check_schema_exists"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.597181}, "macro.dbt.default__check_schema_exists": {"unique_id": "macro.dbt.default__check_schema_exists", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "default__check_schema_exists", "macro_sql": "{% macro default__check_schema_exists(information_schema, schema) -%}\n  {% set sql -%}\n        select count(*)\n        from {{ information_schema.replace(information_schema_view='SCHEMATA') }}\n        where catalog_name='{{ information_schema.database }}'\n          and schema_name='{{ schema }}'\n  {%- endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.597181}, "macro.dbt.list_relations_without_caching": {"unique_id": "macro.dbt.list_relations_without_caching", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "list_relations_without_caching", "macro_sql": "{% macro list_relations_without_caching(schema_relation) %}\n  {{ return(adapter.dispatch('list_relations_without_caching', 'dbt')(schema_relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__list_relations_without_caching"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5981789}, "macro.dbt.default__list_relations_without_caching": {"unique_id": "macro.dbt.default__list_relations_without_caching", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "default__list_relations_without_caching", "macro_sql": "{% macro default__list_relations_without_caching(schema_relation) %}\n  {{ exceptions.raise_not_implemented(\n    'list_relations_without_caching macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.5981789}, "macro.dbt.alter_column_comment": {"unique_id": "macro.dbt.alter_column_comment", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "alter_column_comment", "macro_sql": "{% macro alter_column_comment(relation, column_dict) -%}\n  {{ return(adapter.dispatch('alter_column_comment', 'dbt')(relation, column_dict)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__alter_column_comment"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.600173}, "macro.dbt.default__alter_column_comment": {"unique_id": "macro.dbt.default__alter_column_comment", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "default__alter_column_comment", "macro_sql": "{% macro default__alter_column_comment(relation, column_dict) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_column_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.600173}, "macro.dbt.alter_relation_comment": {"unique_id": "macro.dbt.alter_relation_comment", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "alter_relation_comment", "macro_sql": "{% macro alter_relation_comment(relation, relation_comment) -%}\n  {{ return(adapter.dispatch('alter_relation_comment', 'dbt')(relation, relation_comment)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__alter_relation_comment"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6011708}, "macro.dbt.default__alter_relation_comment": {"unique_id": "macro.dbt.default__alter_relation_comment", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "default__alter_relation_comment", "macro_sql": "{% macro default__alter_relation_comment(relation, relation_comment) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_relation_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6011708}, "macro.dbt.persist_docs": {"unique_id": "macro.dbt.persist_docs", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "persist_docs", "macro_sql": "{% macro persist_docs(relation, model, for_relation=true, for_columns=true) -%}\n  {{ return(adapter.dispatch('persist_docs', 'dbt')(relation, model, for_relation, for_columns)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.602168}, "macro.dbt.default__persist_docs": {"unique_id": "macro.dbt.default__persist_docs", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "default__persist_docs", "macro_sql": "{% macro default__persist_docs(relation, model, for_relation, for_columns) -%}\n  {% if for_relation and config.persist_relation_docs() and model.description %}\n    {% do run_query(alter_relation_comment(relation, model.description)) %}\n  {% endif %}\n\n  {% if for_columns and config.persist_column_docs() and model.columns %}\n    {% do run_query(alter_column_comment(relation, model.columns)) %}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query", "macro.dbt.alter_relation_comment", "macro.dbt.alter_column_comment"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6041625}, "macro.dbt.make_temp_relation": {"unique_id": "macro.dbt.make_temp_relation", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "make_temp_relation", "macro_sql": "{% macro make_temp_relation(base_relation, suffix='__dbt_tmp') %}\n  {{ return(adapter.dispatch('make_temp_relation', 'dbt')(base_relation, suffix))}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__make_temp_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6081533}, "macro.dbt.default__make_temp_relation": {"unique_id": "macro.dbt.default__make_temp_relation", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "default__make_temp_relation", "macro_sql": "{% macro default__make_temp_relation(base_relation, suffix) %}\n    {% set tmp_identifier = base_relation.identifier ~ suffix %}\n    {% set tmp_relation = base_relation.incorporate(\n                                path={\"identifier\": tmp_identifier}) -%}\n\n    {% do return(tmp_relation) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6091495}, "macro.dbt.drop_relation": {"unique_id": "macro.dbt.drop_relation", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "drop_relation", "macro_sql": "{% macro drop_relation(relation) -%}\n  {{ return(adapter.dispatch('drop_relation', 'dbt')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__drop_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6091495}, "macro.dbt.default__drop_relation": {"unique_id": "macro.dbt.default__drop_relation", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "default__drop_relation", "macro_sql": "{% macro default__drop_relation(relation) -%}\n  {% call statement('drop_relation', auto_begin=False) -%}\n    drop {{ relation.type }} if exists {{ relation }} cascade\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6101468}, "macro.dbt.truncate_relation": {"unique_id": "macro.dbt.truncate_relation", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "truncate_relation", "macro_sql": "{% macro truncate_relation(relation) -%}\n  {{ return(adapter.dispatch('truncate_relation', 'dbt')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__truncate_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6101468}, "macro.dbt.default__truncate_relation": {"unique_id": "macro.dbt.default__truncate_relation", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "default__truncate_relation", "macro_sql": "{% macro default__truncate_relation(relation) -%}\n  {% call statement('truncate_relation') -%}\n    truncate table {{ relation }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6111438}, "macro.dbt.rename_relation": {"unique_id": "macro.dbt.rename_relation", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "rename_relation", "macro_sql": "{% macro rename_relation(from_relation, to_relation) -%}\n  {{ return(adapter.dispatch('rename_relation', 'dbt')(from_relation, to_relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__rename_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6111438}, "macro.dbt.default__rename_relation": {"unique_id": "macro.dbt.default__rename_relation", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "default__rename_relation", "macro_sql": "{% macro default__rename_relation(from_relation, to_relation) -%}\n  {% set target_name = adapter.quote_as_configured(to_relation.identifier, 'identifier') %}\n  {% call statement('rename_relation') -%}\n    alter table {{ from_relation }} rename to {{ target_name }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6121414}, "macro.dbt.get_or_create_relation": {"unique_id": "macro.dbt.get_or_create_relation", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "get_or_create_relation", "macro_sql": "{% macro get_or_create_relation(database, schema, identifier, type) -%}\n  {{ return(adapter.dispatch('get_or_create_relation', 'dbt')(database, schema, identifier, type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_or_create_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6121414}, "macro.dbt.default__get_or_create_relation": {"unique_id": "macro.dbt.default__get_or_create_relation", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "default__get_or_create_relation", "macro_sql": "{% macro default__get_or_create_relation(database, schema, identifier, type) %}\n  {%- set target_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) %}\n\n  {% if target_relation %}\n    {% do return([true, target_relation]) %}\n  {% endif %}\n\n  {%- set new_relation = api.Relation.create(\n      database=database,\n      schema=schema,\n      identifier=identifier,\n      type=type\n  ) -%}\n  {% do return([false, new_relation]) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6141357}, "macro.dbt.load_relation": {"unique_id": "macro.dbt.load_relation", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "load_relation", "macro_sql": "{% macro load_relation(relation) %}\n  {% do return(adapter.get_relation(\n    database=relation.database,\n    schema=relation.schema,\n    identifier=relation.identifier\n  )) -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6141357}, "macro.dbt.drop_relation_if_exists": {"unique_id": "macro.dbt.drop_relation_if_exists", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "drop_relation_if_exists", "macro_sql": "{% macro drop_relation_if_exists(relation) %}\n  {% if relation is not none %}\n    {{ adapter.drop_relation(relation) }}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6151333}, "macro.dbt.create_schema": {"unique_id": "macro.dbt.create_schema", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\schema.sql", "original_file_path": "macros\\adapters\\schema.sql", "name": "create_schema", "macro_sql": "{% macro create_schema(relation) -%}\n  {{ adapter.dispatch('create_schema', 'dbt')(relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__create_schema"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6161318}, "macro.dbt.default__create_schema": {"unique_id": "macro.dbt.default__create_schema", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\schema.sql", "original_file_path": "macros\\adapters\\schema.sql", "name": "default__create_schema", "macro_sql": "{% macro default__create_schema(relation) -%}\n  {%- call statement('create_schema') -%}\n    create schema if not exists {{ relation.without_identifier() }}\n  {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6161318}, "macro.dbt.drop_schema": {"unique_id": "macro.dbt.drop_schema", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\schema.sql", "original_file_path": "macros\\adapters\\schema.sql", "name": "drop_schema", "macro_sql": "{% macro drop_schema(relation) -%}\n  {{ adapter.dispatch('drop_schema', 'dbt')(relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__drop_schema"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.617128}, "macro.dbt.default__drop_schema": {"unique_id": "macro.dbt.default__drop_schema", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\schema.sql", "original_file_path": "macros\\adapters\\schema.sql", "name": "default__drop_schema", "macro_sql": "{% macro default__drop_schema(relation) -%}\n  {%- call statement('drop_schema') -%}\n    drop schema if exists {{ relation.without_identifier() }} cascade\n  {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.617128}, "macro.dbt.convert_datetime": {"unique_id": "macro.dbt.convert_datetime", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\datetime.sql", "original_file_path": "macros\\etc\\datetime.sql", "name": "convert_datetime", "macro_sql": "{% macro convert_datetime(date_str, date_fmt) %}\n\n  {% set error_msg -%}\n      The provided partition date '{{ date_str }}' does not match the expected format '{{ date_fmt }}'\n  {%- endset %}\n\n  {% set res = try_or_compiler_error(error_msg, modules.datetime.datetime.strptime, date_str.strip(), date_fmt) %}\n  {{ return(res) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.621117}, "macro.dbt.dates_in_range": {"unique_id": "macro.dbt.dates_in_range", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\datetime.sql", "original_file_path": "macros\\etc\\datetime.sql", "name": "dates_in_range", "macro_sql": "{% macro dates_in_range(start_date_str, end_date_str=none, in_fmt=\"%Y%m%d\", out_fmt=\"%Y%m%d\") %}\n    {% set end_date_str = start_date_str if end_date_str is none else end_date_str %}\n\n    {% set start_date = convert_datetime(start_date_str, in_fmt) %}\n    {% set end_date = convert_datetime(end_date_str, in_fmt) %}\n\n    {% set day_count = (end_date - start_date).days %}\n    {% if day_count < 0 %}\n        {% set msg -%}\n            Partiton start date is after the end date ({{ start_date }}, {{ end_date }})\n        {%- endset %}\n\n        {{ exceptions.raise_compiler_error(msg, model) }}\n    {% endif %}\n\n    {% set date_list = [] %}\n    {% for i in range(0, day_count + 1) %}\n        {% set the_date = (modules.datetime.timedelta(days=i) + start_date) %}\n        {% if not out_fmt %}\n            {% set _ = date_list.append(the_date) %}\n        {% else %}\n            {% set _ = date_list.append(the_date.strftime(out_fmt)) %}\n        {% endif %}\n    {% endfor %}\n\n    {{ return(date_list) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.convert_datetime"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6251066}, "macro.dbt.partition_range": {"unique_id": "macro.dbt.partition_range", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\datetime.sql", "original_file_path": "macros\\etc\\datetime.sql", "name": "partition_range", "macro_sql": "{% macro partition_range(raw_partition_date, date_fmt='%Y%m%d') %}\n    {% set partition_range = (raw_partition_date | string).split(\",\") %}\n\n    {% if (partition_range | length) == 1 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = none %}\n    {% elif (partition_range | length) == 2 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = partition_range[1] %}\n    {% else %}\n      {{ exceptions.raise_compiler_error(\"Invalid partition time. Expected format: {Start Date}[,{End Date}]. Got: \" ~ raw_partition_date) }}\n    {% endif %}\n\n    {{ return(dates_in_range(start_date, end_date, in_fmt=date_fmt)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.dates_in_range"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6261039}, "macro.dbt.py_current_timestring": {"unique_id": "macro.dbt.py_current_timestring", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\datetime.sql", "original_file_path": "macros\\etc\\datetime.sql", "name": "py_current_timestring", "macro_sql": "{% macro py_current_timestring() %}\n    {% set dt = modules.datetime.datetime.now() %}\n    {% do return(dt.strftime(\"%Y%m%d%H%M%S%f\")) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6271014}, "macro.dbt.statement": {"unique_id": "macro.dbt.statement", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\statement.sql", "original_file_path": "macros\\etc\\statement.sql", "name": "statement", "macro_sql": "{% macro statement(name=None, fetch_result=False, auto_begin=True) -%}\n  {%- if execute: -%}\n    {%- set sql = caller() -%}\n\n    {%- if name == 'main' -%}\n      {{ log('Writing runtime SQL for node \"{}\"'.format(model['unique_id'])) }}\n      {{ write(sql) }}\n    {%- endif -%}\n\n    {%- set res, table = adapter.execute(sql, auto_begin=auto_begin, fetch=fetch_result) -%}\n    {%- if name is not none -%}\n      {{ store_result(name, response=res, agate_table=table) }}\n    {%- endif -%}\n\n  {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6300933}, "macro.dbt.noop_statement": {"unique_id": "macro.dbt.noop_statement", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\statement.sql", "original_file_path": "macros\\etc\\statement.sql", "name": "noop_statement", "macro_sql": "{% macro noop_statement(name=None, message=None, code=None, rows_affected=None, res=None) -%}\n  {%- set sql = caller() -%}\n\n  {%- if name == 'main' -%}\n    {{ log('Writing runtime SQL for node \"{}\"'.format(model['unique_id'])) }}\n    {{ write(sql) }}\n  {%- endif -%}\n\n  {%- if name is not none -%}\n    {{ store_raw_result(name, message=message, code=code, rows_affected=rows_affected, agate_table=res) }}\n  {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6310904}, "macro.dbt.run_query": {"unique_id": "macro.dbt.run_query", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\statement.sql", "original_file_path": "macros\\etc\\statement.sql", "name": "run_query", "macro_sql": "{% macro run_query(sql) %}\n  {% call statement(\"run_query_statement\", fetch_result=true, auto_begin=false) %}\n    {{ sql }}\n  {% endcall %}\n\n  {% do return(load_result(\"run_query_statement\").table) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6320877}, "macro.dbt.default__test_accepted_values": {"unique_id": "macro.dbt.default__test_accepted_values", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\generic_test_sql\\accepted_values.sql", "original_file_path": "macros\\generic_test_sql\\accepted_values.sql", "name": "default__test_accepted_values", "macro_sql": "{% macro default__test_accepted_values(model, column_name, values, quote=True) %}\n\nwith all_values as (\n\n    select\n        {{ column_name }} as value_field,\n        count(*) as n_records\n\n    from {{ model }}\n    group by {{ column_name }}\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    {% for value in values -%}\n        {% if quote -%}\n        '{{ value }}'\n        {%- else -%}\n        {{ value }}\n        {%- endif -%}\n        {%- if not loop.last -%},{%- endif %}\n    {%- endfor %}\n)\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6340828}, "macro.dbt.default__test_not_null": {"unique_id": "macro.dbt.default__test_not_null", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\generic_test_sql\\not_null.sql", "original_file_path": "macros\\generic_test_sql\\not_null.sql", "name": "default__test_not_null", "macro_sql": "{% macro default__test_not_null(model, column_name) %}\n\nselect *\nfrom {{ model }}\nwhere {{ column_name }} is null\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6340828}, "macro.dbt.default__test_relationships": {"unique_id": "macro.dbt.default__test_relationships", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\generic_test_sql\\relationships.sql", "original_file_path": "macros\\generic_test_sql\\relationships.sql", "name": "default__test_relationships", "macro_sql": "{% macro default__test_relationships(model, column_name, to, field) %}\n\nwith child as (\n    select {{ column_name }} as from_field\n    from {{ model }}\n    where {{ column_name }} is not null\n),\n\nparent as (\n    select {{ field }} as to_field\n    from {{ to }}\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.63508}, "macro.dbt.default__test_unique": {"unique_id": "macro.dbt.default__test_unique", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\generic_test_sql\\unique.sql", "original_file_path": "macros\\generic_test_sql\\unique.sql", "name": "default__test_unique", "macro_sql": "{% macro default__test_unique(model, column_name) %}\n\nselect\n    {{ column_name }} as unique_field,\n    count(*) as n_records\n\nfrom {{ model }}\nwhere {{ column_name }} is not null\ngroup by {{ column_name }}\nhaving count(*) > 1\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6360774}, "macro.dbt.generate_alias_name": {"unique_id": "macro.dbt.generate_alias_name", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_alias.sql", "original_file_path": "macros\\get_custom_name\\get_custom_alias.sql", "name": "generate_alias_name", "macro_sql": "{% macro generate_alias_name(custom_alias_name=none, node=none) -%}\n    {% do return(adapter.dispatch('generate_alias_name', 'dbt')(custom_alias_name, node)) %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__generate_alias_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6370747}, "macro.dbt.default__generate_alias_name": {"unique_id": "macro.dbt.default__generate_alias_name", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_alias.sql", "original_file_path": "macros\\get_custom_name\\get_custom_alias.sql", "name": "default__generate_alias_name", "macro_sql": "{% macro default__generate_alias_name(custom_alias_name=none, node=none) -%}\n\n    {%- if custom_alias_name is none -%}\n\n        {{ node.name }}\n\n    {%- else -%}\n\n        {{ custom_alias_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6380718}, "macro.dbt.generate_database_name": {"unique_id": "macro.dbt.generate_database_name", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_database.sql", "original_file_path": "macros\\get_custom_name\\get_custom_database.sql", "name": "generate_database_name", "macro_sql": "{% macro generate_database_name(custom_database_name=none, node=none) -%}\n    {% do return(adapter.dispatch('generate_database_name', 'dbt')(custom_database_name, node)) %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__generate_database_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6390707}, "macro.dbt.default__generate_database_name": {"unique_id": "macro.dbt.default__generate_database_name", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_database.sql", "original_file_path": "macros\\get_custom_name\\get_custom_database.sql", "name": "default__generate_database_name", "macro_sql": "{% macro default__generate_database_name(custom_database_name=none, node=none) -%}\n    {%- set default_database = target.database -%}\n    {%- if custom_database_name is none -%}\n\n        {{ default_database }}\n\n    {%- else -%}\n\n        {{ custom_database_name }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.640067}, "macro.dbt.generate_schema_name": {"unique_id": "macro.dbt.generate_schema_name", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_schema.sql", "original_file_path": "macros\\get_custom_name\\get_custom_schema.sql", "name": "generate_schema_name", "macro_sql": "{% macro generate_schema_name(custom_schema_name=none, node=none) -%}\n    {{ return(adapter.dispatch('generate_schema_name', 'dbt')(custom_schema_name, node)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__generate_schema_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6420631}, "macro.dbt.default__generate_schema_name": {"unique_id": "macro.dbt.default__generate_schema_name", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_schema.sql", "original_file_path": "macros\\get_custom_name\\get_custom_schema.sql", "name": "default__generate_schema_name", "macro_sql": "{% macro default__generate_schema_name(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if custom_schema_name is none -%}\n\n        {{ default_schema }}\n\n    {%- else -%}\n\n        {{ default_schema }}_{{ custom_schema_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6430588}, "macro.dbt.generate_schema_name_for_env": {"unique_id": "macro.dbt.generate_schema_name_for_env", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_schema.sql", "original_file_path": "macros\\get_custom_name\\get_custom_schema.sql", "name": "generate_schema_name_for_env", "macro_sql": "{% macro generate_schema_name_for_env(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if target.name == 'prod' and custom_schema_name is not none -%}\n\n        {{ custom_schema_name | trim }}\n\n    {%- else -%}\n\n        {{ default_schema }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6430588}, "macro.dbt.set_sql_header": {"unique_id": "macro.dbt.set_sql_header", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\configs.sql", "original_file_path": "macros\\materializations\\configs.sql", "name": "set_sql_header", "macro_sql": "{% macro set_sql_header(config) -%}\n  {{ config.set('sql_header', caller()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6440563}, "macro.dbt.should_full_refresh": {"unique_id": "macro.dbt.should_full_refresh", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\configs.sql", "original_file_path": "macros\\materializations\\configs.sql", "name": "should_full_refresh", "macro_sql": "{% macro should_full_refresh() %}\n  {% set config_full_refresh = config.get('full_refresh') %}\n  {% if config_full_refresh is none %}\n    {% set config_full_refresh = flags.FULL_REFRESH %}\n  {% endif %}\n  {% do return(config_full_refresh) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6450531}, "macro.dbt.should_store_failures": {"unique_id": "macro.dbt.should_store_failures", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\configs.sql", "original_file_path": "macros\\materializations\\configs.sql", "name": "should_store_failures", "macro_sql": "{% macro should_store_failures() %}\n  {% set config_store_failures = config.get('store_failures') %}\n  {% if config_store_failures is none %}\n    {% set config_store_failures = flags.STORE_FAILURES %}\n  {% endif %}\n  {% do return(config_store_failures) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6460505}, "macro.dbt.run_hooks": {"unique_id": "macro.dbt.run_hooks", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\hooks.sql", "original_file_path": "macros\\materializations\\hooks.sql", "name": "run_hooks", "macro_sql": "{% macro run_hooks(hooks, inside_transaction=True) %}\n  {% for hook in hooks | selectattr('transaction', 'equalto', inside_transaction)  %}\n    {% if not inside_transaction and loop.first %}\n      {% call statement(auto_begin=inside_transaction) %}\n        commit;\n      {% endcall %}\n    {% endif %}\n    {% set rendered = render(hook.get('sql')) | trim %}\n    {% if (rendered | length) > 0 %}\n      {% call statement(auto_begin=inside_transaction) %}\n        {{ rendered }}\n      {% endcall %}\n    {% endif %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.648045}, "macro.dbt.make_hook_config": {"unique_id": "macro.dbt.make_hook_config", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\hooks.sql", "original_file_path": "macros\\materializations\\hooks.sql", "name": "make_hook_config", "macro_sql": "{% macro make_hook_config(sql, inside_transaction) %}\n    {{ tojson({\"sql\": sql, \"transaction\": inside_transaction}) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6490424}, "macro.dbt.before_begin": {"unique_id": "macro.dbt.before_begin", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\hooks.sql", "original_file_path": "macros\\materializations\\hooks.sql", "name": "before_begin", "macro_sql": "{% macro before_begin(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.65004}, "macro.dbt.in_transaction": {"unique_id": "macro.dbt.in_transaction", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\hooks.sql", "original_file_path": "macros\\materializations\\hooks.sql", "name": "in_transaction", "macro_sql": "{% macro in_transaction(sql) %}\n    {{ make_hook_config(sql, inside_transaction=True) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.65004}, "macro.dbt.after_commit": {"unique_id": "macro.dbt.after_commit", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\hooks.sql", "original_file_path": "macros\\materializations\\hooks.sql", "name": "after_commit", "macro_sql": "{% macro after_commit(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.65004}, "macro.dbt.get_quoted_csv": {"unique_id": "macro.dbt.get_quoted_csv", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "original_file_path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "name": "get_quoted_csv", "macro_sql": "{% macro get_quoted_csv(column_names) %}\n    \n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote(col)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6520343}, "macro.dbt.diff_columns": {"unique_id": "macro.dbt.diff_columns", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "original_file_path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "name": "diff_columns", "macro_sql": "{% macro diff_columns(source_columns, target_columns) %}\n\n  {% set result = [] %}\n  {% set source_names = source_columns | map(attribute = 'column') | list %}\n  {% set target_names = target_columns | map(attribute = 'column') | list %}\n   \n   {# --check whether the name attribute exists in the target - this does not perform a data type check #}\n   {% for sc in source_columns %}\n     {% if sc.name not in target_names %}\n        {{ result.append(sc) }}\n     {% endif %}\n   {% endfor %}\n  \n  {{ return(result) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6540291}, "macro.dbt.diff_column_data_types": {"unique_id": "macro.dbt.diff_column_data_types", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "original_file_path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "name": "diff_column_data_types", "macro_sql": "{% macro diff_column_data_types(source_columns, target_columns) %}\n  \n  {% set result = [] %}\n  {% for sc in source_columns %}\n    {% set tc = target_columns | selectattr(\"name\", \"equalto\", sc.name) | list | first %}\n    {% if tc %}\n      {% if sc.data_type != tc.data_type %}\n        {{ result.append( { 'column_name': tc.name, 'new_type': sc.data_type } ) }} \n      {% endif %}\n    {% endif %}\n  {% endfor %}\n\n  {{ return(result) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6550264}, "macro.dbt.materialization_incremental_default": {"unique_id": "macro.dbt.materialization_incremental_default", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\incremental.sql", "original_file_path": "macros\\materializations\\models\\incremental\\incremental.sql", "name": "materialization_incremental_default", "macro_sql": "{% materialization incremental, default -%}\n\n  {% set unique_key = config.get('unique_key') %}\n\n  {% set target_relation = this.incorporate(type='table') %}\n  {% set existing_relation = load_relation(this) %}\n  {% set tmp_relation = make_temp_relation(target_relation) %}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n\n  {% set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), default='ignore') %}\n\n  {% set tmp_identifier = model['name'] + '__dbt_tmp' %}\n  {% set backup_identifier = model['name'] + \"__dbt_backup\" %}\n\n  -- the intermediate_ and backup_ relations should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation. This has to happen before\n  -- BEGIN, in a separate transaction\n  {% set preexisting_intermediate_relation = adapter.get_relation(identifier=tmp_identifier, \n                                                                  schema=schema,\n                                                                  database=database) %}                                               \n  {% set preexisting_backup_relation = adapter.get_relation(identifier=backup_identifier,\n                                                            schema=schema,\n                                                            database=database) %}\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set to_drop = [] %}\n\n  {# -- first check whether we want to full refresh for source view or config reasons #}\n  {% set trigger_full_refresh = (full_refresh_mode or existing_relation.is_view) %}\n\n  {% if existing_relation is none %}\n      {% set build_sql = create_table_as(False, target_relation, sql) %}\n{% elif trigger_full_refresh %}\n      {#-- Make sure the backup doesn't exist so we don't encounter issues with the rename below #}\n      {% set tmp_identifier = model['name'] + '__dbt_tmp' %}\n      {% set backup_identifier = model['name'] + '__dbt_backup' %}\n      {% set intermediate_relation = existing_relation.incorporate(path={\"identifier\": tmp_identifier}) %}\n      {% set backup_relation = existing_relation.incorporate(path={\"identifier\": backup_identifier}) %}\n\n      {% set build_sql = create_table_as(False, intermediate_relation, sql) %}\n      {% set need_swap = true %}\n      {% do to_drop.append(backup_relation) %}\n  {% else %}\n    {% do run_query(create_table_as(True, tmp_relation, sql)) %}\n    {% do adapter.expand_target_column_types(\n             from_relation=tmp_relation,\n             to_relation=target_relation) %}\n    {#-- Process schema changes. Returns dict of changes if successful. Use source columns for upserting/merging --#}\n    {% set dest_columns = process_schema_changes(on_schema_change, tmp_relation, existing_relation) %}\n    {% if not dest_columns %}\n      {% set dest_columns = adapter.get_columns_in_relation(existing_relation) %}\n    {% endif %}\n    {% set build_sql = get_delete_insert_merge_sql(target_relation, tmp_relation, unique_key, dest_columns) %}\n  \n  {% endif %}\n\n  {% call statement(\"main\") %}\n      {{ build_sql }}\n  {% endcall %}\n\n  {% if need_swap %} \n      {% do adapter.rename_relation(target_relation, backup_relation) %} \n      {% do adapter.rename_relation(intermediate_relation, target_relation) %} \n  {% endif %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if existing_relation is none or existing_relation.is_view or should_full_refresh() %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {% do adapter.commit() %}\n\n  {% for rel in to_drop %}\n      {% do adapter.drop_relation(rel) %}\n  {% endfor %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.load_relation", "macro.dbt.make_temp_relation", "macro.dbt.should_full_refresh", "macro.dbt.incremental_validate_on_schema_change", "macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks", "macro.dbt.create_table_as", "macro.dbt.run_query", "macro.dbt.process_schema_changes", "macro.dbt.get_delete_insert_merge_sql", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt.create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6689904}, "macro.dbt.is_incremental": {"unique_id": "macro.dbt.is_incremental", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\is_incremental.sql", "original_file_path": "macros\\materializations\\models\\incremental\\is_incremental.sql", "name": "is_incremental", "macro_sql": "{% macro is_incremental() %}\n    {#-- do not run introspective queries in parsing #}\n    {% if not execute %}\n        {{ return(False) }}\n    {% else %}\n        {% set relation = adapter.get_relation(this.database, this.schema, this.table) %}\n        {{ return(relation is not none\n                  and relation.type == 'table'\n                  and model.config.materialized == 'incremental'\n                  and not should_full_refresh()) }}\n    {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_full_refresh"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6709857}, "macro.dbt.get_merge_sql": {"unique_id": "macro.dbt.get_merge_sql", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "get_merge_sql", "macro_sql": "{% macro get_merge_sql(target, source, unique_key, dest_columns, predicates=none) -%}\n  {{ adapter.dispatch('get_merge_sql', 'dbt')(target, source, unique_key, dest_columns, predicates) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6759732}, "macro.dbt.default__get_merge_sql": {"unique_id": "macro.dbt.default__get_merge_sql", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "default__get_merge_sql", "macro_sql": "{% macro default__get_merge_sql(target, source, unique_key, dest_columns, predicates) -%}\n    {%- set predicates = [] if predicates is none else [] + predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set update_columns = config.get('merge_update_columns', default = dest_columns | map(attribute=\"quoted\") | list) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {% if unique_key %}\n        {% set unique_key_match %}\n            DBT_INTERNAL_SOURCE.{{ unique_key }} = DBT_INTERNAL_DEST.{{ unique_key }}\n        {% endset %}\n        {% do predicates.append(unique_key_match) %}\n    {% else %}\n        {% do predicates.append('FALSE') %}\n    {% endif %}\n\n    {{ sql_header if sql_header is not none }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on {{ predicates | join(' and ') }}\n\n    {% if unique_key %}\n    when matched then update set\n        {% for column_name in update_columns -%}\n            {{ column_name }} = DBT_INTERNAL_SOURCE.{{ column_name }}\n            {%- if not loop.last %}, {%- endif %}\n        {%- endfor %}\n    {% endif %}\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6799614}, "macro.dbt.get_delete_insert_merge_sql": {"unique_id": "macro.dbt.get_delete_insert_merge_sql", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "get_delete_insert_merge_sql", "macro_sql": "{% macro get_delete_insert_merge_sql(target, source, unique_key, dest_columns) -%}\n  {{ adapter.dispatch('get_delete_insert_merge_sql', 'dbt')(target, source, unique_key, dest_columns) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_delete_insert_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6809587}, "macro.dbt.default__get_delete_insert_merge_sql": {"unique_id": "macro.dbt.default__get_delete_insert_merge_sql", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "default__get_delete_insert_merge_sql", "macro_sql": "{% macro default__get_delete_insert_merge_sql(target, source, unique_key, dest_columns) -%}\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n\n    {% if unique_key is not none %}\n    delete from {{ target }}\n    where ({{ unique_key }}) in (\n        select ({{ unique_key }})\n        from {{ source }}\n    );\n    {% endif %}\n\n    insert into {{ target }} ({{ dest_cols_csv }})\n    (\n        select {{ dest_cols_csv }}\n        from {{ source }}\n    )\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.681956}, "macro.dbt.get_insert_overwrite_merge_sql": {"unique_id": "macro.dbt.get_insert_overwrite_merge_sql", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "get_insert_overwrite_merge_sql", "macro_sql": "{% macro get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header=false) -%}\n  {{ adapter.dispatch('get_insert_overwrite_merge_sql', 'dbt')(target, source, dest_columns, predicates, include_sql_header) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_insert_overwrite_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6829531}, "macro.dbt.default__get_insert_overwrite_merge_sql": {"unique_id": "macro.dbt.default__get_insert_overwrite_merge_sql", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "default__get_insert_overwrite_merge_sql", "macro_sql": "{% macro default__get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header) -%}\n    {%- set predicates = [] if predicates is none else [] + predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {{ sql_header if sql_header is not none and include_sql_header }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on FALSE\n\n    when not matched by source\n        {% if predicates %} and {{ predicates | join(' and ') }} {% endif %}\n        then delete\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.685945}, "macro.dbt.incremental_validate_on_schema_change": {"unique_id": "macro.dbt.incremental_validate_on_schema_change", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "original_file_path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "name": "incremental_validate_on_schema_change", "macro_sql": "{% macro incremental_validate_on_schema_change(on_schema_change, default='ignore') %}\n   \n   {% if on_schema_change not in ['sync_all_columns', 'append_new_columns', 'fail', 'ignore'] %}\n     \n     {% set log_message = 'Invalid value for on_schema_change (%s) specified. Setting default value of %s.' % (on_schema_change, default) %}\n     {% do log(log_message) %}\n     \n     {{ return(default) }}\n\n   {% else %}\n\n     {{ return(on_schema_change) }}\n   \n   {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.6969163}, "macro.dbt.check_for_schema_changes": {"unique_id": "macro.dbt.check_for_schema_changes", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "original_file_path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "name": "check_for_schema_changes", "macro_sql": "{% macro check_for_schema_changes(source_relation, target_relation) %}\n  \n  {% set schema_changed = False %}\n  \n  {%- set source_columns = adapter.get_columns_in_relation(source_relation) -%}\n  {%- set target_columns = adapter.get_columns_in_relation(target_relation) -%}\n  {%- set source_not_in_target = diff_columns(source_columns, target_columns) -%}\n  {%- set target_not_in_source = diff_columns(target_columns, source_columns) -%}\n\n  {% set new_target_types = diff_column_data_types(source_columns, target_columns) %}\n\n  {% if source_not_in_target != [] %}\n    {% set schema_changed = True %}\n  {% elif target_not_in_source != [] or new_target_types != [] %}\n    {% set schema_changed = True %}\n  {% elif new_target_types != [] %}\n    {% set schema_changed = True %}\n  {% endif %}\n  \n  {% set changes_dict = {\n    'schema_changed': schema_changed,\n    'source_not_in_target': source_not_in_target,\n    'target_not_in_source': target_not_in_source,\n    'source_columns': source_columns,\n    'target_columns': target_columns,\n    'new_target_types': new_target_types\n  } %}\n\n  {% set msg %}\n    In {{ target_relation }}:\n        Schema changed: {{ schema_changed }}\n        Source columns not in target: {{ source_not_in_target }}\n        Target columns not in source: {{ target_not_in_source }}\n        New column types: {{ new_target_types }}\n  {% endset %}\n  \n  {% do log(msg) %}\n\n  {{ return(changes_dict) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.diff_columns", "macro.dbt.diff_column_data_types"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7009053}, "macro.dbt.sync_column_schemas": {"unique_id": "macro.dbt.sync_column_schemas", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "original_file_path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "name": "sync_column_schemas", "macro_sql": "{% macro sync_column_schemas(on_schema_change, target_relation, schema_changes_dict) %}\n  \n  {%- set add_to_target_arr = schema_changes_dict['source_not_in_target'] -%}\n\n  {%- if on_schema_change == 'append_new_columns'-%}\n     {%- if add_to_target_arr | length > 0 -%}\n       {%- do alter_relation_add_remove_columns(target_relation, add_to_target_arr, none) -%}\n     {%- endif -%}\n  \n  {% elif on_schema_change == 'sync_all_columns' %}\n     {%- set remove_from_target_arr = schema_changes_dict['target_not_in_source'] -%}\n     {%- set new_target_types = schema_changes_dict['new_target_types'] -%}\n  \n     {% if add_to_target_arr | length > 0 or remove_from_target_arr | length > 0 %} \n       {%- do alter_relation_add_remove_columns(target_relation, add_to_target_arr, remove_from_target_arr) -%}\n     {% endif %}\n\n     {% if new_target_types != [] %}\n       {% for ntt in new_target_types %}\n         {% set column_name = ntt['column_name'] %}\n         {% set new_type = ntt['new_type'] %}\n         {% do alter_column_type(target_relation, column_name, new_type) %}\n       {% endfor %}\n     {% endif %}\n  \n  {% endif %}\n\n  {% set schema_change_message %}\n    In {{ target_relation }}:\n        Schema change approach: {{ on_schema_change }}\n        Columns added: {{ add_to_target_arr }}\n        Columns removed: {{ remove_from_target_arr }}\n        Data types changed: {{ new_target_types }}\n  {% endset %}\n  \n  {% do log(schema_change_message) %}\n  \n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.alter_relation_add_remove_columns", "macro.dbt.alter_column_type"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7048929}, "macro.dbt.process_schema_changes": {"unique_id": "macro.dbt.process_schema_changes", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "original_file_path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "name": "process_schema_changes", "macro_sql": "{% macro process_schema_changes(on_schema_change, source_relation, target_relation) %}\n    \n    {% if on_schema_change == 'ignore' %}\n\n     {{ return({}) }}\n\n    {% else %}\n    \n      {% set schema_changes_dict = check_for_schema_changes(source_relation, target_relation) %}\n      \n      {% if schema_changes_dict['schema_changed'] %}\n    \n        {% if on_schema_change == 'fail' %}\n        \n          {% set fail_msg %}\n              The source and target schemas on this incremental model are out of sync!\n              They can be reconciled in several ways: \n                - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.\n                - Re-run the incremental model with `full_refresh: True` to update the target schema.\n                - update the schema manually and re-run the process.\n          {% endset %}\n          \n          {% do exceptions.raise_compiler_error(fail_msg) %}\n        \n        {# -- unless we ignore, run the sync operation per the config #}\n        {% else %}\n          \n          {% do sync_column_schemas(on_schema_change, target_relation, schema_changes_dict) %}\n        \n        {% endif %}\n      \n      {% endif %}\n\n      {{ return(schema_changes_dict['source_columns']) }}\n    \n    {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.check_for_schema_changes", "macro.dbt.sync_column_schemas"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7068899}, "macro.dbt.get_create_table_as_sql": {"unique_id": "macro.dbt.get_create_table_as_sql", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\table\\create_table_as.sql", "original_file_path": "macros\\materializations\\models\\table\\create_table_as.sql", "name": "get_create_table_as_sql", "macro_sql": "{% macro get_create_table_as_sql(temporary, relation, sql) -%}\n  {{ adapter.dispatch('get_create_table_as_sql', 'dbt')(temporary, relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_create_table_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7088852}, "macro.dbt.default__get_create_table_as_sql": {"unique_id": "macro.dbt.default__get_create_table_as_sql", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\table\\create_table_as.sql", "original_file_path": "macros\\materializations\\models\\table\\create_table_as.sql", "name": "default__get_create_table_as_sql", "macro_sql": "{% macro default__get_create_table_as_sql(temporary, relation, sql) -%}\n  {{ return(create_table_as(temporary, relation, sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7088852}, "macro.dbt.create_table_as": {"unique_id": "macro.dbt.create_table_as", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\table\\create_table_as.sql", "original_file_path": "macros\\materializations\\models\\table\\create_table_as.sql", "name": "create_table_as", "macro_sql": "{% macro create_table_as(temporary, relation, sql) -%}\n  {{ adapter.dispatch('create_table_as', 'dbt')(temporary, relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7098815}, "macro.dbt.default__create_table_as": {"unique_id": "macro.dbt.default__create_table_as", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\table\\create_table_as.sql", "original_file_path": "macros\\materializations\\models\\table\\create_table_as.sql", "name": "default__create_table_as", "macro_sql": "{% macro default__create_table_as(temporary, relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n  \n  {{ sql_header if sql_header is not none }}\n  \n  create {% if temporary: -%}temporary{%- endif %} table\n    {{ relation.include(database=(not temporary), schema=(not temporary)) }}\n  as (\n    {{ sql }}\n  );\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.711876}, "macro.dbt.materialization_table_default": {"unique_id": "macro.dbt.materialization_table_default", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\table\\table.sql", "original_file_path": "macros\\materializations\\models\\table\\table.sql", "name": "materialization_table_default", "macro_sql": "{% materialization table, default %}\n  {%- set identifier = model['alias'] -%}\n  {%- set tmp_identifier = model['name'] + '__dbt_tmp' -%}\n  {%- set backup_identifier = model['name'] + '__dbt_backup' -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set target_relation = api.Relation.create(identifier=identifier,\n                                                schema=schema,\n                                                database=database,\n                                                type='table') -%}\n  {%- set intermediate_relation = api.Relation.create(identifier=tmp_identifier,\n                                                      schema=schema,\n                                                      database=database,\n                                                      type='table') -%}\n  -- the intermediate_relation should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation\n  {%- set preexisting_intermediate_relation = adapter.get_relation(identifier=tmp_identifier, \n                                                                   schema=schema,\n                                                                   database=database) -%}\n  /*\n      See ../view/view.sql for more information about this relation.\n  */\n  {%- set backup_relation_type = 'table' if old_relation is none else old_relation.type -%}\n  {%- set backup_relation = api.Relation.create(identifier=backup_identifier,\n                                                schema=schema,\n                                                database=database,\n                                                type=backup_relation_type) -%}\n  -- as above, the backup_relation should not already exist\n  {%- set preexisting_backup_relation = adapter.get_relation(identifier=backup_identifier,\n                                                             schema=schema,\n                                                             database=database) -%}\n\n\n  -- drop the temp relations if they exist already in the database\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_table_as_sql(False, intermediate_relation, sql) }}\n  {%- endcall %}\n\n  -- cleanup\n  {% if old_relation is not none %}\n      {{ adapter.rename_relation(old_relation, backup_relation) }}\n  {% endif %}\n\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {% do create_indexes(target_relation) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {% do persist_docs(target_relation, model) %}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  -- finally, drop the existing/backup relation after the commit\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.get_create_table_as_sql", "macro.dbt.create_indexes", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7218494}, "macro.dbt.create_or_replace_view": {"unique_id": "macro.dbt.create_or_replace_view", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\create_or_replace_view.sql", "original_file_path": "macros\\materializations\\models\\view\\create_or_replace_view.sql", "name": "create_or_replace_view", "macro_sql": "{% macro create_or_replace_view() %}\n  {%- set identifier = model['alias'] -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set target_relation = api.Relation.create(\n      identifier=identifier, schema=schema, database=database,\n      type='view') -%}\n\n  {{ run_hooks(pre_hooks) }}\n\n  -- If there's a table with the same name and we weren't told to full refresh,\n  -- that's an error. If we were told to full refresh, drop it. This behavior differs\n  -- for Snowflake and BigQuery, so multiple dispatch is used.\n  {%- if old_relation is not none and old_relation.is_table -%}\n    {{ handle_existing_table(should_full_refresh(), old_relation) }}\n  {%- endif -%}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_view_as_sql(target_relation, sql) }}\n  {%- endcall %}\n\n  {{ run_hooks(post_hooks) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.handle_existing_table", "macro.dbt.should_full_refresh", "macro.dbt.statement", "macro.dbt.get_create_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7268362}, "macro.dbt.get_create_view_as_sql": {"unique_id": "macro.dbt.get_create_view_as_sql", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\create_view_as.sql", "original_file_path": "macros\\materializations\\models\\view\\create_view_as.sql", "name": "get_create_view_as_sql", "macro_sql": "{% macro get_create_view_as_sql(relation, sql) -%}\n  {{ adapter.dispatch('get_create_view_as_sql', 'dbt')(relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_create_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7278342}, "macro.dbt.default__get_create_view_as_sql": {"unique_id": "macro.dbt.default__get_create_view_as_sql", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\create_view_as.sql", "original_file_path": "macros\\materializations\\models\\view\\create_view_as.sql", "name": "default__get_create_view_as_sql", "macro_sql": "{% macro default__get_create_view_as_sql(relation, sql) -%}\n  {{ return(create_view_as(relation, sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_view_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7278342}, "macro.dbt.create_view_as": {"unique_id": "macro.dbt.create_view_as", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\create_view_as.sql", "original_file_path": "macros\\materializations\\models\\view\\create_view_as.sql", "name": "create_view_as", "macro_sql": "{% macro create_view_as(relation, sql) -%}\n  {{ adapter.dispatch('create_view_as', 'dbt')(relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__create_view_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7288308}, "macro.dbt.default__create_view_as": {"unique_id": "macro.dbt.default__create_view_as", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\create_view_as.sql", "original_file_path": "macros\\materializations\\models\\view\\create_view_as.sql", "name": "default__create_view_as", "macro_sql": "{% macro default__create_view_as(relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n  create view {{ relation }} as (\n    {{ sql }}\n  );\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7288308}, "macro.dbt.handle_existing_table": {"unique_id": "macro.dbt.handle_existing_table", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\helpers.sql", "original_file_path": "macros\\materializations\\models\\view\\helpers.sql", "name": "handle_existing_table", "macro_sql": "{% macro handle_existing_table(full_refresh, old_relation) %}\n    {{ adapter.dispatch('handle_existing_table', 'dbt')(full_refresh, old_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__handle_existing_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7298281}, "macro.dbt.default__handle_existing_table": {"unique_id": "macro.dbt.default__handle_existing_table", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\helpers.sql", "original_file_path": "macros\\materializations\\models\\view\\helpers.sql", "name": "default__handle_existing_table", "macro_sql": "{% macro default__handle_existing_table(full_refresh, old_relation) %}\n    {{ log(\"Dropping relation \" ~ old_relation ~ \" because it is of type \" ~ old_relation.type) }}\n    {{ adapter.drop_relation(old_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7308254}, "macro.dbt.materialization_view_default": {"unique_id": "macro.dbt.materialization_view_default", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\view.sql", "original_file_path": "macros\\materializations\\models\\view\\view.sql", "name": "materialization_view_default", "macro_sql": "{%- materialization view, default -%}\n\n  {%- set identifier = model['alias'] -%}\n  {%- set tmp_identifier = model['name'] + '__dbt_tmp' -%}\n  {%- set backup_identifier = model['name'] + '__dbt_backup' -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set target_relation = api.Relation.create(identifier=identifier, schema=schema, database=database,\n                                                type='view') -%}\n  {%- set intermediate_relation = api.Relation.create(identifier=tmp_identifier,\n                                                      schema=schema, database=database, type='view') -%}\n  -- the intermediate_relation should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation\n  {%- set preexisting_intermediate_relation = adapter.get_relation(identifier=tmp_identifier, \n                                                                   schema=schema,\n                                                                   database=database) -%}\n  /*\n     This relation (probably) doesn't exist yet. If it does exist, it's a leftover from\n     a previous run, and we're going to try to drop it immediately. At the end of this\n     materialization, we're going to rename the \"old_relation\" to this identifier,\n     and then we're going to drop it. In order to make sure we run the correct one of:\n       - drop view ...\n       - drop table ...\n\n     We need to set the type of this relation to be the type of the old_relation, if it exists,\n     or else \"view\" as a sane default if it does not. Note that if the old_relation does not\n     exist, then there is nothing to move out of the way and subsequentally drop. In that case,\n     this relation will be effectively unused.\n  */\n  {%- set backup_relation_type = 'view' if old_relation is none else old_relation.type -%}\n  {%- set backup_relation = api.Relation.create(identifier=backup_identifier,\n                                                schema=schema, database=database,\n                                                type=backup_relation_type) -%}\n  -- as above, the backup_relation should not already exist\n  {%- set preexisting_backup_relation = adapter.get_relation(identifier=backup_identifier,\n                                                             schema=schema,\n                                                             database=database) -%}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- drop the temp relations if they exist already in the database\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ create_view_as(intermediate_relation, sql) }}\n  {%- endcall %}\n\n  -- cleanup\n  -- move the existing view out of the way\n  {% if old_relation is not none %}\n    {{ adapter.rename_relation(old_relation, backup_relation) }}\n  {% endif %}\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.drop_relation_if_exists", "macro.dbt.statement", "macro.dbt.create_view_as", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7418065}, "macro.dbt.create_csv_table": {"unique_id": "macro.dbt.create_csv_table", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "create_csv_table", "macro_sql": "{% macro create_csv_table(model, agate_table) -%}\n  {{ adapter.dispatch('create_csv_table', 'dbt')(model, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__create_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.753764}, "macro.dbt.default__create_csv_table": {"unique_id": "macro.dbt.default__create_csv_table", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "default__create_csv_table", "macro_sql": "{% macro default__create_csv_table(model, agate_table) %}\n  {%- set column_override = model['config'].get('column_types', {}) -%}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n\n  {% set sql %}\n    create table {{ this.render() }} (\n        {%- for col_name in agate_table.column_names -%}\n            {%- set inferred_type = adapter.convert_type(agate_table, loop.index0) -%}\n            {%- set type = column_override.get(col_name, inferred_type) -%}\n            {%- set column_name = (col_name | string) -%}\n            {{ adapter.quote_seed_column(column_name, quote_seed_column) }} {{ type }} {%- if not loop.last -%}, {%- endif -%}\n        {%- endfor -%}\n    )\n  {% endset %}\n\n  {% call statement('_') -%}\n    {{ sql }}\n  {%- endcall %}\n\n  {{ return(sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7567568}, "macro.dbt.reset_csv_table": {"unique_id": "macro.dbt.reset_csv_table", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "reset_csv_table", "macro_sql": "{% macro reset_csv_table(model, full_refresh, old_relation, agate_table) -%}\n  {{ adapter.dispatch('reset_csv_table', 'dbt')(model, full_refresh, old_relation, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__reset_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7577543}, "macro.dbt.default__reset_csv_table": {"unique_id": "macro.dbt.default__reset_csv_table", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "default__reset_csv_table", "macro_sql": "{% macro default__reset_csv_table(model, full_refresh, old_relation, agate_table) %}\n    {% set sql = \"\" %}\n    {% if full_refresh %}\n        {{ adapter.drop_relation(old_relation) }}\n        {% set sql = create_csv_table(model, agate_table) %}\n    {% else %}\n        {{ adapter.truncate_relation(old_relation) }}\n        {% set sql = \"truncate table \" ~ old_relation %}\n    {% endif %}\n\n    {{ return(sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.759748}, "macro.dbt.get_binding_char": {"unique_id": "macro.dbt.get_binding_char", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "get_binding_char", "macro_sql": "{% macro get_binding_char() -%}\n  {{ adapter.dispatch('get_binding_char', 'dbt')() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_binding_char"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.759748}, "macro.dbt.default__get_binding_char": {"unique_id": "macro.dbt.default__get_binding_char", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "default__get_binding_char", "macro_sql": "{% macro default__get_binding_char() %}\n  {{ return('%s') }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.759748}, "macro.dbt.get_batch_size": {"unique_id": "macro.dbt.get_batch_size", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "get_batch_size", "macro_sql": "{% macro get_batch_size() -%}\n  {{ return(adapter.dispatch('get_batch_size', 'dbt')()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_batch_size"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7607448}, "macro.dbt.default__get_batch_size": {"unique_id": "macro.dbt.default__get_batch_size", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "default__get_batch_size", "macro_sql": "{% macro default__get_batch_size() %}\n  {{ return(10000) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7607448}, "macro.dbt.get_seed_column_quoted_csv": {"unique_id": "macro.dbt.get_seed_column_quoted_csv", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "get_seed_column_quoted_csv", "macro_sql": "{% macro get_seed_column_quoted_csv(model, column_names) %}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote_seed_column(col, quote_seed_column)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.76274}, "macro.dbt.load_csv_rows": {"unique_id": "macro.dbt.load_csv_rows", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "load_csv_rows", "macro_sql": "{% macro load_csv_rows(model, agate_table) -%}\n  {{ adapter.dispatch('load_csv_rows', 'dbt')(model, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__load_csv_rows"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.76274}, "macro.dbt.default__load_csv_rows": {"unique_id": "macro.dbt.default__load_csv_rows", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "default__load_csv_rows", "macro_sql": "{% macro default__load_csv_rows(model, agate_table) %}\n\n  {% set batch_size = get_batch_size() %}\n\n  {% set cols_sql = get_seed_column_quoted_csv(model, agate_table.column_names) %}\n  {% set bindings = [] %}\n\n  {% set statements = [] %}\n\n  {% for chunk in agate_table.rows | batch(batch_size) %}\n      {% set bindings = [] %}\n\n      {% for row in chunk %}\n          {% do bindings.extend(row) %}\n      {% endfor %}\n\n      {% set sql %}\n          insert into {{ this.render() }} ({{ cols_sql }}) values\n          {% for row in chunk -%}\n              ({%- for column in agate_table.column_names -%}\n                  {{ get_binding_char() }}\n                  {%- if not loop.last%},{%- endif %}\n              {%- endfor -%})\n              {%- if not loop.last%},{%- endif %}\n          {%- endfor %}\n      {% endset %}\n\n      {% do adapter.add_query(sql, bindings=bindings, abridge_sql_log=True) %}\n\n      {% if loop.index0 == 0 %}\n          {% do statements.append(sql) %}\n      {% endif %}\n  {% endfor %}\n\n  {# Return SQL so we can render it out into the compiled files #}\n  {{ return(statements[0]) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_batch_size", "macro.dbt.get_seed_column_quoted_csv", "macro.dbt.get_binding_char"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7667289}, "macro.dbt.materialization_seed_default": {"unique_id": "macro.dbt.materialization_seed_default", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\seed.sql", "original_file_path": "macros\\materializations\\seeds\\seed.sql", "name": "materialization_seed_default", "macro_sql": "{% materialization seed, default %}\n\n  {%- set identifier = model['alias'] -%}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n\n  {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set agate_table = load_agate_table() -%}\n  {%- do store_result('agate_table', response='OK', agate_table=agate_table) -%}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% set create_table_sql = \"\" %}\n  {% if exists_as_view %}\n    {{ exceptions.raise_compiler_error(\"Cannot seed to '{}', it is a view\".format(old_relation)) }}\n  {% elif exists_as_table %}\n    {% set create_table_sql = reset_csv_table(model, full_refresh_mode, old_relation, agate_table) %}\n  {% else %}\n    {% set create_table_sql = create_csv_table(model, agate_table) %}\n  {% endif %}\n\n  {% set code = 'CREATE' if full_refresh_mode else 'INSERT' %}\n  {% set rows_affected = (agate_table.rows | length) %}\n  {% set sql = load_csv_rows(model, agate_table) %}\n\n  {% call noop_statement('main', code ~ ' ' ~ rows_affected, code, rows_affected) %}\n    {{ create_table_sql }};\n    -- dbt seed --\n    {{ sql }}\n  {% endcall %}\n\n  {% set target_relation = this.incorporate(type='table') %}\n  {% do persist_docs(target_relation, model) %}\n\n  {% if full_refresh_mode or not exists_as_table %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_full_refresh", "macro.dbt.run_hooks", "macro.dbt.reset_csv_table", "macro.dbt.create_csv_table", "macro.dbt.load_csv_rows", "macro.dbt.noop_statement", "macro.dbt.persist_docs", "macro.dbt.create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7757065}, "macro.dbt.create_columns": {"unique_id": "macro.dbt.create_columns", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "create_columns", "macro_sql": "{% macro create_columns(relation, columns) %}\n  {{ adapter.dispatch('create_columns', 'dbt')(relation, columns) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__create_columns"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7836835}, "macro.dbt.default__create_columns": {"unique_id": "macro.dbt.default__create_columns", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "default__create_columns", "macro_sql": "{% macro default__create_columns(relation, columns) %}\n  {% for column in columns %}\n    {% call statement() %}\n      alter table {{ relation }} add column \"{{ column.name }}\" {{ column.data_type }};\n    {% endcall %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7846813}, "macro.dbt.post_snapshot": {"unique_id": "macro.dbt.post_snapshot", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "post_snapshot", "macro_sql": "{% macro post_snapshot(staging_relation) %}\n  {{ adapter.dispatch('post_snapshot', 'dbt')(staging_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__post_snapshot"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7856786}, "macro.dbt.default__post_snapshot": {"unique_id": "macro.dbt.default__post_snapshot", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "default__post_snapshot", "macro_sql": "{% macro default__post_snapshot(staging_relation) %}\n    {# no-op #}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7856786}, "macro.dbt.snapshot_staging_table": {"unique_id": "macro.dbt.snapshot_staging_table", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "snapshot_staging_table", "macro_sql": "{% macro snapshot_staging_table(strategy, source_sql, target_relation) -%}\n  {{ adapter.dispatch('snapshot_staging_table', 'dbt')(strategy, source_sql, target_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__snapshot_staging_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.786676}, "macro.dbt.default__snapshot_staging_table": {"unique_id": "macro.dbt.default__snapshot_staging_table", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "default__snapshot_staging_table", "macro_sql": "{% macro default__snapshot_staging_table(strategy, source_sql, target_relation) -%}\n\n    with snapshot_query as (\n\n        {{ source_sql }}\n\n    ),\n\n    snapshotted_data as (\n\n        select *,\n            {{ strategy.unique_key }} as dbt_unique_key\n\n        from {{ target_relation }}\n        where dbt_valid_to is null\n\n    ),\n\n    insertions_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key,\n            {{ strategy.updated_at }} as dbt_updated_at,\n            {{ strategy.updated_at }} as dbt_valid_from,\n            nullif({{ strategy.updated_at }}, {{ strategy.updated_at }}) as dbt_valid_to,\n            {{ strategy.scd_id }} as dbt_scd_id\n\n        from snapshot_query\n    ),\n\n    updates_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key,\n            {{ strategy.updated_at }} as dbt_updated_at,\n            {{ strategy.updated_at }} as dbt_valid_from,\n            {{ strategy.updated_at }} as dbt_valid_to\n\n        from snapshot_query\n    ),\n\n    {%- if strategy.invalidate_hard_deletes %}\n\n    deletes_source_data as (\n\n        select \n            *,\n            {{ strategy.unique_key }} as dbt_unique_key\n        from snapshot_query\n    ),\n    {% endif %}\n\n    insertions as (\n\n        select\n            'insert' as dbt_change_type,\n            source_data.*\n\n        from insertions_source_data as source_data\n        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where snapshotted_data.dbt_unique_key is null\n           or (\n                snapshotted_data.dbt_unique_key is not null\n            and (\n                {{ strategy.row_changed }}\n            )\n        )\n\n    ),\n\n    updates as (\n\n        select\n            'update' as dbt_change_type,\n            source_data.*,\n            snapshotted_data.dbt_scd_id\n\n        from updates_source_data as source_data\n        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where (\n            {{ strategy.row_changed }}\n        )\n    )\n\n    {%- if strategy.invalidate_hard_deletes -%}\n    ,\n\n    deletes as (\n    \n        select\n            'delete' as dbt_change_type,\n            source_data.*,\n            {{ snapshot_get_time() }} as dbt_valid_from,\n            {{ snapshot_get_time() }} as dbt_updated_at,\n            {{ snapshot_get_time() }} as dbt_valid_to,\n            snapshotted_data.dbt_scd_id\n    \n        from snapshotted_data\n        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where source_data.dbt_unique_key is null\n    )\n    {%- endif %}\n\n    select * from insertions\n    union all\n    select * from updates\n    {%- if strategy.invalidate_hard_deletes %}\n    union all\n    select * from deletes\n    {%- endif %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.snapshot_get_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.788671}, "macro.dbt.build_snapshot_table": {"unique_id": "macro.dbt.build_snapshot_table", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "build_snapshot_table", "macro_sql": "{% macro build_snapshot_table(strategy, sql) -%}\n  {{ adapter.dispatch('build_snapshot_table', 'dbt')(strategy, sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__build_snapshot_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.790697}, "macro.dbt.default__build_snapshot_table": {"unique_id": "macro.dbt.default__build_snapshot_table", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "default__build_snapshot_table", "macro_sql": "{% macro default__build_snapshot_table(strategy, sql) %}\n\n    select *,\n        {{ strategy.scd_id }} as dbt_scd_id,\n        {{ strategy.updated_at }} as dbt_updated_at,\n        {{ strategy.updated_at }} as dbt_valid_from,\n        nullif({{ strategy.updated_at }}, {{ strategy.updated_at }}) as dbt_valid_to\n    from (\n        {{ sql }}\n    ) sbq\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7916884}, "macro.dbt.build_snapshot_staging_table": {"unique_id": "macro.dbt.build_snapshot_staging_table", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "build_snapshot_staging_table", "macro_sql": "{% macro build_snapshot_staging_table(strategy, sql, target_relation) %}\n    {% set tmp_relation = make_temp_relation(target_relation) %}\n\n    {% set select = snapshot_staging_table(strategy, sql, target_relation) %}\n\n    {% call statement('build_snapshot_staging_relation') %}\n        {{ create_table_as(True, tmp_relation, select) }}\n    {% endcall %}\n\n    {% do return(tmp_relation) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_temp_relation", "macro.dbt.snapshot_staging_table", "macro.dbt.statement", "macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.7926595}, "macro.dbt.materialization_snapshot_default": {"unique_id": "macro.dbt.materialization_snapshot_default", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\snapshot.sql", "original_file_path": "macros\\materializations\\snapshots\\snapshot.sql", "name": "materialization_snapshot_default", "macro_sql": "{% materialization snapshot, default %}\n  {%- set config = model['config'] -%}\n\n  {%- set target_table = model.get('alias', model.get('name')) -%}\n\n  {%- set strategy_name = config.get('strategy') -%}\n  {%- set unique_key = config.get('unique_key') %}\n\n  {% if not adapter.check_schema_exists(model.database, model.schema) %}\n    {% do create_schema(model.database, model.schema) %}\n  {% endif %}\n\n  {% set target_relation_exists, target_relation = get_or_create_relation(\n          database=model.database,\n          schema=model.schema,\n          identifier=target_table,\n          type='table') -%}\n\n  {%- if not target_relation.is_table -%}\n    {% do exceptions.relation_wrong_type(target_relation, 'table') %}\n  {%- endif -%}\n\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set strategy_macro = strategy_dispatch(strategy_name) %}\n  {% set strategy = strategy_macro(model, \"snapshotted_data\", \"source_data\", config, target_relation_exists) %}\n\n  {% if not target_relation_exists %}\n\n      {% set build_sql = build_snapshot_table(strategy, model['compiled_sql']) %}\n      {% set final_sql = create_table_as(False, target_relation, build_sql) %}\n\n  {% else %}\n\n      {{ adapter.valid_snapshot_target(target_relation) }}\n\n      {% set staging_table = build_snapshot_staging_table(strategy, sql, target_relation) %}\n\n      -- this may no-op if the database does not require column expansion\n      {% do adapter.expand_target_column_types(from_relation=staging_table,\n                                               to_relation=target_relation) %}\n\n      {% set missing_columns = adapter.get_missing_columns(staging_table, target_relation)\n                                   | rejectattr('name', 'equalto', 'dbt_change_type')\n                                   | rejectattr('name', 'equalto', 'DBT_CHANGE_TYPE')\n                                   | rejectattr('name', 'equalto', 'dbt_unique_key')\n                                   | rejectattr('name', 'equalto', 'DBT_UNIQUE_KEY')\n                                   | list %}\n\n      {% do create_columns(target_relation, missing_columns) %}\n\n      {% set source_columns = adapter.get_columns_in_relation(staging_table)\n                                   | rejectattr('name', 'equalto', 'dbt_change_type')\n                                   | rejectattr('name', 'equalto', 'DBT_CHANGE_TYPE')\n                                   | rejectattr('name', 'equalto', 'dbt_unique_key')\n                                   | rejectattr('name', 'equalto', 'DBT_UNIQUE_KEY')\n                                   | list %}\n\n      {% set quoted_source_columns = [] %}\n      {% for column in source_columns %}\n        {% do quoted_source_columns.append(adapter.quote(column.name)) %}\n      {% endfor %}\n\n      {% set final_sql = snapshot_merge_sql(\n            target = target_relation,\n            source = staging_table,\n            insert_cols = quoted_source_columns\n         )\n      %}\n\n  {% endif %}\n\n  {% call statement('main') %}\n      {{ final_sql }}\n  {% endcall %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if not target_relation_exists %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {% if staging_table is defined %}\n      {% do post_snapshot(staging_table) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_schema", "macro.dbt.get_or_create_relation", "macro.dbt.run_hooks", "macro.dbt.strategy_dispatch", "macro.dbt.build_snapshot_table", "macro.dbt.create_table_as", "macro.dbt.build_snapshot_staging_table", "macro.dbt.create_columns", "macro.dbt.snapshot_merge_sql", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt.create_indexes", "macro.dbt.post_snapshot"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8046653}, "macro.dbt.snapshot_merge_sql": {"unique_id": "macro.dbt.snapshot_merge_sql", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\snapshot_merge.sql", "original_file_path": "macros\\materializations\\snapshots\\snapshot_merge.sql", "name": "snapshot_merge_sql", "macro_sql": "{% macro snapshot_merge_sql(target, source, insert_cols) -%}\n  {{ adapter.dispatch('snapshot_merge_sql', 'dbt')(target, source, insert_cols) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__snapshot_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8076463}, "macro.dbt.default__snapshot_merge_sql": {"unique_id": "macro.dbt.default__snapshot_merge_sql", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\snapshot_merge.sql", "original_file_path": "macros\\materializations\\snapshots\\snapshot_merge.sql", "name": "default__snapshot_merge_sql", "macro_sql": "{% macro default__snapshot_merge_sql(target, source, insert_cols) -%}\n    {%- set insert_cols_csv = insert_cols | join(', ') -%}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n    using {{ source }} as DBT_INTERNAL_SOURCE\n    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id\n\n    when matched\n     and DBT_INTERNAL_DEST.dbt_valid_to is null\n     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')\n        then update\n        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to\n\n    when not matched\n     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'\n        then insert ({{ insert_cols_csv }})\n        values ({{ insert_cols_csv }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.809614}, "macro.dbt.strategy_dispatch": {"unique_id": "macro.dbt.strategy_dispatch", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "strategy_dispatch", "macro_sql": "{% macro strategy_dispatch(name) -%}\n{% set original_name = name %}\n  {% if '.' in name %}\n    {% set package_name, name = name.split(\".\", 1) %}\n  {% else %}\n    {% set package_name = none %}\n  {% endif %}\n\n  {% if package_name is none %}\n    {% set package_context = context %}\n  {% elif package_name in context %}\n    {% set package_context = context[package_name] %}\n  {% else %}\n    {% set error_msg %}\n        Could not find package '{{package_name}}', called with '{{original_name}}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n\n  {%- set search_name = 'snapshot_' ~ name ~ '_strategy' -%}\n\n  {% if search_name not in package_context %}\n    {% set error_msg %}\n        The specified strategy macro '{{name}}' was not found in package '{{ package_name }}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n  {{ return(package_context[search_name]) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8165948}, "macro.dbt.snapshot_hash_arguments": {"unique_id": "macro.dbt.snapshot_hash_arguments", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "snapshot_hash_arguments", "macro_sql": "{% macro snapshot_hash_arguments(args) -%}\n  {{ adapter.dispatch('snapshot_hash_arguments', 'dbt')(args) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8165948}, "macro.dbt.default__snapshot_hash_arguments": {"unique_id": "macro.dbt.default__snapshot_hash_arguments", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "default__snapshot_hash_arguments", "macro_sql": "{% macro default__snapshot_hash_arguments(args) -%}\n    md5({%- for arg in args -%}\n        coalesce(cast({{ arg }} as varchar ), '')\n        {% if not loop.last %} || '|' || {% endif %}\n    {%- endfor -%})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8176134}, "macro.dbt.snapshot_get_time": {"unique_id": "macro.dbt.snapshot_get_time", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "snapshot_get_time", "macro_sql": "{% macro snapshot_get_time() -%}\n  {{ adapter.dispatch('snapshot_get_time', 'dbt')() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__snapshot_get_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8176134}, "macro.dbt.default__snapshot_get_time": {"unique_id": "macro.dbt.default__snapshot_get_time", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "default__snapshot_get_time", "macro_sql": "{% macro default__snapshot_get_time() -%}\n  {{ current_timestamp() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8176134}, "macro.dbt.snapshot_timestamp_strategy": {"unique_id": "macro.dbt.snapshot_timestamp_strategy", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "snapshot_timestamp_strategy", "macro_sql": "{% macro snapshot_timestamp_strategy(node, snapshotted_rel, current_rel, config, target_exists) %}\n    {% set primary_key = config['unique_key'] %}\n    {% set updated_at = config['updated_at'] %}\n    {% set invalidate_hard_deletes = config.get('invalidate_hard_deletes', false) %}\n\n    {#/*\n        The snapshot relation might not have an {{ updated_at }} value if the\n        snapshot strategy is changed from `check` to `timestamp`. We\n        should use a dbt-created column for the comparison in the snapshot\n        table instead of assuming that the user-supplied {{ updated_at }}\n        will be present in the historical data.\n\n        See https://github.com/dbt-labs/dbt-core/issues/2350\n    */ #}\n    {% set row_changed_expr -%}\n        ({{ snapshotted_rel }}.dbt_valid_from < {{ current_rel }}.{{ updated_at }})\n    {%- endset %}\n\n    {% set scd_id_expr = snapshot_hash_arguments([primary_key, updated_at]) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes\n    }) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8196177}, "macro.dbt.snapshot_string_as_time": {"unique_id": "macro.dbt.snapshot_string_as_time", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "snapshot_string_as_time", "macro_sql": "{% macro snapshot_string_as_time(timestamp) -%}\n    {{ adapter.dispatch('snapshot_string_as_time', 'dbt')(timestamp) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__snapshot_string_as_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8206434}, "macro.dbt.default__snapshot_string_as_time": {"unique_id": "macro.dbt.default__snapshot_string_as_time", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "default__snapshot_string_as_time", "macro_sql": "{% macro default__snapshot_string_as_time(timestamp) %}\n    {% do exceptions.raise_not_implemented(\n        'snapshot_string_as_time macro not implemented for adapter '+adapter.type()\n    ) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8206434}, "macro.dbt.snapshot_check_all_get_existing_columns": {"unique_id": "macro.dbt.snapshot_check_all_get_existing_columns", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "snapshot_check_all_get_existing_columns", "macro_sql": "{% macro snapshot_check_all_get_existing_columns(node, target_exists) -%}\n    {%- set query_columns = get_columns_in_query(node['compiled_sql']) -%}\n    {%- if not target_exists -%}\n        {# no table yet -> return whatever the query does #}\n        {{ return([false, query_columns]) }}\n    {%- endif -%}\n    {# handle any schema changes #}\n    {%- set target_table = node.get('alias', node.get('name')) -%}\n    {%- set target_relation = adapter.get_relation(database=node.database, schema=node.schema, identifier=target_table) -%}\n    {%- set existing_cols = get_columns_in_query('select * from ' ~ target_relation) -%}\n    {%- set ns = namespace() -%} {# handle for-loop scoping with a namespace #}\n    {%- set ns.column_added = false -%}\n\n    {%- set intersection = [] -%}\n    {%- for col in query_columns -%}\n        {%- if col in existing_cols -%}\n            {%- do intersection.append(col) -%}\n        {%- else -%}\n            {% set ns.column_added = true %}\n        {%- endif -%}\n    {%- endfor -%}\n    {{ return([ns.column_added, intersection]) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_columns_in_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8235767}, "macro.dbt.snapshot_check_strategy": {"unique_id": "macro.dbt.snapshot_check_strategy", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "snapshot_check_strategy", "macro_sql": "{% macro snapshot_check_strategy(node, snapshotted_rel, current_rel, config, target_exists) %}\n    {% set check_cols_config = config['check_cols'] %}\n    {% set primary_key = config['unique_key'] %}\n    {% set invalidate_hard_deletes = config.get('invalidate_hard_deletes', false) %}\n    \n    {% set select_current_time -%}\n        select {{ snapshot_get_time() }} as snapshot_start\n    {%- endset %}\n\n    {#-- don't access the column by name, to avoid dealing with casing issues on snowflake #}\n    {%- set now = run_query(select_current_time)[0][0] -%}\n    {% if now is none or now is undefined -%}\n        {%- do exceptions.raise_compiler_error('Could not get a snapshot start time from the database') -%}\n    {%- endif %}\n    {% set updated_at = config.get('updated_at', snapshot_string_as_time(now)) %}\n\n    {% set column_added = false %}\n\n    {% if check_cols_config == 'all' %}\n        {% set column_added, check_cols = snapshot_check_all_get_existing_columns(node, target_exists) %}\n    {% elif check_cols_config is iterable and (check_cols_config | length) > 0 %}\n        {% set check_cols = check_cols_config %}\n    {% else %}\n        {% do exceptions.raise_compiler_error(\"Invalid value for 'check_cols': \" ~ check_cols_config) %}\n    {% endif %}\n\n    {%- set row_changed_expr -%}\n    (\n    {%- if column_added -%}\n        TRUE\n    {%- else -%}\n    {%- for col in check_cols -%}\n        {{ snapshotted_rel }}.{{ col }} != {{ current_rel }}.{{ col }}\n        or\n        (\n            (({{ snapshotted_rel }}.{{ col }} is null) and not ({{ current_rel }}.{{ col }} is null))\n            or\n            ((not {{ snapshotted_rel }}.{{ col }} is null) and ({{ current_rel }}.{{ col }} is null))\n        )\n        {%- if not loop.last %} or {% endif -%}\n    {%- endfor -%}\n    {%- endif -%}\n    )\n    {%- endset %}\n\n    {% set scd_id_expr = snapshot_hash_arguments([primary_key, updated_at]) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes\n    }) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.snapshot_get_time", "macro.dbt.run_query", "macro.dbt.snapshot_string_as_time", "macro.dbt.snapshot_check_all_get_existing_columns", "macro.dbt.snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8295872}, "macro.dbt.get_test_sql": {"unique_id": "macro.dbt.get_test_sql", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\tests\\helpers.sql", "original_file_path": "macros\\materializations\\tests\\helpers.sql", "name": "get_test_sql", "macro_sql": "{% macro get_test_sql(main_sql, fail_calc, warn_if, error_if, limit) -%}\n  {{ adapter.dispatch('get_test_sql', 'dbt')(main_sql, fail_calc, warn_if, error_if, limit) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8305588}, "macro.dbt.default__get_test_sql": {"unique_id": "macro.dbt.default__get_test_sql", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\tests\\helpers.sql", "original_file_path": "macros\\materializations\\tests\\helpers.sql", "name": "default__get_test_sql", "macro_sql": "{% macro default__get_test_sql(main_sql, fail_calc, warn_if, error_if, limit) -%}\n    select\n      {{ fail_calc }} as failures,\n      {{ fail_calc }} {{ warn_if }} as should_warn,\n      {{ fail_calc }} {{ error_if }} as should_error\n    from (\n      {{ main_sql }}\n      {{ \"limit \" ~ limit if limit != none }}\n    ) dbt_internal_test\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8315556}, "macro.dbt.materialization_test_default": {"unique_id": "macro.dbt.materialization_test_default", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\tests\\test.sql", "original_file_path": "macros\\materializations\\tests\\test.sql", "name": "materialization_test_default", "macro_sql": "{%- materialization test, default -%}\n\n  {% set relations = [] %}\n\n  {% if should_store_failures() %}\n\n    {% set identifier = model['alias'] %}\n    {% set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) %}\n    {% set target_relation = api.Relation.create(\n        identifier=identifier, schema=schema, database=database, type='table') -%} %}\n    \n    {% if old_relation %}\n        {% do adapter.drop_relation(old_relation) %}\n    {% endif %}\n    \n    {% call statement(auto_begin=True) %}\n        {{ create_table_as(False, target_relation, sql) }}\n    {% endcall %}\n    \n    {% do relations.append(target_relation) %}\n  \n    {% set main_sql %}\n        select *\n        from {{ target_relation }}\n    {% endset %}\n    \n    {{ adapter.commit() }}\n  \n  {% else %}\n\n      {% set main_sql = sql %}\n  \n  {% endif %}\n\n  {% set limit = config.get('limit') %}\n  {% set fail_calc = config.get('fail_calc') %}\n  {% set warn_if = config.get('warn_if') %}\n  {% set error_if = config.get('error_if') %}\n\n  {% call statement('main', fetch_result=True) -%}\n\n    {{ get_test_sql(main_sql, fail_calc, warn_if, error_if, limit)}}\n\n  {%- endcall %}\n  \n  {{ return({'relations': relations}) }}\n\n{%- endmaterialization -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_store_failures", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dbt.get_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8365831}, "macro.dbt.get_where_subquery": {"unique_id": "macro.dbt.get_where_subquery", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\tests\\where_subquery.sql", "original_file_path": "macros\\materializations\\tests\\where_subquery.sql", "name": "get_where_subquery", "macro_sql": "{% macro get_where_subquery(relation) -%}\n    {% do return(adapter.dispatch('get_where_subquery', 'dbt')(relation)) %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_where_subquery"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8375394}, "macro.dbt.default__get_where_subquery": {"unique_id": "macro.dbt.default__get_where_subquery", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\tests\\where_subquery.sql", "original_file_path": "macros\\materializations\\tests\\where_subquery.sql", "name": "default__get_where_subquery", "macro_sql": "{% macro default__get_where_subquery(relation) -%}\n    {% set where = config.get('where', '') %}\n    {% if where %}\n        {%- set filtered -%}\n            (select * from {{ relation }} where {{ where }}) dbt_subquery\n        {%- endset -%}\n        {% do return(filtered) %}\n    {%- else -%}\n        {% do return(relation) %}\n    {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8385365}, "macro.dbt.test_unique": {"unique_id": "macro.dbt.test_unique", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "tests\\generic\\builtin.sql", "original_file_path": "tests\\generic\\builtin.sql", "name": "test_unique", "macro_sql": "{% test unique(model, column_name) %}\n    {% set macro = adapter.dispatch('test_unique', 'dbt') %}\n    {{ macro(model, column_name) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_bigquery.bigquery__test_unique"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8395329}, "macro.dbt.test_not_null": {"unique_id": "macro.dbt.test_not_null", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "tests\\generic\\builtin.sql", "original_file_path": "tests\\generic\\builtin.sql", "name": "test_not_null", "macro_sql": "{% test not_null(model, column_name) %}\n    {% set macro = adapter.dispatch('test_not_null', 'dbt') %}\n    {{ macro(model, column_name) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_not_null"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8405302}, "macro.dbt.test_accepted_values": {"unique_id": "macro.dbt.test_accepted_values", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "tests\\generic\\builtin.sql", "original_file_path": "tests\\generic\\builtin.sql", "name": "test_accepted_values", "macro_sql": "{% test accepted_values(model, column_name, values, quote=True) %}\n    {% set macro = adapter.dispatch('test_accepted_values', 'dbt') %}\n    {{ macro(model, column_name, values, quote) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_accepted_values"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.8415291}, "macro.dbt.test_relationships": {"unique_id": "macro.dbt.test_relationships", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "tests\\generic\\builtin.sql", "original_file_path": "tests\\generic\\builtin.sql", "name": "test_relationships", "macro_sql": "{% test relationships(model, column_name, to, field) %}\n    {% set macro = adapter.dispatch('test_relationships', 'dbt') %}\n    {{ macro(model, column_name, to, field) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_relationships"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1651482437.842526}}, "docs": {"dbt.__overview__": {"unique_id": "dbt.__overview__", "package_name": "dbt", "root_path": "c:\\users\\admin\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\dbt\\include\\global_project", "path": "overview.md", "original_file_path": "docs\\overview.md", "name": "__overview__", "block_contents": "### Welcome!\n\nWelcome to the auto-generated documentation for your dbt project!\n\n### Navigation\n\nYou can use the `Project` and `Database` navigation tabs on the left side of the window to explore the models\nin your project.\n\n#### Project Tab\nThe `Project` tab mirrors the directory structure of your dbt project. In this tab, you can see all of the\nmodels defined in your dbt project, as well as models imported from dbt packages.\n\n#### Database Tab\nThe `Database` tab also exposes your models, but in a format that looks more like a database explorer. This view\nshows relations (tables and views) grouped into database schemas. Note that ephemeral models are _not_ shown\nin this interface, as they do not exist in the database.\n\n### Graph Exploration\nYou can click the blue icon on the bottom-right corner of the page to view the lineage graph of your models.\n\nOn model pages, you'll see the immediate parents and children of the model you're exploring. By clicking the `Expand`\nbutton at the top-right of this lineage pane, you'll be able to see all of the models that are used to build,\nor are built from, the model you're exploring.\n\nOnce expanded, you'll be able to use the `--select` and `--exclude` model selection syntax to filter the\nmodels in the graph. For more information on model selection, check out the [dbt docs](https://docs.getdbt.com/docs/model-selection-syntax).\n\nNote that you can also right-click on models to interactively filter and explore the graph.\n\n---\n\n### More information\n\n- [What is dbt](https://docs.getdbt.com/docs/introduction)?\n- Read the [dbt viewpoint](https://docs.getdbt.com/docs/viewpoint)\n- [Installation](https://docs.getdbt.com/docs/installation)\n- Join the [dbt Community](https://www.getdbt.com/community/) for questions and discussion"}}, "exposures": {}, "metrics": {}, "selectors": {}, "disabled": {}, "parent_map": {"model.NPS_OMOP_CDM.cost": ["model.NPS_OMOP_CDM.stg_cost_billing_service", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence"], "model.NPS_OMOP_CDM.fact_relationship": ["model.NPS_OMOP_CDM.stg_fact_drug_condition", "model.NPS_OMOP_CDM.stg_fact_drug_procedure", "model.NPS_OMOP_CDM.stg_fact_specimen_measurement"], "model.NPS_OMOP_CDM.measurement": ["model.NPS_OMOP_CDM.stg_measurement_observation", "model.NPS_OMOP_CDM.stg_measurement_pathology", "model.NPS_OMOP_CDM.stg_measurement_pathology_albumin", "model.NPS_OMOP_CDM.stg_measurement_pathology_egfr", "model.NPS_OMOP_CDM.stg_measurement_pathology_hba1c", "model.NPS_OMOP_CDM.stg_measurement_pathology_lipids", "model.NPS_OMOP_CDM.stg_measurement_pathology_result", "model.NPS_OMOP_CDM.stg_measurement_requested_test", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.provider", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence"], "model.NPS_OMOP_CDM.observation": ["model.NPS_OMOP_CDM.intermediate_stg_alcohol_status", "model.NPS_OMOP_CDM.intermediate_stg_allergy_reaction", "model.NPS_OMOP_CDM.intermediate_stg_observation", "model.NPS_OMOP_CDM.intermediate_stg_patient", "model.NPS_OMOP_CDM.intermediate_stg_requested_test", "model.NPS_OMOP_CDM.intermediate_stg_smoking_status"], "model.NPS_OMOP_CDM.observation_period": ["model.NPS_OMOP_CDM.stg_observation_period_encounter", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "model.NPS_OMOP_CDM.payer_plan_period": ["model.NPS_OMOP_CDM.stg_payer_plan_period_billing_service", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "model.NPS_OMOP_CDM.person": ["model.NPS_OMOP_CDM.stg_person_encounter", "model.NPS_OMOP_CDM.stg_person_encounter_reason", "model.NPS_OMOP_CDM.stg_person_patient", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.location"], "model.NPS_OMOP_CDM.procedure_occurrence": ["model.NPS_OMOP_CDM.stg_procedure_occurrence_diagnosis", "model.NPS_OMOP_CDM.stg_procedure_occurrence_encounter_reason", "model.NPS_OMOP_CDM.stg_procedure_occurrence_immunisation", "model.NPS_OMOP_CDM.stg_procedure_occurrence_prescription", "model.NPS_OMOP_CDM.stg_procedure_occurrence_requested_test", "model.NPS_OMOP_CDM.stg_procedure_occurrence_script_item", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.provider", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence"], "model.NPS_OMOP_CDM.provider": ["model.NPS_OMOP_CDM.stg_provider_clinical_user", "model.NPS_OMOP_CDM.stg_provider_patient_matched_usual_provider", "model.NPS_OMOP_CDM.stg_provider_practice_contact", "model.NPS_OMOP_CDM.stg_provider_requested_test", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site"], "model.NPS_OMOP_CDM.stg_care_site_site": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SITE"], "model.NPS_OMOP_CDM.stg_condition_occurrence_diagnosis": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.DIAGNOSIS"], "model.NPS_OMOP_CDM.stg_condition_occurrence_encounter_reason": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER_REASON"], "model.NPS_OMOP_CDM.stg_condition_occurrence_prescription": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRESCRIPTION"], "model.NPS_OMOP_CDM.stg_cost_billing_service": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.BILLING_SERVICE"], "model.NPS_OMOP_CDM.stg_death_patient": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT"], "model.NPS_OMOP_CDM.stg_device_exposure_immunisation": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.IMMUNISATION"], "model.NPS_OMOP_CDM.stg_device_exposure_pathology": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY"], "model.NPS_OMOP_CDM.stg_device_exposure_pathology_albumin": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_ALBUMIN"], "model.NPS_OMOP_CDM.stg_device_exposure_pathology_egfr": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_EGFR"], "model.NPS_OMOP_CDM.stg_device_exposure_pathology_hba1c": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_HBA1C"], "model.NPS_OMOP_CDM.stg_device_exposure_pathology_lipids": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_LIPIDS"], "model.NPS_OMOP_CDM.stg_device_exposure_pathology_result": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_RESULT"], "model.NPS_OMOP_CDM.stg_drug_exposure_immunisation": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.IMMUNISATION"], "model.NPS_OMOP_CDM.stg_drug_exposure_prescription": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRESCRIPTION"], "model.NPS_OMOP_CDM.stg_drug_exposure_script_item": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SCRIPT_ITEM"], "model.NPS_OMOP_CDM.stg_fact_drug_condition": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.condition_occurrence", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.drug_exposure"], "model.NPS_OMOP_CDM.stg_fact_drug_procedure": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.drug_exposure", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.procedure_occurrence"], "model.NPS_OMOP_CDM.stg_fact_specimen_measurement": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.measurement", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.specimen"], "model.NPS_OMOP_CDM.stg_location_patient": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT"], "model.NPS_OMOP_CDM.stg_location_postcode": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.POSTCODE"], "model.NPS_OMOP_CDM.stg_location_practice_recruitment": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRACTICE_RECRUITMENT"], "model.NPS_OMOP_CDM.stg_location_primary_health_network": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRIMARY_HEALTH_NETWORK"], "model.NPS_OMOP_CDM.stg_location_site": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SITE"], "model.NPS_OMOP_CDM.stg_measurement_observation": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.OBSERVATION"], "model.NPS_OMOP_CDM.stg_measurement_pathology": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY"], "model.NPS_OMOP_CDM.stg_measurement_pathology_albumin": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_ALBUMIN"], "model.NPS_OMOP_CDM.stg_measurement_pathology_egfr": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_EGFR"], "model.NPS_OMOP_CDM.stg_measurement_pathology_hba1c": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_HBA1C"], "model.NPS_OMOP_CDM.stg_measurement_pathology_lipids": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_LIPIDS"], "model.NPS_OMOP_CDM.stg_measurement_pathology_result": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_RESULT"], "model.NPS_OMOP_CDM.stg_measurement_requested_test": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.REQUESTED_TEST"], "model.NPS_OMOP_CDM.intermediate_alcohol_allergy": ["model.NPS_OMOP_CDM.intermediate_stg_alcohol_status", "model.NPS_OMOP_CDM.intermediate_stg_allergy_reaction"], "model.NPS_OMOP_CDM.intermediate_stg_alcohol_status": ["model.NPS_OMOP_CDM.stg_observation_alcohol_status", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "model.NPS_OMOP_CDM.stg_observation_alcohol_status": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ALCOHOL_STATUS"], "model.NPS_OMOP_CDM.intermediate_stg_allergy_reaction": ["model.NPS_OMOP_CDM.stg_observation_allergy_reaction", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "model.NPS_OMOP_CDM.stg_observation_allergy_reaction": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ALLERGY_REACTION"], "model.NPS_OMOP_CDM.combine_pat_obs": ["model.NPS_OMOP_CDM.intermediate_stg_observation", "model.NPS_OMOP_CDM.intermediate_stg_patient", "model.NPS_OMOP_CDM.intermediate_stg_requested_test", "model.NPS_OMOP_CDM.intermediate_stg_smoking_status"], "model.NPS_OMOP_CDM.intermediate_stg_observation": ["model.NPS_OMOP_CDM.stg_observation_observation", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "model.NPS_OMOP_CDM.stg_observation_observation": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.OBSERVATION"], "model.NPS_OMOP_CDM.intermediate_stg_patient": ["model.NPS_OMOP_CDM.stg_observation_patient"], "model.NPS_OMOP_CDM.stg_observation_patient": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT"], "model.NPS_OMOP_CDM.intermediate_stg_requested_test": ["model.NPS_OMOP_CDM.stg_observation_requested_test", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "model.NPS_OMOP_CDM.stg_observation_requested_test": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.REQUESTED_TEST"], "model.NPS_OMOP_CDM.intermediate_stg_smoking_status": ["model.NPS_OMOP_CDM.stg_observation_smoking_status", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "model.NPS_OMOP_CDM.stg_observation_smoking_status": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SMOKING_STATUS"], "model.NPS_OMOP_CDM.stg_observation_period_encounter": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER"], "model.NPS_OMOP_CDM.stg_payer_plan_period_billing_service": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.BILLING_SERVICE"], "model.NPS_OMOP_CDM.stg_person_encounter": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER"], "model.NPS_OMOP_CDM.stg_person_encounter_reason": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER_REASON"], "model.NPS_OMOP_CDM.stg_person_patient": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT"], "model.NPS_OMOP_CDM.stg_procedure_occurrence_diagnosis": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.DIAGNOSIS"], "model.NPS_OMOP_CDM.stg_procedure_occurrence_encounter_reason": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER_REASON"], "model.NPS_OMOP_CDM.stg_procedure_occurrence_immunisation": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.IMMUNISATION"], "model.NPS_OMOP_CDM.stg_procedure_occurrence_prescription": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRESCRIPTION"], "model.NPS_OMOP_CDM.stg_procedure_occurrence_requested_test": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.REQUESTED_TEST"], "model.NPS_OMOP_CDM.stg_procedure_occurrence_script_item": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SCRIPT_ITEM"], "model.NPS_OMOP_CDM.stg_provider_clinical_user": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.CLINICAL_USER"], "model.NPS_OMOP_CDM.stg_provider_patient_matched_usual_provider": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT_MATCHED_USUAL_PROVIDER"], "model.NPS_OMOP_CDM.stg_provider_practice_contact": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRACTICE_CONTACT"], "model.NPS_OMOP_CDM.stg_provider_requested_test": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.REQUESTED_TEST"], "model.NPS_OMOP_CDM.stg_specimen_pathology": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY"], "model.NPS_OMOP_CDM.stg_specimen_pathology_albumin": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_ALBUMIN"], "model.NPS_OMOP_CDM.stg_specimen_pathology_egfr": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_EGFR"], "model.NPS_OMOP_CDM.stg_specimen_pathology_hba1c": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_HBA1C"], "model.NPS_OMOP_CDM.stg_specimen_pathology_lipids": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_LIPIDS"], "model.NPS_OMOP_CDM.stg_visit_occurrence_encounter": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER"], "model.NPS_OMOP_CDM.stg_visit_occurrence_encounter_reason": ["source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER_REASON"], "test.NPS_OMOP_CDM.generic_test": [], "seed.NPS_OMOP_CDM.postcode_data": [], "test.NPS_OMOP_CDM.not_null_cost_cost_id.96e8810b57": ["model.NPS_OMOP_CDM.cost"], "test.NPS_OMOP_CDM.unique_cost_cost_id.059b55a036": ["model.NPS_OMOP_CDM.cost"], "test.NPS_OMOP_CDM.not_null_cost_cost_event_id.04919371b7": ["model.NPS_OMOP_CDM.cost"], "test.NPS_OMOP_CDM.not_null_fact_relationship_fact_id_1.c1a4cb78dc": ["model.NPS_OMOP_CDM.fact_relationship"], "test.NPS_OMOP_CDM.not_null_fact_relationship_fact_id_2.c3b8acff83": ["model.NPS_OMOP_CDM.fact_relationship"], "test.NPS_OMOP_CDM.unique_measurement_measurement_id.a3f1e8466d": ["model.NPS_OMOP_CDM.measurement"], "test.NPS_OMOP_CDM.not_null_measurement_measurement_id.80b56c4597": ["model.NPS_OMOP_CDM.measurement"], "test.NPS_OMOP_CDM.not_null_measurement_person_id.7cf48be66f": ["model.NPS_OMOP_CDM.measurement"], "test.NPS_OMOP_CDM.relationships_measurement_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.e7603f5f52": ["model.NPS_OMOP_CDM.measurement", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "test.NPS_OMOP_CDM.not_null_measurement_measurement_date.f0992e3082": ["model.NPS_OMOP_CDM.measurement"], "test.NPS_OMOP_CDM.unique_observation_observation_id.c7fcc2846f": ["model.NPS_OMOP_CDM.observation"], "test.NPS_OMOP_CDM.not_null_observation_observation_id.efd24835d6": ["model.NPS_OMOP_CDM.observation"], "test.NPS_OMOP_CDM.not_null_observation_person_id.8fa7495344": ["model.NPS_OMOP_CDM.observation"], "test.NPS_OMOP_CDM.relationships_observation_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.64381f454b": ["model.NPS_OMOP_CDM.observation", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "test.NPS_OMOP_CDM.not_null_observation_period_observation_period_id.6c6fb96d33": ["model.NPS_OMOP_CDM.observation_period"], "test.NPS_OMOP_CDM.not_null_observation_period_person_id.71c8f248d3": ["model.NPS_OMOP_CDM.observation_period"], "test.NPS_OMOP_CDM.relationships_observation_period_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.3774a43eff": ["model.NPS_OMOP_CDM.observation_period", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "test.NPS_OMOP_CDM.not_null_observation_period_observation_period_start_date.e88435db95": ["model.NPS_OMOP_CDM.observation_period"], "test.NPS_OMOP_CDM.not_null_observation_period_observation_period_end_date.e74764a048": ["model.NPS_OMOP_CDM.observation_period"], "test.NPS_OMOP_CDM.not_null_observation_period_period_type_concept_id.b993e0023c": ["model.NPS_OMOP_CDM.observation_period"], "test.NPS_OMOP_CDM.not_null_payer_plan_period_payer_plan_period_id.638983fb69": ["model.NPS_OMOP_CDM.payer_plan_period"], "test.NPS_OMOP_CDM.unique_payer_plan_period_payer_plan_period_id.68e7598f49": ["model.NPS_OMOP_CDM.payer_plan_period"], "test.NPS_OMOP_CDM.not_null_payer_plan_period_person_id.3a67e6214a": ["model.NPS_OMOP_CDM.payer_plan_period"], "test.NPS_OMOP_CDM.relationships_payer_plan_period_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.830d86145b": ["model.NPS_OMOP_CDM.payer_plan_period", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "test.NPS_OMOP_CDM.not_null_payer_plan_period_payer_plan_period_start_date.ae7d04ece1": ["model.NPS_OMOP_CDM.payer_plan_period"], "test.NPS_OMOP_CDM.not_null_payer_plan_period_payer_plan_period_end_date.1ee2bdf9bb": ["model.NPS_OMOP_CDM.payer_plan_period"], "test.NPS_OMOP_CDM.unique_person_person_id.ee18b5e56c": ["model.NPS_OMOP_CDM.person"], "test.NPS_OMOP_CDM.not_null_person_person_id.6f9ab4b4de": ["model.NPS_OMOP_CDM.person"], "test.NPS_OMOP_CDM.not_null_person_gender_concept_id.a1409c1a02": ["model.NPS_OMOP_CDM.person"], "test.NPS_OMOP_CDM.not_null_person_year_of_birth.03ea95e466": ["model.NPS_OMOP_CDM.person"], "test.NPS_OMOP_CDM.not_null_person_race_concept_id.288243421d": ["model.NPS_OMOP_CDM.person"], "test.NPS_OMOP_CDM.not_null_person_ethnicity_concept_id.e352f804af": ["model.NPS_OMOP_CDM.person"], "test.NPS_OMOP_CDM.relationships_person_location_id__location_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_location_.59c87ac44d": ["model.NPS_OMOP_CDM.person", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.location"], "test.NPS_OMOP_CDM.relationships_person_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.a9a9fa604b": ["model.NPS_OMOP_CDM.person", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site"], "test.NPS_OMOP_CDM.not_null_procedure_occurrence_procedure_occurrence_id.e3b1d90a98": ["model.NPS_OMOP_CDM.procedure_occurrence"], "test.NPS_OMOP_CDM.unique_procedure_occurrence_procedure_occurrence_id.fb0663ac66": ["model.NPS_OMOP_CDM.procedure_occurrence"], "test.NPS_OMOP_CDM.not_null_procedure_occurrence_person_id.95f33a8709": ["model.NPS_OMOP_CDM.procedure_occurrence"], "test.NPS_OMOP_CDM.relationships_procedure_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.50cfd5655b": ["model.NPS_OMOP_CDM.procedure_occurrence", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "test.NPS_OMOP_CDM.relationships_procedure_occurrence_visit_occurrence_id__visit_occurrence_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_visit_occurrence_.d81511cbb6": ["model.NPS_OMOP_CDM.procedure_occurrence", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence"], "test.NPS_OMOP_CDM.not_null_procedure_occurrence_procedure_date.7e26c7adde": ["model.NPS_OMOP_CDM.procedure_occurrence"], "test.NPS_OMOP_CDM.not_null_provider_provider_id.3b46670424": ["model.NPS_OMOP_CDM.provider"], "test.NPS_OMOP_CDM.unique_provider_provider_id.b08928e435": ["model.NPS_OMOP_CDM.provider"], "test.NPS_OMOP_CDM.relationships_provider_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.b35a07c9f4": ["model.NPS_OMOP_CDM.provider", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site"], "test.NPS_OMOP_CDM.unique_postcode_data_id.1d1de585bd": ["seed.NPS_OMOP_CDM.postcode_data"], "test.NPS_OMOP_CDM.not_null_postcode_data_id.f82d87e983": ["seed.NPS_OMOP_CDM.postcode_data"], "test.NPS_OMOP_CDM.not_null_postcode_data_postcode.c435345986": ["seed.NPS_OMOP_CDM.postcode_data"], "model.NPS_OMOP_CDM.death": ["model.NPS_OMOP_CDM.stg_death_patient", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence"], "test.NPS_OMOP_CDM.unique_death_person_id.bf3e007a4d": ["model.NPS_OMOP_CDM.death"], "test.NPS_OMOP_CDM.not_null_death_person_id.05e446446c": ["model.NPS_OMOP_CDM.death"], "test.NPS_OMOP_CDM.relationships_death_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.4e266aefbe": ["model.NPS_OMOP_CDM.death", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "test.NPS_OMOP_CDM.not_null_death_death_date.7d86f6855c": ["model.NPS_OMOP_CDM.death"], "model.NPS_OMOP_CDM.location": ["model.NPS_OMOP_CDM.stg_location_patient", "model.NPS_OMOP_CDM.stg_location_postcode", "model.NPS_OMOP_CDM.stg_location_practice_recruitment", "model.NPS_OMOP_CDM.stg_location_primary_health_network", "model.NPS_OMOP_CDM.stg_location_site", "seed.NPS_OMOP_CDM.postcode_data"], "test.NPS_OMOP_CDM.not_null_location_location_id.af91958747": ["model.NPS_OMOP_CDM.location"], "test.NPS_OMOP_CDM.unique_location_location_id.e30ffdeb77": ["model.NPS_OMOP_CDM.location"], "test.NPS_OMOP_CDM.accepted_values_location_state__NS__CT__QL__TS__VI__NT__SA__WA__None.8bc4117309": ["model.NPS_OMOP_CDM.location"], "model.NPS_OMOP_CDM.care_site": ["model.NPS_OMOP_CDM.stg_care_site_site", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.location"], "test.NPS_OMOP_CDM.not_null_care_site_care_site_id.2d320c251b": ["model.NPS_OMOP_CDM.care_site"], "test.NPS_OMOP_CDM.unique_care_site_care_site_id.9f2a10fa8e": ["model.NPS_OMOP_CDM.care_site"], "test.NPS_OMOP_CDM.relationships_care_site_location_id__location_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_location_.edadb2302e": ["model.NPS_OMOP_CDM.care_site", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.location"], "model.NPS_OMOP_CDM.condition_occurrence": ["model.NPS_OMOP_CDM.stg_condition_occurrence_diagnosis", "model.NPS_OMOP_CDM.stg_condition_occurrence_encounter_reason", "model.NPS_OMOP_CDM.stg_condition_occurrence_prescription", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence"], "test.NPS_OMOP_CDM.not_null_condition_occurrence_condition_occurrence_id.f70111fa08": ["model.NPS_OMOP_CDM.condition_occurrence"], "test.NPS_OMOP_CDM.unique_condition_occurrence_condition_occurrence_id.e4cb792f90": ["model.NPS_OMOP_CDM.condition_occurrence"], "test.NPS_OMOP_CDM.not_null_condition_occurrence_person_id.9f19d9c9cb": ["model.NPS_OMOP_CDM.condition_occurrence"], "test.NPS_OMOP_CDM.relationships_condition_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.5e206dc499": ["model.NPS_OMOP_CDM.condition_occurrence", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "test.NPS_OMOP_CDM.relationships_condition_occurrence_visit_occurrence_id__visit_occurrence_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_visit_occurrence_.106dee8b71": ["model.NPS_OMOP_CDM.condition_occurrence", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence"], "test.NPS_OMOP_CDM.not_null_condition_occurrence_condition_start_date.6cbb11717a": ["model.NPS_OMOP_CDM.condition_occurrence"], "model.NPS_OMOP_CDM.device_exposure": ["model.NPS_OMOP_CDM.stg_device_exposure_immunisation", "model.NPS_OMOP_CDM.stg_device_exposure_pathology", "model.NPS_OMOP_CDM.stg_device_exposure_pathology_albumin", "model.NPS_OMOP_CDM.stg_device_exposure_pathology_egfr", "model.NPS_OMOP_CDM.stg_device_exposure_pathology_hba1c", "model.NPS_OMOP_CDM.stg_device_exposure_pathology_lipids", "model.NPS_OMOP_CDM.stg_device_exposure_pathology_result", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "test.NPS_OMOP_CDM.unique_device_exposure_device_exposure_id.cdcba3488d": ["model.NPS_OMOP_CDM.device_exposure"], "test.NPS_OMOP_CDM.not_null_device_exposure_device_exposure_id.ab1d5a2fe5": ["model.NPS_OMOP_CDM.device_exposure"], "test.NPS_OMOP_CDM.not_null_device_exposure_person_id.1330a61d39": ["model.NPS_OMOP_CDM.device_exposure"], "test.NPS_OMOP_CDM.relationships_device_exposure_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.948ad4fe61": ["model.NPS_OMOP_CDM.device_exposure", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "test.NPS_OMOP_CDM.not_null_device_exposure_device_exposure_start_date.23aa3e8aea": ["model.NPS_OMOP_CDM.device_exposure"], "test.NPS_OMOP_CDM.not_null_device_exposure_device_concept_id.041c422e55": ["model.NPS_OMOP_CDM.device_exposure"], "model.NPS_OMOP_CDM.drug_exposure": ["model.NPS_OMOP_CDM.stg_drug_exposure_immunisation", "model.NPS_OMOP_CDM.stg_drug_exposure_prescription", "model.NPS_OMOP_CDM.stg_drug_exposure_script_item", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.provider"], "test.NPS_OMOP_CDM.unique_drug_exposure_drug_exposure_id.6e11199bfc": ["model.NPS_OMOP_CDM.drug_exposure"], "test.NPS_OMOP_CDM.not_null_drug_exposure_drug_exposure_id.a57f0904e3": ["model.NPS_OMOP_CDM.drug_exposure"], "test.NPS_OMOP_CDM.relationships_drug_exposure_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.07271b7683": ["model.NPS_OMOP_CDM.drug_exposure", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "test.NPS_OMOP_CDM.not_null_drug_exposure_drug_exposure_start_date.61d182cfaa": ["model.NPS_OMOP_CDM.drug_exposure"], "test.NPS_OMOP_CDM.not_null_drug_exposure_drug_exposure_end_date.89e020fdd4": ["model.NPS_OMOP_CDM.drug_exposure"], "test.NPS_OMOP_CDM.relationships_drug_exposure_provider_id__provider_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_provider_.e855c95c18": ["model.NPS_OMOP_CDM.drug_exposure", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.provider"], "model.NPS_OMOP_CDM.visit_occurrence": ["model.NPS_OMOP_CDM.stg_visit_occurrence_encounter", "model.NPS_OMOP_CDM.stg_visit_occurrence_encounter_reason", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "test.NPS_OMOP_CDM.not_null_visit_occurrence_visit_occurrence_id.a3a65446cf": ["model.NPS_OMOP_CDM.visit_occurrence"], "test.NPS_OMOP_CDM.unique_visit_occurrence_visit_occurrence_id.faa3aa67c6": ["model.NPS_OMOP_CDM.visit_occurrence"], "test.NPS_OMOP_CDM.not_null_visit_occurrence_person_id.e916ff163a": ["model.NPS_OMOP_CDM.visit_occurrence"], "test.NPS_OMOP_CDM.relationships_visit_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.15c614ba36": ["model.NPS_OMOP_CDM.visit_occurrence", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "test.NPS_OMOP_CDM.not_null_visit_occurrence_visit_start_date.6ef645340a": ["model.NPS_OMOP_CDM.visit_occurrence"], "test.NPS_OMOP_CDM.not_null_visit_occurrence_visit_end_date.47f6967fe8": ["model.NPS_OMOP_CDM.visit_occurrence"], "test.NPS_OMOP_CDM.relationships_visit_occurrence_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.64e29a2be0": ["model.NPS_OMOP_CDM.visit_occurrence", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site"], "model.NPS_OMOP_CDM.metadata": [], "test.NPS_OMOP_CDM.not_null_metadata_metadata_id.245549e30d": ["model.NPS_OMOP_CDM.metadata"], "test.NPS_OMOP_CDM.unique_metadata_metadata_id.c5f9aef418": ["model.NPS_OMOP_CDM.metadata"], "test.NPS_OMOP_CDM.not_null_metadata_metadata_concept_id.fbb43fc750": ["model.NPS_OMOP_CDM.metadata"], "test.NPS_OMOP_CDM.not_null_metadata_metadata_type_concept_id.ecddd5859d": ["model.NPS_OMOP_CDM.metadata"], "test.NPS_OMOP_CDM.not_null_metadata_name.21f9e599ec": ["model.NPS_OMOP_CDM.metadata"], "model.NPS_OMOP_CDM.cdm_source": ["source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.concept", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.vocabulary"], "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_source_name.3290497d3b": ["model.NPS_OMOP_CDM.cdm_source"], "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_source_abbreviation.22d20f7d8c": ["model.NPS_OMOP_CDM.cdm_source"], "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_holder.fe9eac4047": ["model.NPS_OMOP_CDM.cdm_source"], "test.NPS_OMOP_CDM.not_null_cdm_source_source_release_date.f65be0127b": ["model.NPS_OMOP_CDM.cdm_source"], "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_version_concept_id.981254b839": ["model.NPS_OMOP_CDM.cdm_source"], "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_release_date.92d247ab52": ["model.NPS_OMOP_CDM.cdm_source"], "test.NPS_OMOP_CDM.not_null_cdm_source_vocabulary_version.7f9ee9a3c6": ["model.NPS_OMOP_CDM.cdm_source"], "model.NPS_OMOP_CDM.specimen": ["model.NPS_OMOP_CDM.stg_specimen_pathology", "model.NPS_OMOP_CDM.stg_specimen_pathology_albumin", "model.NPS_OMOP_CDM.stg_specimen_pathology_egfr", "model.NPS_OMOP_CDM.stg_specimen_pathology_hba1c", "model.NPS_OMOP_CDM.stg_specimen_pathology_lipids", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "test.NPS_OMOP_CDM.unique_specimen_specimen_id.fffa0ad838": ["model.NPS_OMOP_CDM.specimen"], "test.NPS_OMOP_CDM.not_null_specimen_specimen_id.be5ba20d76": ["model.NPS_OMOP_CDM.specimen"], "test.NPS_OMOP_CDM.relationships_specimen_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.99d5731e1b": ["model.NPS_OMOP_CDM.specimen", "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person"], "test.NPS_OMOP_CDM.not_null_specimen_specimen_date.2a2ccaf597": ["model.NPS_OMOP_CDM.specimen"], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.location": [], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person": [], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site": [], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.provider": [], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence": [], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.concept": [], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.vocabulary": [], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.measurement": [], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.specimen": [], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.drug_exposure": [], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.procedure_occurrence": [], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.condition_occurrence": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ALCOHOL_STATUS": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ALLERGY_REACTION": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.BILLING_SERVICE": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.CLINICAL_USER": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.DIAGNOSIS": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER_REASON": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.IMMUNISATION": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.OBSERVATION": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_ALBUMIN": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_EGFR": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_HBA1C": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_LIPIDS": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_RESULT": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT_MATCHED_USUAL_PROVIDER": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.POSTCODE": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRACTICE_CONTACT": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRACTICE_RECRUITMENT": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRESCRIPTION": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRIMARY_HEALTH_NETWORK": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.REFERRALS": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.REQUESTED_TEST": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SCRIPT_ITEM": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SITE": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SMOKING_STATUS": []}, "child_map": {"model.NPS_OMOP_CDM.cost": ["test.NPS_OMOP_CDM.not_null_cost_cost_event_id.04919371b7", "test.NPS_OMOP_CDM.not_null_cost_cost_id.96e8810b57", "test.NPS_OMOP_CDM.unique_cost_cost_id.059b55a036"], "model.NPS_OMOP_CDM.fact_relationship": ["test.NPS_OMOP_CDM.not_null_fact_relationship_fact_id_1.c1a4cb78dc", "test.NPS_OMOP_CDM.not_null_fact_relationship_fact_id_2.c3b8acff83"], "model.NPS_OMOP_CDM.measurement": ["test.NPS_OMOP_CDM.not_null_measurement_measurement_date.f0992e3082", "test.NPS_OMOP_CDM.not_null_measurement_measurement_id.80b56c4597", "test.NPS_OMOP_CDM.not_null_measurement_person_id.7cf48be66f", "test.NPS_OMOP_CDM.relationships_measurement_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.e7603f5f52", "test.NPS_OMOP_CDM.unique_measurement_measurement_id.a3f1e8466d"], "model.NPS_OMOP_CDM.observation": ["test.NPS_OMOP_CDM.not_null_observation_observation_id.efd24835d6", "test.NPS_OMOP_CDM.not_null_observation_person_id.8fa7495344", "test.NPS_OMOP_CDM.relationships_observation_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.64381f454b", "test.NPS_OMOP_CDM.unique_observation_observation_id.c7fcc2846f"], "model.NPS_OMOP_CDM.observation_period": ["test.NPS_OMOP_CDM.not_null_observation_period_observation_period_end_date.e74764a048", "test.NPS_OMOP_CDM.not_null_observation_period_observation_period_id.6c6fb96d33", "test.NPS_OMOP_CDM.not_null_observation_period_observation_period_start_date.e88435db95", "test.NPS_OMOP_CDM.not_null_observation_period_period_type_concept_id.b993e0023c", "test.NPS_OMOP_CDM.not_null_observation_period_person_id.71c8f248d3", "test.NPS_OMOP_CDM.relationships_observation_period_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.3774a43eff"], "model.NPS_OMOP_CDM.payer_plan_period": ["test.NPS_OMOP_CDM.not_null_payer_plan_period_payer_plan_period_end_date.1ee2bdf9bb", "test.NPS_OMOP_CDM.not_null_payer_plan_period_payer_plan_period_id.638983fb69", "test.NPS_OMOP_CDM.not_null_payer_plan_period_payer_plan_period_start_date.ae7d04ece1", "test.NPS_OMOP_CDM.not_null_payer_plan_period_person_id.3a67e6214a", "test.NPS_OMOP_CDM.relationships_payer_plan_period_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.830d86145b", "test.NPS_OMOP_CDM.unique_payer_plan_period_payer_plan_period_id.68e7598f49"], "model.NPS_OMOP_CDM.person": ["test.NPS_OMOP_CDM.not_null_person_ethnicity_concept_id.e352f804af", "test.NPS_OMOP_CDM.not_null_person_gender_concept_id.a1409c1a02", "test.NPS_OMOP_CDM.not_null_person_person_id.6f9ab4b4de", "test.NPS_OMOP_CDM.not_null_person_race_concept_id.288243421d", "test.NPS_OMOP_CDM.not_null_person_year_of_birth.03ea95e466", "test.NPS_OMOP_CDM.relationships_person_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.a9a9fa604b", "test.NPS_OMOP_CDM.relationships_person_location_id__location_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_location_.59c87ac44d", "test.NPS_OMOP_CDM.unique_person_person_id.ee18b5e56c"], "model.NPS_OMOP_CDM.procedure_occurrence": ["test.NPS_OMOP_CDM.not_null_procedure_occurrence_person_id.95f33a8709", "test.NPS_OMOP_CDM.not_null_procedure_occurrence_procedure_date.7e26c7adde", "test.NPS_OMOP_CDM.not_null_procedure_occurrence_procedure_occurrence_id.e3b1d90a98", "test.NPS_OMOP_CDM.relationships_procedure_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.50cfd5655b", "test.NPS_OMOP_CDM.relationships_procedure_occurrence_visit_occurrence_id__visit_occurrence_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_visit_occurrence_.d81511cbb6", "test.NPS_OMOP_CDM.unique_procedure_occurrence_procedure_occurrence_id.fb0663ac66"], "model.NPS_OMOP_CDM.provider": ["test.NPS_OMOP_CDM.not_null_provider_provider_id.3b46670424", "test.NPS_OMOP_CDM.relationships_provider_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.b35a07c9f4", "test.NPS_OMOP_CDM.unique_provider_provider_id.b08928e435"], "model.NPS_OMOP_CDM.stg_care_site_site": ["model.NPS_OMOP_CDM.care_site"], "model.NPS_OMOP_CDM.stg_condition_occurrence_diagnosis": ["model.NPS_OMOP_CDM.condition_occurrence"], "model.NPS_OMOP_CDM.stg_condition_occurrence_encounter_reason": ["model.NPS_OMOP_CDM.condition_occurrence"], "model.NPS_OMOP_CDM.stg_condition_occurrence_prescription": ["model.NPS_OMOP_CDM.condition_occurrence"], "model.NPS_OMOP_CDM.stg_cost_billing_service": ["model.NPS_OMOP_CDM.cost"], "model.NPS_OMOP_CDM.stg_death_patient": ["model.NPS_OMOP_CDM.death"], "model.NPS_OMOP_CDM.stg_device_exposure_immunisation": ["model.NPS_OMOP_CDM.device_exposure"], "model.NPS_OMOP_CDM.stg_device_exposure_pathology": ["model.NPS_OMOP_CDM.device_exposure"], "model.NPS_OMOP_CDM.stg_device_exposure_pathology_albumin": ["model.NPS_OMOP_CDM.device_exposure"], "model.NPS_OMOP_CDM.stg_device_exposure_pathology_egfr": ["model.NPS_OMOP_CDM.device_exposure"], "model.NPS_OMOP_CDM.stg_device_exposure_pathology_hba1c": ["model.NPS_OMOP_CDM.device_exposure"], "model.NPS_OMOP_CDM.stg_device_exposure_pathology_lipids": ["model.NPS_OMOP_CDM.device_exposure"], "model.NPS_OMOP_CDM.stg_device_exposure_pathology_result": ["model.NPS_OMOP_CDM.device_exposure"], "model.NPS_OMOP_CDM.stg_drug_exposure_immunisation": ["model.NPS_OMOP_CDM.drug_exposure"], "model.NPS_OMOP_CDM.stg_drug_exposure_prescription": ["model.NPS_OMOP_CDM.drug_exposure"], "model.NPS_OMOP_CDM.stg_drug_exposure_script_item": ["model.NPS_OMOP_CDM.drug_exposure"], "model.NPS_OMOP_CDM.stg_fact_drug_condition": ["model.NPS_OMOP_CDM.fact_relationship"], "model.NPS_OMOP_CDM.stg_fact_drug_procedure": ["model.NPS_OMOP_CDM.fact_relationship"], "model.NPS_OMOP_CDM.stg_fact_specimen_measurement": ["model.NPS_OMOP_CDM.fact_relationship"], "model.NPS_OMOP_CDM.stg_location_patient": ["model.NPS_OMOP_CDM.location"], "model.NPS_OMOP_CDM.stg_location_postcode": ["model.NPS_OMOP_CDM.location"], "model.NPS_OMOP_CDM.stg_location_practice_recruitment": ["model.NPS_OMOP_CDM.location"], "model.NPS_OMOP_CDM.stg_location_primary_health_network": ["model.NPS_OMOP_CDM.location"], "model.NPS_OMOP_CDM.stg_location_site": ["model.NPS_OMOP_CDM.location"], "model.NPS_OMOP_CDM.stg_measurement_observation": ["model.NPS_OMOP_CDM.measurement"], "model.NPS_OMOP_CDM.stg_measurement_pathology": ["model.NPS_OMOP_CDM.measurement"], "model.NPS_OMOP_CDM.stg_measurement_pathology_albumin": ["model.NPS_OMOP_CDM.measurement"], "model.NPS_OMOP_CDM.stg_measurement_pathology_egfr": ["model.NPS_OMOP_CDM.measurement"], "model.NPS_OMOP_CDM.stg_measurement_pathology_hba1c": ["model.NPS_OMOP_CDM.measurement"], "model.NPS_OMOP_CDM.stg_measurement_pathology_lipids": ["model.NPS_OMOP_CDM.measurement"], "model.NPS_OMOP_CDM.stg_measurement_pathology_result": ["model.NPS_OMOP_CDM.measurement"], "model.NPS_OMOP_CDM.stg_measurement_requested_test": ["model.NPS_OMOP_CDM.measurement"], "model.NPS_OMOP_CDM.intermediate_alcohol_allergy": [], "model.NPS_OMOP_CDM.intermediate_stg_alcohol_status": ["model.NPS_OMOP_CDM.intermediate_alcohol_allergy", "model.NPS_OMOP_CDM.observation"], "model.NPS_OMOP_CDM.stg_observation_alcohol_status": ["model.NPS_OMOP_CDM.intermediate_stg_alcohol_status"], "model.NPS_OMOP_CDM.intermediate_stg_allergy_reaction": ["model.NPS_OMOP_CDM.intermediate_alcohol_allergy", "model.NPS_OMOP_CDM.observation"], "model.NPS_OMOP_CDM.stg_observation_allergy_reaction": ["model.NPS_OMOP_CDM.intermediate_stg_allergy_reaction"], "model.NPS_OMOP_CDM.combine_pat_obs": [], "model.NPS_OMOP_CDM.intermediate_stg_observation": ["model.NPS_OMOP_CDM.combine_pat_obs", "model.NPS_OMOP_CDM.observation"], "model.NPS_OMOP_CDM.stg_observation_observation": ["model.NPS_OMOP_CDM.intermediate_stg_observation"], "model.NPS_OMOP_CDM.intermediate_stg_patient": ["model.NPS_OMOP_CDM.combine_pat_obs", "model.NPS_OMOP_CDM.observation"], "model.NPS_OMOP_CDM.stg_observation_patient": ["model.NPS_OMOP_CDM.intermediate_stg_patient"], "model.NPS_OMOP_CDM.intermediate_stg_requested_test": ["model.NPS_OMOP_CDM.combine_pat_obs", "model.NPS_OMOP_CDM.observation"], "model.NPS_OMOP_CDM.stg_observation_requested_test": ["model.NPS_OMOP_CDM.intermediate_stg_requested_test"], "model.NPS_OMOP_CDM.intermediate_stg_smoking_status": ["model.NPS_OMOP_CDM.combine_pat_obs", "model.NPS_OMOP_CDM.observation"], "model.NPS_OMOP_CDM.stg_observation_smoking_status": ["model.NPS_OMOP_CDM.intermediate_stg_smoking_status"], "model.NPS_OMOP_CDM.stg_observation_period_encounter": ["model.NPS_OMOP_CDM.observation_period"], "model.NPS_OMOP_CDM.stg_payer_plan_period_billing_service": ["model.NPS_OMOP_CDM.payer_plan_period"], "model.NPS_OMOP_CDM.stg_person_encounter": ["model.NPS_OMOP_CDM.person"], "model.NPS_OMOP_CDM.stg_person_encounter_reason": ["model.NPS_OMOP_CDM.person"], "model.NPS_OMOP_CDM.stg_person_patient": ["model.NPS_OMOP_CDM.person"], "model.NPS_OMOP_CDM.stg_procedure_occurrence_diagnosis": ["model.NPS_OMOP_CDM.procedure_occurrence"], "model.NPS_OMOP_CDM.stg_procedure_occurrence_encounter_reason": ["model.NPS_OMOP_CDM.procedure_occurrence"], "model.NPS_OMOP_CDM.stg_procedure_occurrence_immunisation": ["model.NPS_OMOP_CDM.procedure_occurrence"], "model.NPS_OMOP_CDM.stg_procedure_occurrence_prescription": ["model.NPS_OMOP_CDM.procedure_occurrence"], "model.NPS_OMOP_CDM.stg_procedure_occurrence_requested_test": ["model.NPS_OMOP_CDM.procedure_occurrence"], "model.NPS_OMOP_CDM.stg_procedure_occurrence_script_item": ["model.NPS_OMOP_CDM.procedure_occurrence"], "model.NPS_OMOP_CDM.stg_provider_clinical_user": ["model.NPS_OMOP_CDM.provider"], "model.NPS_OMOP_CDM.stg_provider_patient_matched_usual_provider": ["model.NPS_OMOP_CDM.provider"], "model.NPS_OMOP_CDM.stg_provider_practice_contact": ["model.NPS_OMOP_CDM.provider"], "model.NPS_OMOP_CDM.stg_provider_requested_test": ["model.NPS_OMOP_CDM.provider"], "model.NPS_OMOP_CDM.stg_specimen_pathology": ["model.NPS_OMOP_CDM.specimen"], "model.NPS_OMOP_CDM.stg_specimen_pathology_albumin": ["model.NPS_OMOP_CDM.specimen"], "model.NPS_OMOP_CDM.stg_specimen_pathology_egfr": ["model.NPS_OMOP_CDM.specimen"], "model.NPS_OMOP_CDM.stg_specimen_pathology_hba1c": ["model.NPS_OMOP_CDM.specimen"], "model.NPS_OMOP_CDM.stg_specimen_pathology_lipids": ["model.NPS_OMOP_CDM.specimen"], "model.NPS_OMOP_CDM.stg_visit_occurrence_encounter": ["model.NPS_OMOP_CDM.visit_occurrence"], "model.NPS_OMOP_CDM.stg_visit_occurrence_encounter_reason": ["model.NPS_OMOP_CDM.visit_occurrence"], "test.NPS_OMOP_CDM.generic_test": [], "seed.NPS_OMOP_CDM.postcode_data": ["model.NPS_OMOP_CDM.location", "test.NPS_OMOP_CDM.not_null_postcode_data_id.f82d87e983", "test.NPS_OMOP_CDM.not_null_postcode_data_postcode.c435345986", "test.NPS_OMOP_CDM.unique_postcode_data_id.1d1de585bd"], "test.NPS_OMOP_CDM.not_null_cost_cost_id.96e8810b57": [], "test.NPS_OMOP_CDM.unique_cost_cost_id.059b55a036": [], "test.NPS_OMOP_CDM.not_null_cost_cost_event_id.04919371b7": [], "test.NPS_OMOP_CDM.not_null_fact_relationship_fact_id_1.c1a4cb78dc": [], "test.NPS_OMOP_CDM.not_null_fact_relationship_fact_id_2.c3b8acff83": [], "test.NPS_OMOP_CDM.unique_measurement_measurement_id.a3f1e8466d": [], "test.NPS_OMOP_CDM.not_null_measurement_measurement_id.80b56c4597": [], "test.NPS_OMOP_CDM.not_null_measurement_person_id.7cf48be66f": [], "test.NPS_OMOP_CDM.relationships_measurement_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.e7603f5f52": [], "test.NPS_OMOP_CDM.not_null_measurement_measurement_date.f0992e3082": [], "test.NPS_OMOP_CDM.unique_observation_observation_id.c7fcc2846f": [], "test.NPS_OMOP_CDM.not_null_observation_observation_id.efd24835d6": [], "test.NPS_OMOP_CDM.not_null_observation_person_id.8fa7495344": [], "test.NPS_OMOP_CDM.relationships_observation_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.64381f454b": [], "test.NPS_OMOP_CDM.not_null_observation_period_observation_period_id.6c6fb96d33": [], "test.NPS_OMOP_CDM.not_null_observation_period_person_id.71c8f248d3": [], "test.NPS_OMOP_CDM.relationships_observation_period_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.3774a43eff": [], "test.NPS_OMOP_CDM.not_null_observation_period_observation_period_start_date.e88435db95": [], "test.NPS_OMOP_CDM.not_null_observation_period_observation_period_end_date.e74764a048": [], "test.NPS_OMOP_CDM.not_null_observation_period_period_type_concept_id.b993e0023c": [], "test.NPS_OMOP_CDM.not_null_payer_plan_period_payer_plan_period_id.638983fb69": [], "test.NPS_OMOP_CDM.unique_payer_plan_period_payer_plan_period_id.68e7598f49": [], "test.NPS_OMOP_CDM.not_null_payer_plan_period_person_id.3a67e6214a": [], "test.NPS_OMOP_CDM.relationships_payer_plan_period_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.830d86145b": [], "test.NPS_OMOP_CDM.not_null_payer_plan_period_payer_plan_period_start_date.ae7d04ece1": [], "test.NPS_OMOP_CDM.not_null_payer_plan_period_payer_plan_period_end_date.1ee2bdf9bb": [], "test.NPS_OMOP_CDM.unique_person_person_id.ee18b5e56c": [], "test.NPS_OMOP_CDM.not_null_person_person_id.6f9ab4b4de": [], "test.NPS_OMOP_CDM.not_null_person_gender_concept_id.a1409c1a02": [], "test.NPS_OMOP_CDM.not_null_person_year_of_birth.03ea95e466": [], "test.NPS_OMOP_CDM.not_null_person_race_concept_id.288243421d": [], "test.NPS_OMOP_CDM.not_null_person_ethnicity_concept_id.e352f804af": [], "test.NPS_OMOP_CDM.relationships_person_location_id__location_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_location_.59c87ac44d": [], "test.NPS_OMOP_CDM.relationships_person_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.a9a9fa604b": [], "test.NPS_OMOP_CDM.not_null_procedure_occurrence_procedure_occurrence_id.e3b1d90a98": [], "test.NPS_OMOP_CDM.unique_procedure_occurrence_procedure_occurrence_id.fb0663ac66": [], "test.NPS_OMOP_CDM.not_null_procedure_occurrence_person_id.95f33a8709": [], "test.NPS_OMOP_CDM.relationships_procedure_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.50cfd5655b": [], "test.NPS_OMOP_CDM.relationships_procedure_occurrence_visit_occurrence_id__visit_occurrence_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_visit_occurrence_.d81511cbb6": [], "test.NPS_OMOP_CDM.not_null_procedure_occurrence_procedure_date.7e26c7adde": [], "test.NPS_OMOP_CDM.not_null_provider_provider_id.3b46670424": [], "test.NPS_OMOP_CDM.unique_provider_provider_id.b08928e435": [], "test.NPS_OMOP_CDM.relationships_provider_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.b35a07c9f4": [], "test.NPS_OMOP_CDM.unique_postcode_data_id.1d1de585bd": [], "test.NPS_OMOP_CDM.not_null_postcode_data_id.f82d87e983": [], "test.NPS_OMOP_CDM.not_null_postcode_data_postcode.c435345986": [], "model.NPS_OMOP_CDM.death": ["test.NPS_OMOP_CDM.not_null_death_death_date.7d86f6855c", "test.NPS_OMOP_CDM.not_null_death_person_id.05e446446c", "test.NPS_OMOP_CDM.relationships_death_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.4e266aefbe", "test.NPS_OMOP_CDM.unique_death_person_id.bf3e007a4d"], "test.NPS_OMOP_CDM.unique_death_person_id.bf3e007a4d": [], "test.NPS_OMOP_CDM.not_null_death_person_id.05e446446c": [], "test.NPS_OMOP_CDM.relationships_death_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.4e266aefbe": [], "test.NPS_OMOP_CDM.not_null_death_death_date.7d86f6855c": [], "model.NPS_OMOP_CDM.location": ["test.NPS_OMOP_CDM.accepted_values_location_state__NS__CT__QL__TS__VI__NT__SA__WA__None.8bc4117309", "test.NPS_OMOP_CDM.not_null_location_location_id.af91958747", "test.NPS_OMOP_CDM.unique_location_location_id.e30ffdeb77"], "test.NPS_OMOP_CDM.not_null_location_location_id.af91958747": [], "test.NPS_OMOP_CDM.unique_location_location_id.e30ffdeb77": [], "test.NPS_OMOP_CDM.accepted_values_location_state__NS__CT__QL__TS__VI__NT__SA__WA__None.8bc4117309": [], "model.NPS_OMOP_CDM.care_site": ["test.NPS_OMOP_CDM.not_null_care_site_care_site_id.2d320c251b", "test.NPS_OMOP_CDM.relationships_care_site_location_id__location_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_location_.edadb2302e", "test.NPS_OMOP_CDM.unique_care_site_care_site_id.9f2a10fa8e"], "test.NPS_OMOP_CDM.not_null_care_site_care_site_id.2d320c251b": [], "test.NPS_OMOP_CDM.unique_care_site_care_site_id.9f2a10fa8e": [], "test.NPS_OMOP_CDM.relationships_care_site_location_id__location_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_location_.edadb2302e": [], "model.NPS_OMOP_CDM.condition_occurrence": ["test.NPS_OMOP_CDM.not_null_condition_occurrence_condition_occurrence_id.f70111fa08", "test.NPS_OMOP_CDM.not_null_condition_occurrence_condition_start_date.6cbb11717a", "test.NPS_OMOP_CDM.not_null_condition_occurrence_person_id.9f19d9c9cb", "test.NPS_OMOP_CDM.relationships_condition_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.5e206dc499", "test.NPS_OMOP_CDM.relationships_condition_occurrence_visit_occurrence_id__visit_occurrence_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_visit_occurrence_.106dee8b71", "test.NPS_OMOP_CDM.unique_condition_occurrence_condition_occurrence_id.e4cb792f90"], "test.NPS_OMOP_CDM.not_null_condition_occurrence_condition_occurrence_id.f70111fa08": [], "test.NPS_OMOP_CDM.unique_condition_occurrence_condition_occurrence_id.e4cb792f90": [], "test.NPS_OMOP_CDM.not_null_condition_occurrence_person_id.9f19d9c9cb": [], "test.NPS_OMOP_CDM.relationships_condition_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.5e206dc499": [], "test.NPS_OMOP_CDM.relationships_condition_occurrence_visit_occurrence_id__visit_occurrence_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_visit_occurrence_.106dee8b71": [], "test.NPS_OMOP_CDM.not_null_condition_occurrence_condition_start_date.6cbb11717a": [], "model.NPS_OMOP_CDM.device_exposure": ["test.NPS_OMOP_CDM.not_null_device_exposure_device_concept_id.041c422e55", "test.NPS_OMOP_CDM.not_null_device_exposure_device_exposure_id.ab1d5a2fe5", "test.NPS_OMOP_CDM.not_null_device_exposure_device_exposure_start_date.23aa3e8aea", "test.NPS_OMOP_CDM.not_null_device_exposure_person_id.1330a61d39", "test.NPS_OMOP_CDM.relationships_device_exposure_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.948ad4fe61", "test.NPS_OMOP_CDM.unique_device_exposure_device_exposure_id.cdcba3488d"], "test.NPS_OMOP_CDM.unique_device_exposure_device_exposure_id.cdcba3488d": [], "test.NPS_OMOP_CDM.not_null_device_exposure_device_exposure_id.ab1d5a2fe5": [], "test.NPS_OMOP_CDM.not_null_device_exposure_person_id.1330a61d39": [], "test.NPS_OMOP_CDM.relationships_device_exposure_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.948ad4fe61": [], "test.NPS_OMOP_CDM.not_null_device_exposure_device_exposure_start_date.23aa3e8aea": [], "test.NPS_OMOP_CDM.not_null_device_exposure_device_concept_id.041c422e55": [], "model.NPS_OMOP_CDM.drug_exposure": ["test.NPS_OMOP_CDM.not_null_drug_exposure_drug_exposure_end_date.89e020fdd4", "test.NPS_OMOP_CDM.not_null_drug_exposure_drug_exposure_id.a57f0904e3", "test.NPS_OMOP_CDM.not_null_drug_exposure_drug_exposure_start_date.61d182cfaa", "test.NPS_OMOP_CDM.relationships_drug_exposure_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.07271b7683", "test.NPS_OMOP_CDM.relationships_drug_exposure_provider_id__provider_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_provider_.e855c95c18", "test.NPS_OMOP_CDM.unique_drug_exposure_drug_exposure_id.6e11199bfc"], "test.NPS_OMOP_CDM.unique_drug_exposure_drug_exposure_id.6e11199bfc": [], "test.NPS_OMOP_CDM.not_null_drug_exposure_drug_exposure_id.a57f0904e3": [], "test.NPS_OMOP_CDM.relationships_drug_exposure_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.07271b7683": [], "test.NPS_OMOP_CDM.not_null_drug_exposure_drug_exposure_start_date.61d182cfaa": [], "test.NPS_OMOP_CDM.not_null_drug_exposure_drug_exposure_end_date.89e020fdd4": [], "test.NPS_OMOP_CDM.relationships_drug_exposure_provider_id__provider_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_provider_.e855c95c18": [], "model.NPS_OMOP_CDM.visit_occurrence": ["test.NPS_OMOP_CDM.not_null_visit_occurrence_person_id.e916ff163a", "test.NPS_OMOP_CDM.not_null_visit_occurrence_visit_end_date.47f6967fe8", "test.NPS_OMOP_CDM.not_null_visit_occurrence_visit_occurrence_id.a3a65446cf", "test.NPS_OMOP_CDM.not_null_visit_occurrence_visit_start_date.6ef645340a", "test.NPS_OMOP_CDM.relationships_visit_occurrence_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.64e29a2be0", "test.NPS_OMOP_CDM.relationships_visit_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.15c614ba36", "test.NPS_OMOP_CDM.unique_visit_occurrence_visit_occurrence_id.faa3aa67c6"], "test.NPS_OMOP_CDM.not_null_visit_occurrence_visit_occurrence_id.a3a65446cf": [], "test.NPS_OMOP_CDM.unique_visit_occurrence_visit_occurrence_id.faa3aa67c6": [], "test.NPS_OMOP_CDM.not_null_visit_occurrence_person_id.e916ff163a": [], "test.NPS_OMOP_CDM.relationships_visit_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.15c614ba36": [], "test.NPS_OMOP_CDM.not_null_visit_occurrence_visit_start_date.6ef645340a": [], "test.NPS_OMOP_CDM.not_null_visit_occurrence_visit_end_date.47f6967fe8": [], "test.NPS_OMOP_CDM.relationships_visit_occurrence_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.64e29a2be0": [], "model.NPS_OMOP_CDM.metadata": ["test.NPS_OMOP_CDM.not_null_metadata_metadata_concept_id.fbb43fc750", "test.NPS_OMOP_CDM.not_null_metadata_metadata_id.245549e30d", "test.NPS_OMOP_CDM.not_null_metadata_metadata_type_concept_id.ecddd5859d", "test.NPS_OMOP_CDM.not_null_metadata_name.21f9e599ec", "test.NPS_OMOP_CDM.unique_metadata_metadata_id.c5f9aef418"], "test.NPS_OMOP_CDM.not_null_metadata_metadata_id.245549e30d": [], "test.NPS_OMOP_CDM.unique_metadata_metadata_id.c5f9aef418": [], "test.NPS_OMOP_CDM.not_null_metadata_metadata_concept_id.fbb43fc750": [], "test.NPS_OMOP_CDM.not_null_metadata_metadata_type_concept_id.ecddd5859d": [], "test.NPS_OMOP_CDM.not_null_metadata_name.21f9e599ec": [], "model.NPS_OMOP_CDM.cdm_source": ["test.NPS_OMOP_CDM.not_null_cdm_source_cdm_holder.fe9eac4047", "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_release_date.92d247ab52", "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_source_abbreviation.22d20f7d8c", "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_source_name.3290497d3b", "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_version_concept_id.981254b839", "test.NPS_OMOP_CDM.not_null_cdm_source_source_release_date.f65be0127b", "test.NPS_OMOP_CDM.not_null_cdm_source_vocabulary_version.7f9ee9a3c6"], "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_source_name.3290497d3b": [], "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_source_abbreviation.22d20f7d8c": [], "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_holder.fe9eac4047": [], "test.NPS_OMOP_CDM.not_null_cdm_source_source_release_date.f65be0127b": [], "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_version_concept_id.981254b839": [], "test.NPS_OMOP_CDM.not_null_cdm_source_cdm_release_date.92d247ab52": [], "test.NPS_OMOP_CDM.not_null_cdm_source_vocabulary_version.7f9ee9a3c6": [], "model.NPS_OMOP_CDM.specimen": ["test.NPS_OMOP_CDM.not_null_specimen_specimen_date.2a2ccaf597", "test.NPS_OMOP_CDM.not_null_specimen_specimen_id.be5ba20d76", "test.NPS_OMOP_CDM.relationships_specimen_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.99d5731e1b", "test.NPS_OMOP_CDM.unique_specimen_specimen_id.fffa0ad838"], "test.NPS_OMOP_CDM.unique_specimen_specimen_id.fffa0ad838": [], "test.NPS_OMOP_CDM.not_null_specimen_specimen_id.be5ba20d76": [], "test.NPS_OMOP_CDM.relationships_specimen_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.99d5731e1b": [], "test.NPS_OMOP_CDM.not_null_specimen_specimen_date.2a2ccaf597": [], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.location": ["model.NPS_OMOP_CDM.care_site", "model.NPS_OMOP_CDM.person", "test.NPS_OMOP_CDM.relationships_care_site_location_id__location_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_location_.edadb2302e", "test.NPS_OMOP_CDM.relationships_person_location_id__location_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_location_.59c87ac44d"], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.person": ["model.NPS_OMOP_CDM.condition_occurrence", "model.NPS_OMOP_CDM.cost", "model.NPS_OMOP_CDM.death", "model.NPS_OMOP_CDM.device_exposure", "model.NPS_OMOP_CDM.drug_exposure", "model.NPS_OMOP_CDM.intermediate_stg_alcohol_status", "model.NPS_OMOP_CDM.intermediate_stg_allergy_reaction", "model.NPS_OMOP_CDM.intermediate_stg_observation", "model.NPS_OMOP_CDM.intermediate_stg_requested_test", "model.NPS_OMOP_CDM.intermediate_stg_smoking_status", "model.NPS_OMOP_CDM.measurement", "model.NPS_OMOP_CDM.observation_period", "model.NPS_OMOP_CDM.payer_plan_period", "model.NPS_OMOP_CDM.procedure_occurrence", "model.NPS_OMOP_CDM.specimen", "model.NPS_OMOP_CDM.visit_occurrence", "test.NPS_OMOP_CDM.relationships_condition_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.5e206dc499", "test.NPS_OMOP_CDM.relationships_death_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.4e266aefbe", "test.NPS_OMOP_CDM.relationships_device_exposure_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.948ad4fe61", "test.NPS_OMOP_CDM.relationships_drug_exposure_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.07271b7683", "test.NPS_OMOP_CDM.relationships_measurement_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.e7603f5f52", "test.NPS_OMOP_CDM.relationships_observation_period_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.3774a43eff", "test.NPS_OMOP_CDM.relationships_observation_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.64381f454b", "test.NPS_OMOP_CDM.relationships_payer_plan_period_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.830d86145b", "test.NPS_OMOP_CDM.relationships_procedure_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.50cfd5655b", "test.NPS_OMOP_CDM.relationships_specimen_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.99d5731e1b", "test.NPS_OMOP_CDM.relationships_visit_occurrence_person_id__person_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_person_.15c614ba36"], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.care_site": ["model.NPS_OMOP_CDM.condition_occurrence", "model.NPS_OMOP_CDM.person", "model.NPS_OMOP_CDM.procedure_occurrence", "model.NPS_OMOP_CDM.provider", "model.NPS_OMOP_CDM.visit_occurrence", "test.NPS_OMOP_CDM.relationships_person_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.a9a9fa604b", "test.NPS_OMOP_CDM.relationships_provider_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.b35a07c9f4", "test.NPS_OMOP_CDM.relationships_visit_occurrence_care_site_id__care_site_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_care_site_.64e29a2be0"], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.provider": ["model.NPS_OMOP_CDM.drug_exposure", "model.NPS_OMOP_CDM.measurement", "model.NPS_OMOP_CDM.procedure_occurrence", "test.NPS_OMOP_CDM.relationships_drug_exposure_provider_id__provider_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_provider_.e855c95c18"], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.visit_occurrence": ["model.NPS_OMOP_CDM.condition_occurrence", "model.NPS_OMOP_CDM.cost", "model.NPS_OMOP_CDM.death", "model.NPS_OMOP_CDM.measurement", "model.NPS_OMOP_CDM.procedure_occurrence", "test.NPS_OMOP_CDM.relationships_condition_occurrence_visit_occurrence_id__visit_occurrence_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_visit_occurrence_.106dee8b71", "test.NPS_OMOP_CDM.relationships_procedure_occurrence_visit_occurrence_id__visit_occurrence_id__source_D_HARMONISED_NPS_MI_RDV_BDV_OMOP_visit_occurrence_.d81511cbb6"], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.concept": ["model.NPS_OMOP_CDM.cdm_source"], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.vocabulary": ["model.NPS_OMOP_CDM.cdm_source"], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.measurement": ["model.NPS_OMOP_CDM.stg_fact_specimen_measurement"], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.specimen": ["model.NPS_OMOP_CDM.stg_fact_specimen_measurement"], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.drug_exposure": ["model.NPS_OMOP_CDM.stg_fact_drug_condition", "model.NPS_OMOP_CDM.stg_fact_drug_procedure"], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.procedure_occurrence": ["model.NPS_OMOP_CDM.stg_fact_drug_procedure"], "source.NPS_OMOP_CDM.D_HARMONISED_NPS_MI_RDV_BDV_OMOP.condition_occurrence": ["model.NPS_OMOP_CDM.stg_fact_drug_condition"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ALCOHOL_STATUS": ["model.NPS_OMOP_CDM.stg_observation_alcohol_status"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ALLERGY_REACTION": ["model.NPS_OMOP_CDM.stg_observation_allergy_reaction"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.BILLING_SERVICE": ["model.NPS_OMOP_CDM.stg_cost_billing_service", "model.NPS_OMOP_CDM.stg_payer_plan_period_billing_service"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.CLINICAL_USER": ["model.NPS_OMOP_CDM.stg_provider_clinical_user"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.DIAGNOSIS": ["model.NPS_OMOP_CDM.stg_condition_occurrence_diagnosis", "model.NPS_OMOP_CDM.stg_procedure_occurrence_diagnosis"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER": ["model.NPS_OMOP_CDM.stg_observation_period_encounter", "model.NPS_OMOP_CDM.stg_person_encounter", "model.NPS_OMOP_CDM.stg_visit_occurrence_encounter"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.ENCOUNTER_REASON": ["model.NPS_OMOP_CDM.stg_condition_occurrence_encounter_reason", "model.NPS_OMOP_CDM.stg_person_encounter_reason", "model.NPS_OMOP_CDM.stg_procedure_occurrence_encounter_reason", "model.NPS_OMOP_CDM.stg_visit_occurrence_encounter_reason"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.IMMUNISATION": ["model.NPS_OMOP_CDM.stg_device_exposure_immunisation", "model.NPS_OMOP_CDM.stg_drug_exposure_immunisation", "model.NPS_OMOP_CDM.stg_procedure_occurrence_immunisation"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.OBSERVATION": ["model.NPS_OMOP_CDM.stg_measurement_observation", "model.NPS_OMOP_CDM.stg_observation_observation"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY": ["model.NPS_OMOP_CDM.stg_device_exposure_pathology", "model.NPS_OMOP_CDM.stg_measurement_pathology", "model.NPS_OMOP_CDM.stg_specimen_pathology"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_ALBUMIN": ["model.NPS_OMOP_CDM.stg_device_exposure_pathology_albumin", "model.NPS_OMOP_CDM.stg_measurement_pathology_albumin", "model.NPS_OMOP_CDM.stg_specimen_pathology_albumin"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_EGFR": ["model.NPS_OMOP_CDM.stg_device_exposure_pathology_egfr", "model.NPS_OMOP_CDM.stg_measurement_pathology_egfr", "model.NPS_OMOP_CDM.stg_specimen_pathology_egfr"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_HBA1C": ["model.NPS_OMOP_CDM.stg_device_exposure_pathology_hba1c", "model.NPS_OMOP_CDM.stg_measurement_pathology_hba1c", "model.NPS_OMOP_CDM.stg_specimen_pathology_hba1c"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_LIPIDS": ["model.NPS_OMOP_CDM.stg_device_exposure_pathology_lipids", "model.NPS_OMOP_CDM.stg_measurement_pathology_lipids", "model.NPS_OMOP_CDM.stg_specimen_pathology_lipids"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATHOLOGY_RESULT": ["model.NPS_OMOP_CDM.stg_device_exposure_pathology_result", "model.NPS_OMOP_CDM.stg_measurement_pathology_result"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT": ["model.NPS_OMOP_CDM.stg_death_patient", "model.NPS_OMOP_CDM.stg_location_patient", "model.NPS_OMOP_CDM.stg_observation_patient", "model.NPS_OMOP_CDM.stg_person_patient"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PATIENT_MATCHED_USUAL_PROVIDER": ["model.NPS_OMOP_CDM.stg_provider_patient_matched_usual_provider"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.POSTCODE": ["model.NPS_OMOP_CDM.stg_location_postcode"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRACTICE_CONTACT": ["model.NPS_OMOP_CDM.stg_provider_practice_contact"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRACTICE_RECRUITMENT": ["model.NPS_OMOP_CDM.stg_location_practice_recruitment"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRESCRIPTION": ["model.NPS_OMOP_CDM.stg_condition_occurrence_prescription", "model.NPS_OMOP_CDM.stg_drug_exposure_prescription", "model.NPS_OMOP_CDM.stg_procedure_occurrence_prescription"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.PRIMARY_HEALTH_NETWORK": ["model.NPS_OMOP_CDM.stg_location_primary_health_network"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.REFERRALS": [], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.REQUESTED_TEST": ["model.NPS_OMOP_CDM.stg_measurement_requested_test", "model.NPS_OMOP_CDM.stg_observation_requested_test", "model.NPS_OMOP_CDM.stg_procedure_occurrence_requested_test", "model.NPS_OMOP_CDM.stg_provider_requested_test"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SCRIPT_ITEM": ["model.NPS_OMOP_CDM.stg_drug_exposure_script_item", "model.NPS_OMOP_CDM.stg_procedure_occurrence_script_item"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SITE": ["model.NPS_OMOP_CDM.stg_care_site_site", "model.NPS_OMOP_CDM.stg_location_site"], "source.NPS_OMOP_CDM.C_SREDH_NPS_MI_STAGING_SIMPLIFIED_2021.SMOKING_STATUS": ["model.NPS_OMOP_CDM.stg_observation_smoking_status"]}}